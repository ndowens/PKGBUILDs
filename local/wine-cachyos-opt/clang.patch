diff --git a/configure b/configure
index dfc034adb79..464d2408705 100755
--- a/configure
+++ b/configure
@@ -1,11 +1,11 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.71 for Wine 8.0.
+# Generated by GNU Autoconf 2.72 for Wine 9.0.
 #
 # Report bugs to <wine-devel@winehq.org>.
 #
 #
-# Copyright (C) 1992-1996, 1998-2017, 2020-2021 Free Software Foundation,
+# Copyright (C) 1992-1996, 1998-2017, 2020-2023 Free Software Foundation,
 # Inc.
 #
 #
@@ -17,7 +17,6 @@
 
 # Be more Bourne compatible
 DUALCASE=1; export DUALCASE # for MKS sh
-as_nop=:
 if test ${ZSH_VERSION+y} && (emulate sh) >/dev/null 2>&1
 then :
   emulate sh
@@ -26,12 +25,13 @@ then :
   # is contrary to our usage.  Disable this feature.
   alias -g '${1+"$@"}'='"$@"'
   setopt NO_GLOB_SUBST
-else $as_nop
-  case `(set -o) 2>/dev/null` in #(
+else case e in #(
+  e) case `(set -o) 2>/dev/null` in #(
   *posix*) :
     set -o posix ;; #(
   *) :
      ;;
+esac ;;
 esac
 fi
 
@@ -103,7 +103,7 @@ IFS=$as_save_IFS
 
      ;;
 esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
+# We did not find ourselves, most probably we were run as 'sh COMMAND'
 # in which case we are not to be found in the path.
 if test "x$as_myself" = x; then
   as_myself=$0
@@ -133,15 +133,14 @@ case $- in # ((((
 esac
 exec $CONFIG_SHELL $as_opts "$as_myself" ${1+"$@"}
 # Admittedly, this is quite paranoid, since all the known shells bail
-# out after a failed `exec'.
+# out after a failed 'exec'.
 printf "%s\n" "$0: could not re-execute with $CONFIG_SHELL" >&2
 exit 255
   fi
   # We don't want this to propagate to other subprocesses.
           { _as_can_reexec=; unset _as_can_reexec;}
 if test "x$CONFIG_SHELL" = x; then
-  as_bourne_compatible="as_nop=:
-if test \${ZSH_VERSION+y} && (emulate sh) >/dev/null 2>&1
+  as_bourne_compatible="if test \${ZSH_VERSION+y} && (emulate sh) >/dev/null 2>&1
 then :
   emulate sh
   NULLCMD=:
@@ -149,12 +148,13 @@ then :
   # is contrary to our usage.  Disable this feature.
   alias -g '\${1+\"\$@\"}'='\"\$@\"'
   setopt NO_GLOB_SUBST
-else \$as_nop
-  case \`(set -o) 2>/dev/null\` in #(
+else case e in #(
+  e) case \`(set -o) 2>/dev/null\` in #(
   *posix*) :
     set -o posix ;; #(
   *) :
      ;;
+esac ;;
 esac
 fi
 "
@@ -172,8 +172,9 @@ as_fn_ret_failure && { exitcode=1; echo as_fn_ret_failure succeeded.; }
 if ( set x; as_fn_ret_success y && test x = \"\$1\" )
 then :
 
-else \$as_nop
-  exitcode=1; echo positional parameters were not saved.
+else case e in #(
+  e) exitcode=1; echo positional parameters were not saved. ;;
+esac
 fi
 test x\$exitcode = x0 || exit 1
 blah=\$(echo \$(echo blah))
@@ -187,14 +188,15 @@ test \$(( 1 + 1 )) = 2 || exit 1"
   if (eval "$as_required") 2>/dev/null
 then :
   as_have_required=yes
-else $as_nop
-  as_have_required=no
+else case e in #(
+  e) as_have_required=no ;;
+esac
 fi
   if test x$as_have_required = xyes && (eval "$as_suggested") 2>/dev/null
 then :
 
-else $as_nop
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+else case e in #(
+  e) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 as_found=false
 for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
 do
@@ -227,12 +229,13 @@ IFS=$as_save_IFS
 if $as_found
 then :
 
-else $as_nop
-  if { test -f "$SHELL" || test -f "$SHELL.exe"; } &&
+else case e in #(
+  e) if { test -f "$SHELL" || test -f "$SHELL.exe"; } &&
 	      as_run=a "$SHELL" -c "$as_bourne_compatible""$as_required" 2>/dev/null
 then :
   CONFIG_SHELL=$SHELL as_have_required=yes
-fi
+fi ;;
+esac
 fi
 
 
@@ -254,7 +257,7 @@ case $- in # ((((
 esac
 exec $CONFIG_SHELL $as_opts "$as_myself" ${1+"$@"}
 # Admittedly, this is quite paranoid, since all the known shells bail
-# out after a failed `exec'.
+# out after a failed 'exec'.
 printf "%s\n" "$0: could not re-execute with $CONFIG_SHELL" >&2
 exit 255
 fi
@@ -274,7 +277,8 @@ $0: a modern shell, or manually run the script under such a
 $0: shell if you do have one."
   fi
   exit 1
-fi
+fi ;;
+esac
 fi
 fi
 SHELL=${CONFIG_SHELL-/bin/sh}
@@ -313,14 +317,6 @@ as_fn_exit ()
   as_fn_set_status $1
   exit $1
 } # as_fn_exit
-# as_fn_nop
-# ---------
-# Do nothing but, unlike ":", preserve the value of $?.
-as_fn_nop ()
-{
-  return $?
-}
-as_nop=as_fn_nop
 
 # as_fn_mkdir_p
 # -------------
@@ -389,11 +385,12 @@ then :
   {
     eval $1+=\$2
   }'
-else $as_nop
-  as_fn_append ()
+else case e in #(
+  e) as_fn_append ()
   {
     eval $1=\$$1\$2
-  }
+  } ;;
+esac
 fi # as_fn_append
 
 # as_fn_arith ARG...
@@ -407,21 +404,14 @@ then :
   {
     as_val=$(( $* ))
   }'
-else $as_nop
-  as_fn_arith ()
+else case e in #(
+  e) as_fn_arith ()
   {
     as_val=`expr "$@" || test $? -eq 1`
-  }
+  } ;;
+esac
 fi # as_fn_arith
 
-# as_fn_nop
-# ---------
-# Do nothing but, unlike ":", preserve the value of $?.
-as_fn_nop ()
-{
-  return $?
-}
-as_nop=as_fn_nop
 
 # as_fn_error STATUS ERROR [LINENO LOG_FD]
 # ----------------------------------------
@@ -495,6 +485,8 @@ as_cr_alnum=$as_cr_Letters$as_cr_digits
     /[$]LINENO/=
   ' <$as_myself |
     sed '
+      t clear
+      :clear
       s/[$]LINENO.*/&-/
       t lineno
       b
@@ -543,7 +535,6 @@ esac
 as_echo='printf %s\n'
 as_echo_n='printf %s'
 
-
 rm -f conf$$ conf$$.exe conf$$.file
 if test -d conf$$.dir; then
   rm -f conf$$.dir/conf$$.file
@@ -555,9 +546,9 @@ if (echo >conf$$.file) 2>/dev/null; then
   if ln -s conf$$.file conf$$ 2>/dev/null; then
     as_ln_s='ln -s'
     # ... but there are two gotchas:
-    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-    # In both cases, we have to default to `cp -pR'.
+    # 1) On MSYS, both 'ln -s file dir' and 'ln file dir' fail.
+    # 2) DJGPP < 2.04 has no symlinks; 'ln -s' creates a wrapper executable.
+    # In both cases, we have to default to 'cp -pR'.
     ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
       as_ln_s='cp -pR'
   elif ln conf$$.file conf$$ 2>/dev/null; then
@@ -582,10 +573,12 @@ as_test_x='test -x'
 as_executable_p=as_fn_executable_p
 
 # Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
+as_sed_cpp="y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g"
+as_tr_cpp="eval sed '$as_sed_cpp'" # deprecated
 
 # Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
+as_sed_sh="y%*+%pp%;s%[^_$as_cr_alnum]%_%g"
+as_tr_sh="eval sed '$as_sed_sh'" # deprecated
 
 
 test -n "$DJDIR" || exec 7<&0 </dev/null
@@ -611,8 +604,8 @@ MAKEFLAGS=
 # Identity of this package.
 PACKAGE_NAME='Wine'
 PACKAGE_TARNAME='wine'
-PACKAGE_VERSION='8.0'
-PACKAGE_STRING='Wine 8.0'
+PACKAGE_VERSION='9.0'
+PACKAGE_STRING='Wine 9.0'
 PACKAGE_BUGREPORT='wine-devel@winehq.org'
 PACKAGE_URL='https://www.winehq.org'
 
@@ -649,6 +642,7 @@ ac_includes_default="\
 #endif"
 
 ac_header_c_list=
+enable_year2038=no
 ac_subst_vars='LTLIBOBJS
 LIBOBJS
 TAGSFLAGS
@@ -656,6 +650,8 @@ RT_LIBS
 WINELOADER_PROGRAMS
 DELAYLOADFLAG
 MSVCRTFLAGS
+GCRYPT_LIBS
+GCRYPT_CFLAGS
 NETAPI_LIBS
 NETAPI_CFLAGS
 PROCSTAT_LIBS
@@ -694,13 +690,27 @@ USB_LIBS
 USB_CFLAGS
 SANE_LIBS
 SANE_CFLAGS
+GMP_LIBS
+GMP_CFLAGS
+DRMAMDGPU_LIBS
+DRMAMDGPU_CFLAGS
+DRM_LIBS
+DRM_CFLAGS
 GNUTLS_LIBS
 GNUTLS_CFLAGS
 DBUS_LIBS
 DBUS_CFLAGS
 INOTIFY_LIBS
 INOTIFY_CFLAGS
+PCSCLITE_LIBS
 PCAP_LIBS
+XKBREGISTRY_LIBS
+XKBREGISTRY_CFLAGS
+XKBCOMMON_LIBS
+XKBCOMMON_CFLAGS
+WAYLAND_SCANNER
+WAYLAND_CLIENT_LIBS
+WAYLAND_CLIENT_CFLAGS
 X_EXTRA_LIBS
 X_LIBS
 X_PRE_LIBS
@@ -708,6 +718,8 @@ X_CFLAGS
 CPP
 XMKMF
 PTHREAD_LIBS
+ZYDIS_PE_LIBS
+ZYDIS_PE_CFLAGS
 ZLIB_PE_LIBS
 ZLIB_PE_CFLAGS
 XSLT_PE_LIBS
@@ -720,6 +732,8 @@ TIFF_PE_LIBS
 TIFF_PE_CFLAGS
 PNG_PE_LIBS
 PNG_PE_CFLAGS
+MUSL_PE_LIBS
+MUSL_PE_CFLAGS
 MPG123_PE_LIBS
 MPG123_PE_CFLAGS
 LDAP_PE_LIBS
@@ -732,15 +746,14 @@ JPEG_PE_LIBS
 JPEG_PE_CFLAGS
 GSM_PE_LIBS
 GSM_PE_CFLAGS
+FLUIDSYNTH_PE_LIBS
+FLUIDSYNTH_PE_CFLAGS
 FAUDIO_PE_LIBS
 FAUDIO_PE_CFLAGS
 MINGW_PKG_CONFIG
+MSHTML_CFLAGS
 PE_ARCHS
-LIBWINE_DEPENDS
-PRELINK
 WINELOADER_DEPENDS
-LIBWINE_LDFLAGS
-LIBWINE_SHAREDLIB
 ac_ct_OBJC
 OBJCFLAGS
 OBJC
@@ -762,6 +775,7 @@ SUBDIRS
 READELF
 OTOOL
 LDD
+DLLEXT
 WINEPRELOADER_LDFLAGS
 WINELOADER_LDFLAGS
 TOP_INSTALL_DEV
@@ -810,6 +824,14 @@ i386_LDFLAGS
 i386_EXTRACFLAGS
 i386_CFLAGS
 i386_CC
+arm64ec_DISABLED_SUBDIRS
+arm64ec_DELAYLOADFLAG
+arm64ec_TARGET
+arm64ec_DEBUG
+arm64ec_LDFLAGS
+arm64ec_EXTRACFLAGS
+arm64ec_CFLAGS
+arm64ec_CC
 arm_DISABLED_SUBDIRS
 arm_DELAYLOADFLAG
 arm_TARGET
@@ -913,6 +935,7 @@ with_dbus
 with_float_abi
 with_fontconfig
 with_freetype
+with_gcrypt
 with_gettext
 with_gettextpo
 with_gphoto
@@ -928,6 +951,7 @@ with_opengl
 with_osmesa
 with_oss
 with_pcap
+with_pcsclite
 with_pthread
 with_pulse
 with_sane
@@ -936,7 +960,9 @@ with_udev
 with_unwind
 with_usb
 with_v4l2
+with_vosk
 with_vulkan
+with_wayland
 with_xcomposite
 with_xcursor
 with_xfixes
@@ -963,10 +989,13 @@ enable_adsldpc
 enable_advapi32
 enable_advpack
 enable_amsi
+enable_amd_ags_x64
 enable_amstream
 enable_apisetschema
 enable_apphelp
 enable_appwiz_cpl
+enable_appxdeploymentclient
+enable_atiadlxx
 enable_atl
 enable_atl100
 enable_atl110
@@ -974,11 +1003,13 @@ enable_atl80
 enable_atl90
 enable_atlthunk
 enable_atmlib
+enable_audioses
 enable_authz
 enable_avicap32
 enable_avifil32
 enable_avrt
 enable_bcrypt
+enable_bcryptprimitives
 enable_bluetoothapis
 enable_browseui
 enable_bthprops_cpl
@@ -993,6 +1024,7 @@ enable_combase
 enable_comcat
 enable_comctl32
 enable_comdlg32
+enable_coml2
 enable_compstui
 enable_comsvcs
 enable_concrt140
@@ -1015,6 +1047,7 @@ enable_d3d10_1
 enable_d3d10core
 enable_d3d11
 enable_d3d12
+enable_d3d12core
 enable_d3d8
 enable_d3d8thk
 enable_d3d9
@@ -1114,8 +1147,11 @@ enable_dswave
 enable_dwmapi
 enable_dwrite
 enable_dx8vb
+enable_dxcore
 enable_dxdiagn
 enable_dxgi
+enable_dxgkrnl_sys
+enable_dxgmms1_sys
 enable_dxtrans
 enable_dxva2
 enable_esent
@@ -1133,9 +1169,11 @@ enable_gameux
 enable_gamingtcui
 enable_gdi32
 enable_gdiplus
+enable_geolocation
 enable_glu32
 enable_gphoto2_ds
 enable_gpkcsp
+enable_graphicscapture
 enable_hal
 enable_hhctrl_ocx
 enable_hid
@@ -1143,8 +1181,10 @@ enable_hidclass_sys
 enable_hidparse_sys
 enable_hlink
 enable_hnetcfg
+enable_hrtfapo
 enable_http_sys
 enable_httpapi
+enable_hvsimanagementapi
 enable_ia2comproxy
 enable_iccvid
 enable_icmp
@@ -1181,6 +1221,7 @@ enable_loadperf
 enable_localspl
 enable_localui
 enable_lz32
+enable_magnification
 enable_mapi32
 enable_mapistub
 enable_mciavi32
@@ -1210,6 +1251,7 @@ enable_msacm32
 enable_msado15
 enable_msadp32_acm
 enable_msasn1
+enable_msauddecmft
 enable_mscat32
 enable_mscms
 enable_mscoree
@@ -1235,6 +1277,7 @@ enable_msimtf
 enable_msisip
 enable_msisys_ocx
 enable_msls31
+enable_msmpeg2vdec
 enable_msnet32
 enable_mspatcha
 enable_msports
@@ -1243,6 +1286,7 @@ enable_msscript_ocx
 enable_mssign32
 enable_mssip32
 enable_mstask
+enable_msttsengine
 enable_msv1_0
 enable_msvcirt
 enable_msvcm80
@@ -1255,6 +1299,7 @@ enable_msvcp140
 enable_msvcp140_1
 enable_msvcp140_2
 enable_msvcp140_atomic_wait
+enable_msvcp140_codecvt_ids
 enable_msvcp60
 enable_msvcp70
 enable_msvcp71
@@ -1301,6 +1346,7 @@ enable_ntdll
 enable_ntdsapi
 enable_ntoskrnl_exe
 enable_ntprint
+enable_nvcuda
 enable_objsel
 enable_odbc32
 enable_odbcbcp
@@ -1355,6 +1401,7 @@ enable_sane_ds
 enable_sapi
 enable_sas
 enable_scarddlg
+enable_scardsvr
 enable_sccbase
 enable_schannel
 enable_schedsvc
@@ -1369,6 +1416,7 @@ enable_serialui
 enable_setupapi
 enable_sfc
 enable_sfc_os
+enable_sharedgpures_sys
 enable_shcore
 enable_shdoclc
 enable_shdocvw
@@ -1383,6 +1431,7 @@ enable_spoolss
 enable_sppc
 enable_srclient
 enable_srvcli
+enable_srvsvc
 enable_sspicli
 enable_stdole2_tlb
 enable_stdole32_tlb
@@ -1399,6 +1448,7 @@ enable_tdi_sys
 enable_threadpoolwinrt
 enable_traffic
 enable_twain_32
+enable_twinapi_appcore
 enable_tzres
 enable_ucrtbase
 enable_uianimation
@@ -1439,15 +1489,27 @@ enable_wevtapi
 enable_wevtsvc
 enable_wiaservc
 enable_wimgapi
+enable_win32k_sys
 enable_win32u
+enable_windows_applicationmodel
+enable_windows_devices_bluetooth
 enable_windows_devices_enumeration
+enable_windows_devices_usb
 enable_windows_gaming_input
 enable_windows_gaming_ui_gamebar
 enable_windows_globalization
 enable_windows_media_devices
+enable_windows_media_mediacontrol
 enable_windows_media_speech
 enable_windows_media
+enable_windows_networking_hostname
 enable_windows_networking
+enable_windows_networking_connectivity
+enable_windows_perception_stub
+enable_windows_security_credentials_ui_userconsentverifier
+enable_windows_storage_applicationdata
+enable_windows_system_profile_systemmanufacturers
+enable_windows_ui
 enable_windowscodecs
 enable_windowscodecsext
 enable_winealsa_drv
@@ -1465,6 +1527,7 @@ enable_wineps_drv
 enable_winepulse_drv
 enable_wineusb_sys
 enable_winevulkan
+enable_winewayland_drv
 enable_winex11_drv
 enable_winexinput_sys
 enable_wing32
@@ -1483,6 +1546,7 @@ enable_winusb
 enable_wlanapi
 enable_wlanui
 enable_wldap32
+enable_wldp
 enable_wmasf
 enable_wmi
 enable_wmiutils
@@ -1557,6 +1621,7 @@ enable_dxerr8
 enable_dxerr9
 enable_dxguid
 enable_faudio
+enable_fluidsynth
 enable_gsm
 enable_jpeg
 enable_jxr
@@ -1564,6 +1629,7 @@ enable_lcms2
 enable_ldap
 enable_mfuuid
 enable_mpg123
+enable_musl
 enable_png
 enable_strmbase
 enable_strmiids
@@ -1571,17 +1637,18 @@ enable_tiff
 enable_uuid
 enable_vkd3d
 enable_wbemuuid
-enable_wine
 enable_wmcodecdspuuid
 enable_xml2
 enable_xslt
 enable_zlib
+enable_zydis
 enable_loader
 enable_nls
 enable_po
 enable_arp
 enable_aspnet_regiis
 enable_attrib
+enable_belauncher
 enable_cabarc
 enable_cacls
 enable_certutil
@@ -1594,6 +1661,7 @@ enable_cscript
 enable_dism
 enable_dllhost
 enable_dplaysvr
+enable_dotnetfx35
 enable_dpnsvr
 enable_dpvsetup
 enable_dxdiag
@@ -1605,12 +1673,14 @@ enable_fc
 enable_find
 enable_findstr
 enable_fsutil
+enable_getminidump
 enable_hh
 enable_hostname
 enable_icacls
 enable_icinfo
 enable_iexplore
 enable_ipconfig
+enable_klist
 enable_lodctr
 enable_mofcomp
 enable_mshta
@@ -1625,6 +1695,7 @@ enable_notepad
 enable_oleview
 enable_ping
 enable_plugplay
+enable_pnputil
 enable_powershell
 enable_presentationfontcache
 enable_progman
@@ -1650,6 +1721,7 @@ enable_start
 enable_subst
 enable_svchost
 enable_systeminfo
+enable_tabtip
 enable_taskkill
 enable_tasklist
 enable_taskmgr
@@ -1693,6 +1765,7 @@ enable_winegcc
 enable_winemaker
 enable_wmc
 enable_wrc
+enable_year2038
 '
       ac_precious_vars='build_alias
 host_alias
@@ -1709,6 +1782,8 @@ OBJC
 OBJCFLAGS
 FAUDIO_PE_CFLAGS
 FAUDIO_PE_LIBS
+FLUIDSYNTH_PE_CFLAGS
+FLUIDSYNTH_PE_LIBS
 GSM_PE_CFLAGS
 GSM_PE_LIBS
 JPEG_PE_CFLAGS
@@ -1721,6 +1796,8 @@ LDAP_PE_CFLAGS
 LDAP_PE_LIBS
 MPG123_PE_CFLAGS
 MPG123_PE_LIBS
+MUSL_PE_CFLAGS
+MUSL_PE_LIBS
 PNG_PE_CFLAGS
 PNG_PE_LIBS
 TIFF_PE_CFLAGS
@@ -1733,14 +1810,28 @@ XSLT_PE_CFLAGS
 XSLT_PE_LIBS
 ZLIB_PE_CFLAGS
 ZLIB_PE_LIBS
+ZYDIS_PE_CFLAGS
+ZYDIS_PE_LIBS
 XMKMF
 CPP
+WAYLAND_CLIENT_CFLAGS
+WAYLAND_CLIENT_LIBS
+XKBCOMMON_CFLAGS
+XKBCOMMON_LIBS
+XKBREGISTRY_CFLAGS
+XKBREGISTRY_LIBS
 INOTIFY_CFLAGS
 INOTIFY_LIBS
 DBUS_CFLAGS
 DBUS_LIBS
 GNUTLS_CFLAGS
 GNUTLS_LIBS
+DRM_CFLAGS
+DRM_LIBS
+DRMAMDGPU_CFLAGS
+DRMAMDGPU_LIBS
+GMP_CFLAGS
+GMP_LIBS
 SANE_CFLAGS
 SANE_LIBS
 USB_CFLAGS
@@ -1772,7 +1863,9 @@ KRB5_LIBS
 GSSAPI_CFLAGS
 GSSAPI_LIBS
 NETAPI_CFLAGS
-NETAPI_LIBS'
+NETAPI_LIBS
+GCRYPT_CFLAGS
+GCRYPT_LIBS'
 
 
 # Initialize some variables set by options.
@@ -1881,7 +1974,7 @@ do
     ac_useropt=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
     # Reject names that are not valid shell variable names.
     expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error $? "invalid feature name: \`$ac_useropt'"
+      as_fn_error $? "invalid feature name: '$ac_useropt'"
     ac_useropt_orig=$ac_useropt
     ac_useropt=`printf "%s\n" "$ac_useropt" | sed 's/[-+.]/_/g'`
     case $ac_user_opts in
@@ -1907,7 +2000,7 @@ do
     ac_useropt=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
     expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error $? "invalid feature name: \`$ac_useropt'"
+      as_fn_error $? "invalid feature name: '$ac_useropt'"
     ac_useropt_orig=$ac_useropt
     ac_useropt=`printf "%s\n" "$ac_useropt" | sed 's/[-+.]/_/g'`
     case $ac_user_opts in
@@ -2120,7 +2213,7 @@ do
     ac_useropt=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
     expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error $? "invalid package name: \`$ac_useropt'"
+      as_fn_error $? "invalid package name: '$ac_useropt'"
     ac_useropt_orig=$ac_useropt
     ac_useropt=`printf "%s\n" "$ac_useropt" | sed 's/[-+.]/_/g'`
     case $ac_user_opts in
@@ -2136,7 +2229,7 @@ do
     ac_useropt=`expr "x$ac_option" : 'x-*without-\(.*\)'`
     # Reject names that are not valid shell variable names.
     expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error $? "invalid package name: \`$ac_useropt'"
+      as_fn_error $? "invalid package name: '$ac_useropt'"
     ac_useropt_orig=$ac_useropt
     ac_useropt=`printf "%s\n" "$ac_useropt" | sed 's/[-+.]/_/g'`
     case $ac_user_opts in
@@ -2166,8 +2259,8 @@ do
   | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
     x_libraries=$ac_optarg ;;
 
-  -*) as_fn_error $? "unrecognized option: \`$ac_option'
-Try \`$0 --help' for more information"
+  -*) as_fn_error $? "unrecognized option: '$ac_option'
+Try '$0 --help' for more information"
     ;;
 
   *=*)
@@ -2175,7 +2268,7 @@ Try \`$0 --help' for more information"
     # Reject names that are not valid shell variable names.
     case $ac_envvar in #(
       '' | [0-9]* | *[!_$as_cr_alnum]* )
-      as_fn_error $? "invalid variable name: \`$ac_envvar'" ;;
+      as_fn_error $? "invalid variable name: '$ac_envvar'" ;;
     esac
     eval $ac_envvar=\$ac_optarg
     export $ac_envvar ;;
@@ -2225,7 +2318,7 @@ do
   as_fn_error $? "expected an absolute directory name for --$ac_var: $ac_val"
 done
 
-# There might be people who depend on the old broken behavior: `$host'
+# There might be people who depend on the old broken behavior: '$host'
 # used to hold the argument of --host etc.
 # FIXME: To remove some day.
 build=$build_alias
@@ -2293,7 +2386,7 @@ if test ! -r "$srcdir/$ac_unique_file"; then
   test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
   as_fn_error $? "cannot find sources ($ac_unique_file) in $srcdir"
 fi
-ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
+ac_msg="sources are in $srcdir, but 'cd $srcdir' does not work"
 ac_abs_confdir=`(
 	cd "$srcdir" && test -r "./$ac_unique_file" || as_fn_error $? "$ac_msg"
 	pwd)`
@@ -2321,7 +2414,7 @@ if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures Wine 8.0 to adapt to many kinds of systems.
+'configure' configures Wine 9.0 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -2335,11 +2428,11 @@ Configuration:
       --help=short        display options specific to this package
       --help=recursive    display the short help of all the included packages
   -V, --version           display version information and exit
-  -q, --quiet, --silent   do not print \`checking ...' messages
+  -q, --quiet, --silent   do not print 'checking ...' messages
       --cache-file=FILE   cache test results in FILE [disabled]
-  -C, --config-cache      alias for \`--cache-file=config.cache'
+  -C, --config-cache      alias for '--cache-file=config.cache'
   -n, --no-create         do not create output files
-      --srcdir=DIR        find the sources in DIR [configure dir or \`..']
+      --srcdir=DIR        find the sources in DIR [configure dir or '..']
 
 Installation directories:
   --prefix=PREFIX         install architecture-independent files in PREFIX
@@ -2347,10 +2440,10 @@ Installation directories:
   --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
                           [PREFIX]
 
-By default, \`make install' will install all the files in
-\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
-an installation prefix other than \`$ac_default_prefix' using \`--prefix',
-for instance \`--prefix=\$HOME'.
+By default, 'make install' will install all the files in
+'$ac_default_prefix/bin', '$ac_default_prefix/lib' etc.  You can specify
+an installation prefix other than '$ac_default_prefix' using '--prefix',
+for instance '--prefix=\$HOME'.
 
 For better control, use the options below.
 
@@ -2391,7 +2484,7 @@ fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of Wine 8.0:";;
+     short | recursive ) echo "Configuration of Wine 9.0:";;
    esac
   cat <<\_ACEOF
 
@@ -2411,6 +2504,7 @@ Optional Features:
   --enable-silent-rules   use silent build rules (override: "make V=1")
   --enable-werror         treat compilation warnings as errors
   --disable-largefile     omit support for large files
+  --enable-year2038       support timestamps after 2038
 
 Optional Packages:
   --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
@@ -2423,6 +2517,7 @@ Optional Packages:
   --with-float-abi=abi    specify the ABI (soft|softfp|hard) for ARM platforms
   --without-fontconfig    do not use fontconfig
   --without-freetype      do not use the FreeType library
+  --without-gcrypt        do not use libgcrypt
   --without-gettext       do not use gettext
   --with-gettextpo        use the GetTextPO library to rebuild po files
   --without-gphoto        do not use gphoto (Digital Camera support)
@@ -2438,6 +2533,7 @@ Optional Packages:
   --without-osmesa        do not use the OSMesa library
   --without-oss           do not use the OSS sound support
   --without-pcap          do not use the Packet Capture library
+  --without-pcsclite      do not use PCSC lite
   --without-pthread       do not use the pthread library
   --without-pulse         do not use PulseAudio sound support
   --without-sane          do not use SANE (scanner support)
@@ -2447,7 +2543,9 @@ Optional Packages:
                           handling)
   --without-usb           do not use the libusb library
   --without-v4l2          do not use v4l2 (video capture)
+  --without-vosk          do not use Vosk
   --without-vulkan        do not use Vulkan
+  --without-wayland       do not build the Wayland driver
   --without-xcomposite    do not use the Xcomposite extension
   --without-xcursor       do not use the Xcursor extension
   --without-xfixes        do not use Xfixes for clipboard change notifications
@@ -2483,6 +2581,12 @@ Some influential environment variables:
               version
   FAUDIO_PE_LIBS
               Linker flags for the PE faudio, overriding the bundled version
+  FLUIDSYNTH_PE_CFLAGS
+              C compiler flags for the PE fluidsynth, overriding the bundled
+              version
+  FLUIDSYNTH_PE_LIBS
+              Linker flags for the PE fluidsynth, overriding the bundled
+              version
   GSM_PE_CFLAGS
               C compiler flags for the PE gsm, overriding the bundled version
   GSM_PE_LIBS Linker flags for the PE gsm, overriding the bundled version
@@ -2507,6 +2611,10 @@ Some influential environment variables:
               version
   MPG123_PE_LIBS
               Linker flags for the PE mpg123, overriding the bundled version
+  MUSL_PE_CFLAGS
+              C compiler flags for the PE musl, overriding the bundled version
+  MUSL_PE_LIBS
+              Linker flags for the PE musl, overriding the bundled version
   PNG_PE_CFLAGS
               C compiler flags for the PE png, overriding the bundled version
   PNG_PE_LIBS Linker flags for the PE png, overriding the bundled version
@@ -2531,8 +2639,25 @@ Some influential environment variables:
               C compiler flags for the PE zlib, overriding the bundled version
   ZLIB_PE_LIBS
               Linker flags for the PE zlib, overriding the bundled version
+  ZYDIS_PE_CFLAGS
+              C compiler flags for the PE zydis, overriding the bundled
+              version
+  ZYDIS_PE_LIBS
+              Linker flags for the PE zydis, overriding the bundled version
   XMKMF       Path to xmkmf, Makefile generator for X Window System
   CPP         C preprocessor
+  WAYLAND_CLIENT_CFLAGS
+              C compiler flags for wayland-client, overriding pkg-config
+  WAYLAND_CLIENT_LIBS
+              Linker flags for wayland-client, overriding pkg-config
+  XKBCOMMON_CFLAGS
+              C compiler flags for xkbcommon, overriding pkg-config
+  XKBCOMMON_LIBS
+              Linker flags for xkbcommon, overriding pkg-config
+  XKBREGISTRY_CFLAGS
+              C compiler flags for xkbregistry, overriding pkg-config
+  XKBREGISTRY_LIBS
+              Linker flags for xkbregistry, overriding pkg-config
   INOTIFY_CFLAGS
               C compiler flags for libinotify, overriding pkg-config
   INOTIFY_LIBS
@@ -2542,6 +2667,14 @@ Some influential environment variables:
   GNUTLS_CFLAGS
               C compiler flags for gnutls, overriding pkg-config
   GNUTLS_LIBS Linker flags for gnutls, overriding pkg-config
+  DRM_CFLAGS  C compiler flags for libdrm, overriding pkg-config
+  DRM_LIBS    Linker flags for libdrm, overriding pkg-config
+  DRMAMDGPU_CFLAGS
+              C compiler flags for libdrm_amdgpu, overriding pkg-config
+  DRMAMDGPU_LIBS
+              Linker flags for libdrm_amdgpu, overriding pkg-config
+  GMP_CFLAGS  C compiler flags for gmp, overriding pkg-config
+  GMP_LIBS    Linker flags for gmp, overriding pkg-config
   SANE_CFLAGS C compiler flags for sane-backends, overriding pkg-config
   SANE_LIBS   Linker flags for sane-backends, overriding pkg-config
   USB_CFLAGS  C compiler flags for libusb-1.0, overriding pkg-config
@@ -2563,10 +2696,12 @@ Some influential environment variables:
   PULSE_LIBS  Linker flags for libpulse, overriding pkg-config
   GSTREAMER_CFLAGS
               C compiler flags for gstreamer-1.0 gstreamer-video-1.0
-              gstreamer-audio-1.0, overriding pkg-config
+              gstreamer-audio-1.0 gstreamer-tag-1.0 gstreamer-gl-1.0,
+              overriding pkg-config
   GSTREAMER_LIBS
               Linker flags for gstreamer-1.0 gstreamer-video-1.0
-              gstreamer-audio-1.0, overriding pkg-config
+              gstreamer-audio-1.0 gstreamer-tag-1.0 gstreamer-gl-1.0,
+              overriding pkg-config
   UDEV_CFLAGS C compiler flags for libudev, overriding pkg-config
   UDEV_LIBS   Linker flags for libudev, overriding pkg-config
   UNWIND_CFLAGS
@@ -2591,8 +2726,11 @@ Some influential environment variables:
   NETAPI_CFLAGS
               C compiler flags for netapi, overriding pkg-config
   NETAPI_LIBS Linker flags for netapi, overriding pkg-config
+  GCRYPT_CFLAGS
+              C compiler flags for libgcrypt, overriding pkg-config
+  GCRYPT_LIBS Linker flags for libgcrypt, overriding pkg-config
 
-Use these variables to override the choices made by `configure' or to help
+Use these variables to override the choices made by 'configure' or to help
 it to find libraries and programs with nonstandard names/locations.
 
 Report bugs to <wine-devel@winehq.org>.
@@ -2660,10 +2798,10 @@ fi
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-Wine configure 8.0
-generated by GNU Autoconf 2.71
+Wine configure 9.0
+generated by GNU Autoconf 2.72
 
-Copyright (C) 2021 Free Software Foundation, Inc.
+Copyright (C) 2023 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 _ACEOF
@@ -2702,11 +2840,12 @@ printf "%s\n" "$ac_try_echo"; } >&5
        } && test -s conftest.$ac_objext
 then :
   ac_retval=0
-else $as_nop
-  printf "%s\n" "$as_me: failed program was:" >&5
+else case e in #(
+  e) printf "%s\n" "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_retval=1
+	ac_retval=1 ;;
+esac
 fi
   eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
   as_fn_set_status $ac_retval
@@ -2741,11 +2880,12 @@ printf "%s\n" "$ac_try_echo"; } >&5
        } && test -s conftest.$ac_objext
 then :
   ac_retval=0
-else $as_nop
-  printf "%s\n" "$as_me: failed program was:" >&5
+else case e in #(
+  e) printf "%s\n" "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_retval=1
+	ac_retval=1 ;;
+esac
 fi
   eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
   as_fn_set_status $ac_retval
@@ -2783,11 +2923,12 @@ printf "%s\n" "$ac_try_echo"; } >&5
        }
 then :
   ac_retval=0
-else $as_nop
-  printf "%s\n" "$as_me: failed program was:" >&5
+else case e in #(
+  e) printf "%s\n" "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_retval=1
+	ac_retval=1 ;;
+esac
 fi
   # Delete the IPA/IPO (Inter Procedural Analysis/Optimization) information
   # created by the PGI compiler (conftest_ipa8_conftest.oo), as it would
@@ -2811,8 +2952,8 @@ printf %s "checking for $2... " >&6; }
 if eval test \${$3+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 $4
 #include <$2>
@@ -2820,10 +2961,12 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   eval "$3=yes"
-else $as_nop
-  eval "$3=no"
+else case e in #(
+  e) eval "$3=no" ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 eval ac_res=\$$3
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -2860,11 +3003,12 @@ printf "%s\n" "$ac_try_echo"; } >&5
        } && test -s conftest.$ac_objext
 then :
   ac_retval=0
-else $as_nop
-  printf "%s\n" "$as_me: failed program was:" >&5
+else case e in #(
+  e) printf "%s\n" "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_retval=1
+	ac_retval=1 ;;
+esac
 fi
   eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
   as_fn_set_status $ac_retval
@@ -2882,15 +3026,15 @@ printf %s "checking for $2... " >&6; }
 if eval test \${$3+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 /* Define $2 to an innocuous variant, in case <limits.h> declares $2.
    For example, HP-UX 11i <limits.h> declares gettimeofday.  */
 #define $2 innocuous_$2
 
 /* System header to define __stub macros and hopefully few prototypes,
-   which can conflict with char $2 (); below.  */
+   which can conflict with char $2 (void); below.  */
 
 #include <limits.h>
 #undef $2
@@ -2901,7 +3045,7 @@ else $as_nop
 #ifdef __cplusplus
 extern "C"
 #endif
-char $2 ();
+char $2 (void);
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
@@ -2920,11 +3064,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$3=yes"
-else $as_nop
-  eval "$3=no"
+else case e in #(
+  e) eval "$3=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 eval ac_res=\$$3
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -2960,11 +3106,12 @@ printf "%s\n" "$ac_try_echo"; } >&5
        }
 then :
   ac_retval=0
-else $as_nop
-  printf "%s\n" "$as_me: failed program was:" >&5
+else case e in #(
+  e) printf "%s\n" "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-    ac_retval=1
+    ac_retval=1 ;;
+esac
 fi
   eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
   as_fn_set_status $ac_retval
@@ -2983,8 +3130,8 @@ printf %s "checking for $2.$3... " >&6; }
 if eval test \${$4+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 $5
 int
@@ -3000,8 +3147,8 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   eval "$4=yes"
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 $5
 int
@@ -3017,12 +3164,15 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   eval "$4=yes"
-else $as_nop
-  eval "$4=no"
+else case e in #(
+  e) eval "$4=no" ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 eval ac_res=\$$4
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -3043,8 +3193,8 @@ printf %s "checking for $2... " >&6; }
 if eval test \${$3+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  eval "$3=no"
+else case e in #(
+  e) eval "$3=no"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 $4
@@ -3074,12 +3224,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
 
-else $as_nop
-  eval "$3=yes"
+else case e in #(
+  e) eval "$3=yes" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 eval ac_res=\$$3
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -3111,8 +3263,8 @@ cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by Wine $as_me 8.0, which was
-generated by GNU Autoconf 2.71.  Invocation command line was
+It was created by Wine $as_me 9.0, which was
+generated by GNU Autoconf 2.72.  Invocation command line was
 
   $ $0$ac_configure_args_raw
 
@@ -3358,10 +3510,10 @@ esac
 printf "%s\n" "$as_me: loading site script $ac_site_file" >&6;}
     sed 's/^/| /' "$ac_site_file" >&5
     . "$ac_site_file" \
-      || { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+      || { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
 as_fn_error $? "failed to load site script $ac_site_file
-See \`config.log' for more details" "$LINENO" 5; }
+See 'config.log' for more details" "$LINENO" 5; }
   fi
 done
 
@@ -3397,9 +3549,7 @@ struct stat;
 /* Most of the following tests are stolen from RCS 5.7 src/conf.sh.  */
 struct buf { int x; };
 struct buf * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
+static char *e (char **p, int i)
 {
   return p[i];
 }
@@ -3413,6 +3563,21 @@ static char *f (char * (*g) (char **, int), char **p, ...)
   return s;
 }
 
+/* C89 style stringification. */
+#define noexpand_stringify(a) #a
+const char *stringified = noexpand_stringify(arbitrary+token=sequence);
+
+/* C89 style token pasting.  Exercises some of the corner cases that
+   e.g. old MSVC gets wrong, but not very hard. */
+#define noexpand_concat(a,b) a##b
+#define expand_concat(a,b) noexpand_concat(a,b)
+extern int vA;
+extern int vbee;
+#define aye A
+#define bee B
+int *pvA = &expand_concat(v,aye);
+int *pvbee = &noexpand_concat(v,bee);
+
 /* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
    function prototypes and stuff, but not \xHH hex character constants.
    These do not provoke an error unfortunately, instead are silently treated
@@ -3440,16 +3605,19 @@ ok |= (argc == 0 || f (e, argv, 0) != argv[0] || f (e, argv, 1) != argv[1]);
 
 # Test code for whether the C compiler supports C99 (global declarations)
 ac_c_conftest_c99_globals='
-// Does the compiler advertise C99 conformance?
+/* Does the compiler advertise C99 conformance? */
 #if !defined __STDC_VERSION__ || __STDC_VERSION__ < 199901L
 # error "Compiler does not advertise C99 conformance"
 #endif
 
+// See if C++-style comments work.
+
 #include <stdbool.h>
 extern int puts (const char *);
 extern int printf (const char *, ...);
 extern int dprintf (int, const char *, ...);
 extern void *malloc (size_t);
+extern void free (void *);
 
 // Check varargs macros.  These examples are taken from C99 6.10.3.5.
 // dprintf is used instead of fprintf to avoid needing to declare
@@ -3499,7 +3667,6 @@ typedef const char *ccp;
 static inline int
 test_restrict (ccp restrict text)
 {
-  // See if C++-style comments work.
   // Iterate through items via the restricted pointer.
   // Also check for declarations in for loops.
   for (unsigned int i = 0; *(text+i) != '\''\0'\''; ++i)
@@ -3565,6 +3732,8 @@ ac_c_conftest_c99_main='
   ia->datasize = 10;
   for (int i = 0; i < ia->datasize; ++i)
     ia->data[i] = i * 1.234;
+  // Work around memory leak warnings.
+  free (ia);
 
   // Check named initializers.
   struct named_init ni = {
@@ -3586,7 +3755,7 @@ ac_c_conftest_c99_main='
 
 # Test code for whether the C compiler supports C11 (global declarations)
 ac_c_conftest_c11_globals='
-// Does the compiler advertise C11 conformance?
+/* Does the compiler advertise C11 conformance? */
 #if !defined __STDC_VERSION__ || __STDC_VERSION__ < 201112L
 # error "Compiler does not advertise C11 conformance"
 #endif
@@ -3994,8 +4163,9 @@ IFS=$as_save_IFS
 if $as_found
 then :
 
-else $as_nop
-  as_fn_error $? "cannot find required auxiliary files:$ac_missing_aux_files" "$LINENO" 5
+else case e in #(
+  e) as_fn_error $? "cannot find required auxiliary files:$ac_missing_aux_files" "$LINENO" 5 ;;
+esac
 fi
 
 
@@ -4023,12 +4193,12 @@ for ac_var in $ac_precious_vars; do
   eval ac_new_val=\$ac_env_${ac_var}_value
   case $ac_old_set,$ac_new_set in
     set,)
-      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
-printf "%s\n" "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
+      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: '$ac_var' was set to '$ac_old_val' in the previous run" >&5
+printf "%s\n" "$as_me: error: '$ac_var' was set to '$ac_old_val' in the previous run" >&2;}
       ac_cache_corrupted=: ;;
     ,set)
-      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' was not set in the previous run" >&5
-printf "%s\n" "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
+      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: '$ac_var' was not set in the previous run" >&5
+printf "%s\n" "$as_me: error: '$ac_var' was not set in the previous run" >&2;}
       ac_cache_corrupted=: ;;
     ,);;
     *)
@@ -4037,18 +4207,18 @@ printf "%s\n" "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
 	ac_old_val_w=`echo x $ac_old_val`
 	ac_new_val_w=`echo x $ac_new_val`
 	if test "$ac_old_val_w" != "$ac_new_val_w"; then
-	  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' has changed since the previous run:" >&5
-printf "%s\n" "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
+	  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: '$ac_var' has changed since the previous run:" >&5
+printf "%s\n" "$as_me: error: '$ac_var' has changed since the previous run:" >&2;}
 	  ac_cache_corrupted=:
 	else
-	  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: warning: ignoring whitespace changes in \`$ac_var' since the previous run:" >&5
-printf "%s\n" "$as_me: warning: ignoring whitespace changes in \`$ac_var' since the previous run:" >&2;}
+	  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: warning: ignoring whitespace changes in '$ac_var' since the previous run:" >&5
+printf "%s\n" "$as_me: warning: ignoring whitespace changes in '$ac_var' since the previous run:" >&2;}
 	  eval $ac_var=\$ac_old_val
 	fi
-	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}:   former value:  \`$ac_old_val'" >&5
-printf "%s\n" "$as_me:   former value:  \`$ac_old_val'" >&2;}
-	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}:   current value: \`$ac_new_val'" >&5
-printf "%s\n" "$as_me:   current value: \`$ac_new_val'" >&2;}
+	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}:   former value:  '$ac_old_val'" >&5
+printf "%s\n" "$as_me:   former value:  '$ac_old_val'" >&2;}
+	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}:   current value: '$ac_new_val'" >&5
+printf "%s\n" "$as_me:   current value: '$ac_new_val'" >&2;}
       fi;;
   esac
   # Pass precious variables to config.status.
@@ -4064,11 +4234,11 @@ printf "%s\n" "$as_me:   current value: \`$ac_new_val'" >&2;}
   fi
 done
 if $ac_cache_corrupted; then
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: changes in the environment can compromise the build" >&5
 printf "%s\n" "$as_me: error: changes in the environment can compromise the build" >&2;}
-  as_fn_error $? "run \`${MAKE-make} distclean' and/or \`rm $cache_file'
+  as_fn_error $? "run '${MAKE-make} distclean' and/or 'rm $cache_file'
 	    and start over" "$LINENO" 5
 fi
 ## -------------------- ##
@@ -4196,6 +4366,13 @@ then :
 fi
 
 
+# Check whether --with-gcrypt was given.
+if test ${with_gcrypt+y}
+then :
+  withval=$with_gcrypt;
+fi
+
+
 # Check whether --with-gettext was given.
 if test ${with_gettext+y}
 then :
@@ -4301,10 +4478,17 @@ then :
 fi
 
 
+# Check whether --with-pcsclite was given.
+if test ${with_pcsclite+y}
+then :
+  withval=$with_pcsclite;
+fi
+
+
 # Check whether --with-pthread was given.
 if test ${with_pthread+y}
 then :
-  withval=$with_pthread; if test "x$withval" = "xno"; then ac_cv_header_pthread_h=no; fi
+  withval=$with_pthread;
 fi
 
 
@@ -4357,6 +4541,13 @@ then :
 fi
 
 
+# Check whether --with-vosk was given.
+if test ${with_vosk+y}
+then :
+  withval=$with_vosk;
+fi
+
+
 # Check whether --with-vulkan was given.
 if test ${with_vulkan+y}
 then :
@@ -4364,6 +4555,13 @@ then :
 fi
 
 
+# Check whether --with-wayland was given.
+if test ${with_wayland+y}
+then :
+  withval=$with_wayland;
+fi
+
+
 # Check whether --with-xcomposite was given.
 if test ${with_xcomposite+y}
 then :
@@ -4476,15 +4674,16 @@ printf %s "checking build system type... " >&6; }
 if test ${ac_cv_build+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_build_alias=$build_alias
+else case e in #(
+  e) ac_build_alias=$build_alias
 test "x$ac_build_alias" = x &&
   ac_build_alias=`$SHELL "${ac_aux_dir}config.guess"`
 test "x$ac_build_alias" = x &&
   as_fn_error $? "cannot guess build type; you must specify one" "$LINENO" 5
 ac_cv_build=`$SHELL "${ac_aux_dir}config.sub" $ac_build_alias` ||
   as_fn_error $? "$SHELL ${ac_aux_dir}config.sub $ac_build_alias failed" "$LINENO" 5
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_build" >&5
 printf "%s\n" "$ac_cv_build" >&6; }
@@ -4511,14 +4710,15 @@ printf %s "checking host system type... " >&6; }
 if test ${ac_cv_host+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test "x$host_alias" = x; then
+else case e in #(
+  e) if test "x$host_alias" = x; then
   ac_cv_host=$ac_cv_build
 else
   ac_cv_host=`$SHELL "${ac_aux_dir}config.sub" $host_alias` ||
     as_fn_error $? "$SHELL ${ac_aux_dir}config.sub $host_alias failed" "$LINENO" 5
 fi
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_host" >&5
 printf "%s\n" "$ac_cv_host" >&6; }
@@ -4557,8 +4757,8 @@ ac_make=`printf "%s\n" "$2" | sed 's/+/p/g; s/[^a-zA-Z0-9_]/_/g'`
 if eval test \${ac_cv_prog_make_${ac_make}_set+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat >conftest.make <<\_ACEOF
+else case e in #(
+  e) cat >conftest.make <<\_ACEOF
 SHELL = /bin/sh
 all:
 	@echo '@@@%%%=$(MAKE)=@@@%%%'
@@ -4570,7 +4770,8 @@ case `${MAKE-make} -f conftest.make 2>/dev/null` in
   *)
     eval ac_cv_prog_make_${ac_make}_set=no;;
 esac
-rm -f conftest.make
+rm -f conftest.make ;;
+esac
 fi
 if eval test \$ac_cv_prog_make_${ac_make}_set = yes; then
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
@@ -4604,8 +4805,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$CC"; then
+else case e in #(
+  e) if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -4627,7 +4828,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
@@ -4649,8 +4851,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_CC"; then
+else case e in #(
+  e) if test -n "$ac_ct_CC"; then
   ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -4672,7 +4874,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_CC=$ac_cv_prog_ac_ct_CC
 if test -n "$ac_ct_CC"; then
@@ -4707,8 +4910,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$CC"; then
+else case e in #(
+  e) if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -4730,7 +4933,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
@@ -4752,8 +4956,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$CC"; then
+else case e in #(
+  e) if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
   ac_prog_rejected=no
@@ -4792,7 +4996,8 @@ if test $ac_prog_rejected = yes; then
     ac_cv_prog_CC="$as_dir$ac_word${1+' '}$@"
   fi
 fi
-fi
+fi ;;
+esac
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
@@ -4816,8 +5021,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$CC"; then
+else case e in #(
+  e) if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -4839,7 +5044,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
@@ -4865,8 +5071,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_CC"; then
+else case e in #(
+  e) if test -n "$ac_ct_CC"; then
   ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -4888,7 +5094,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_CC=$ac_cv_prog_ac_ct_CC
 if test -n "$ac_ct_CC"; then
@@ -4926,8 +5133,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$CC"; then
+else case e in #(
+  e) if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -4949,7 +5156,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
@@ -4971,8 +5179,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_CC"; then
+else case e in #(
+  e) if test -n "$ac_ct_CC"; then
   ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -4994,7 +5202,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_CC=$ac_cv_prog_ac_ct_CC
 if test -n "$ac_ct_CC"; then
@@ -5023,16 +5232,16 @@ fi
 fi
 
 
-test -z "$CC" && { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+test -z "$CC" && { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
 as_fn_error $? "no acceptable C compiler found in \$PATH
-See \`config.log' for more details" "$LINENO" 5; }
+See 'config.log' for more details" "$LINENO" 5; }
 
 # Provide some information about the compiler.
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
 set X $ac_compile
 ac_compiler=$2
-for ac_option in --version -v -V -qversion -version; do
+for ac_option in --version ; do
   { { ac_try="$ac_compiler $ac_option >&5"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
@@ -5098,8 +5307,8 @@ printf "%s\n" "$ac_try_echo"; } >&5
   printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
 then :
-  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
-# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
+  # Autoconf-2.13 could set the ac_cv_exeext variable to 'no'.
+# So ignore a value of 'no', otherwise this would lead to 'EXEEXT = no'
 # in a Makefile.  We should not override ac_cv_exeext if it was cached,
 # so that the user can short-circuit this test for compilers unknown to
 # Autoconf.
@@ -5119,7 +5328,7 @@ do
 	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
 	fi
 	# We set ac_cv_exeext here because the later test for it is not
-	# safe: cross compilers may not add the suffix if given an `-o'
+	# safe: cross compilers may not add the suffix if given an '-o'
 	# argument, so we may need to know it at that point already.
 	# Even if this section looks crufty: it has the advantage of
 	# actually working.
@@ -5130,8 +5339,9 @@ do
 done
 test "$ac_cv_exeext" = no && ac_cv_exeext=
 
-else $as_nop
-  ac_file=''
+else case e in #(
+  e) ac_file='' ;;
+esac
 fi
 if test -z "$ac_file"
 then :
@@ -5140,13 +5350,14 @@ printf "%s\n" "no" >&6; }
 printf "%s\n" "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
 as_fn_error 77 "C compiler cannot create executables
-See \`config.log' for more details" "$LINENO" 5; }
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-printf "%s\n" "yes" >&6; }
+See 'config.log' for more details" "$LINENO" 5; }
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; } ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
 printf %s "checking for C compiler default output file name... " >&6; }
@@ -5170,10 +5381,10 @@ printf "%s\n" "$ac_try_echo"; } >&5
   printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
 then :
-  # If both `conftest.exe' and `conftest' are `present' (well, observable)
-# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
-# work properly (i.e., refer to `conftest.exe'), while it won't with
-# `rm'.
+  # If both 'conftest.exe' and 'conftest' are 'present' (well, observable)
+# catch 'conftest.exe'.  For instance with Cygwin, 'ls conftest' will
+# work properly (i.e., refer to 'conftest.exe'), while it won't with
+# 'rm'.
 for ac_file in conftest.exe conftest conftest.*; do
   test -f "$ac_file" || continue
   case $ac_file in
@@ -5183,11 +5394,12 @@ for ac_file in conftest.exe conftest conftest.*; do
     * ) break;;
   esac
 done
-else $as_nop
-  { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+else case e in #(
+  e) { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
 as_fn_error $? "cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details" "$LINENO" 5; }
+See 'config.log' for more details" "$LINENO" 5; } ;;
+esac
 fi
 rm -f conftest conftest$ac_cv_exeext
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_exeext" >&5
@@ -5203,6 +5415,8 @@ int
 main (void)
 {
 FILE *f = fopen ("conftest.out", "w");
+ if (!f)
+  return 1;
  return ferror (f) || fclose (f) != 0;
 
   ;
@@ -5242,26 +5456,27 @@ printf "%s\n" "$ac_try_echo"; } >&5
     if test "$cross_compiling" = maybe; then
 	cross_compiling=yes
     else
-	{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+	{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
 as_fn_error 77 "cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details" "$LINENO" 5; }
+If you meant to cross compile, use '--host'.
+See 'config.log' for more details" "$LINENO" 5; }
     fi
   fi
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $cross_compiling" >&5
 printf "%s\n" "$cross_compiling" >&6; }
 
-rm -f conftest.$ac_ext conftest$ac_cv_exeext conftest.out
+rm -f conftest.$ac_ext conftest$ac_cv_exeext \
+  conftest.o conftest.obj conftest.out
 ac_clean_files=$ac_clean_files_save
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for suffix of object files" >&5
 printf %s "checking for suffix of object files... " >&6; }
 if test ${ac_cv_objext+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -5293,16 +5508,18 @@ then :
        break;;
   esac
 done
-else $as_nop
-  printf "%s\n" "$as_me: failed program was:" >&5
+else case e in #(
+  e) printf "%s\n" "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
 as_fn_error $? "cannot compute suffix of object files: cannot compile
-See \`config.log' for more details" "$LINENO" 5; }
+See 'config.log' for more details" "$LINENO" 5; } ;;
+esac
 fi
-rm -f conftest.$ac_cv_objext conftest.$ac_ext
+rm -f conftest.$ac_cv_objext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_objext" >&5
 printf "%s\n" "$ac_cv_objext" >&6; }
@@ -5313,8 +5530,8 @@ printf %s "checking whether the compiler supports GNU C... " >&6; }
 if test ${ac_cv_c_compiler_gnu+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -5331,12 +5548,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_compiler_gnu=yes
-else $as_nop
-  ac_compiler_gnu=no
+else case e in #(
+  e) ac_compiler_gnu=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 ac_cv_c_compiler_gnu=$ac_compiler_gnu
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_compiler_gnu" >&5
 printf "%s\n" "$ac_cv_c_compiler_gnu" >&6; }
@@ -5354,8 +5573,8 @@ printf %s "checking whether $CC accepts -g... " >&6; }
 if test ${ac_cv_prog_cc_g+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_save_c_werror_flag=$ac_c_werror_flag
+else case e in #(
+  e) ac_save_c_werror_flag=$ac_c_werror_flag
    ac_c_werror_flag=yes
    ac_cv_prog_cc_g=no
    CFLAGS="-g"
@@ -5373,8 +5592,8 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_prog_cc_g=yes
-else $as_nop
-  CFLAGS=""
+else case e in #(
+  e) CFLAGS=""
       cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -5389,8 +5608,8 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
 
-else $as_nop
-  ac_c_werror_flag=$ac_save_c_werror_flag
+else case e in #(
+  e) ac_c_werror_flag=$ac_save_c_werror_flag
 	 CFLAGS="-g"
 	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -5407,12 +5626,15 @@ if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_prog_cc_g=yes
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
+   ac_c_werror_flag=$ac_save_c_werror_flag ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_g" >&5
 printf "%s\n" "$ac_cv_prog_cc_g" >&6; }
@@ -5439,8 +5661,8 @@ printf %s "checking for $CC option to enable C11 features... " >&6; }
 if test ${ac_cv_prog_cc_c11+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_cv_prog_cc_c11=no
+else case e in #(
+  e) ac_cv_prog_cc_c11=no
 ac_save_CC=$CC
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -5457,25 +5679,28 @@ rm -f core conftest.err conftest.$ac_objext conftest.beam
   test "x$ac_cv_prog_cc_c11" != "xno" && break
 done
 rm -f conftest.$ac_ext
-CC=$ac_save_CC
+CC=$ac_save_CC ;;
+esac
 fi
 
 if test "x$ac_cv_prog_cc_c11" = xno
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
 printf "%s\n" "unsupported" >&6; }
-else $as_nop
-  if test "x$ac_cv_prog_cc_c11" = x
+else case e in #(
+  e) if test "x$ac_cv_prog_cc_c11" = x
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
 printf "%s\n" "none needed" >&6; }
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c11" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c11" >&5
 printf "%s\n" "$ac_cv_prog_cc_c11" >&6; }
-     CC="$CC $ac_cv_prog_cc_c11"
+     CC="$CC $ac_cv_prog_cc_c11" ;;
+esac
 fi
   ac_cv_prog_cc_stdc=$ac_cv_prog_cc_c11
-  ac_prog_cc_stdc=c11
+  ac_prog_cc_stdc=c11 ;;
+esac
 fi
 fi
 if test x$ac_prog_cc_stdc = xno
@@ -5485,8 +5710,8 @@ printf %s "checking for $CC option to enable C99 features... " >&6; }
 if test ${ac_cv_prog_cc_c99+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_cv_prog_cc_c99=no
+else case e in #(
+  e) ac_cv_prog_cc_c99=no
 ac_save_CC=$CC
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -5503,25 +5728,28 @@ rm -f core conftest.err conftest.$ac_objext conftest.beam
   test "x$ac_cv_prog_cc_c99" != "xno" && break
 done
 rm -f conftest.$ac_ext
-CC=$ac_save_CC
+CC=$ac_save_CC ;;
+esac
 fi
 
 if test "x$ac_cv_prog_cc_c99" = xno
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
 printf "%s\n" "unsupported" >&6; }
-else $as_nop
-  if test "x$ac_cv_prog_cc_c99" = x
+else case e in #(
+  e) if test "x$ac_cv_prog_cc_c99" = x
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
 printf "%s\n" "none needed" >&6; }
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c99" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c99" >&5
 printf "%s\n" "$ac_cv_prog_cc_c99" >&6; }
-     CC="$CC $ac_cv_prog_cc_c99"
+     CC="$CC $ac_cv_prog_cc_c99" ;;
+esac
 fi
   ac_cv_prog_cc_stdc=$ac_cv_prog_cc_c99
-  ac_prog_cc_stdc=c99
+  ac_prog_cc_stdc=c99 ;;
+esac
 fi
 fi
 if test x$ac_prog_cc_stdc = xno
@@ -5531,8 +5759,8 @@ printf %s "checking for $CC option to enable C89 features... " >&6; }
 if test ${ac_cv_prog_cc_c89+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_cv_prog_cc_c89=no
+else case e in #(
+  e) ac_cv_prog_cc_c89=no
 ac_save_CC=$CC
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -5549,25 +5777,28 @@ rm -f core conftest.err conftest.$ac_objext conftest.beam
   test "x$ac_cv_prog_cc_c89" != "xno" && break
 done
 rm -f conftest.$ac_ext
-CC=$ac_save_CC
+CC=$ac_save_CC ;;
+esac
 fi
 
 if test "x$ac_cv_prog_cc_c89" = xno
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
 printf "%s\n" "unsupported" >&6; }
-else $as_nop
-  if test "x$ac_cv_prog_cc_c89" = x
+else case e in #(
+  e) if test "x$ac_cv_prog_cc_c89" = x
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
 printf "%s\n" "none needed" >&6; }
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c89" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c89" >&5
 printf "%s\n" "$ac_cv_prog_cc_c89" >&6; }
-     CC="$CC $ac_cv_prog_cc_c89"
+     CC="$CC $ac_cv_prog_cc_c89" ;;
+esac
 fi
   ac_cv_prog_cc_stdc=$ac_cv_prog_cc_c89
-  ac_prog_cc_stdc=c89
+  ac_prog_cc_stdc=c89 ;;
+esac
 fi
 fi
 
@@ -5602,8 +5833,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_CXX+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$CXX"; then
+else case e in #(
+  e) if test -n "$CXX"; then
   ac_cv_prog_CXX="$CXX" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -5625,7 +5856,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 CXX=$ac_cv_prog_CXX
 if test -n "$CXX"; then
@@ -5651,8 +5883,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_CXX+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_CXX"; then
+else case e in #(
+  e) if test -n "$ac_ct_CXX"; then
   ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -5674,7 +5906,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
 if test -n "$ac_ct_CXX"; then
@@ -5708,7 +5941,7 @@ fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for C++ compiler version" >&5
 set X $ac_compile
 ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
+for ac_option in --version; do
   { { ac_try="$ac_compiler $ac_option >&5"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
@@ -5734,8 +5967,8 @@ printf %s "checking whether the compiler supports GNU C++... " >&6; }
 if test ${ac_cv_cxx_compiler_gnu+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -5752,12 +5985,14 @@ _ACEOF
 if ac_fn_cxx_try_compile "$LINENO"
 then :
   ac_compiler_gnu=yes
-else $as_nop
-  ac_compiler_gnu=no
+else case e in #(
+  e) ac_compiler_gnu=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cxx_compiler_gnu" >&5
 printf "%s\n" "$ac_cv_cxx_compiler_gnu" >&6; }
@@ -5775,8 +6010,8 @@ printf %s "checking whether $CXX accepts -g... " >&6; }
 if test ${ac_cv_prog_cxx_g+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
+else case e in #(
+  e) ac_save_cxx_werror_flag=$ac_cxx_werror_flag
    ac_cxx_werror_flag=yes
    ac_cv_prog_cxx_g=no
    CXXFLAGS="-g"
@@ -5794,8 +6029,8 @@ _ACEOF
 if ac_fn_cxx_try_compile "$LINENO"
 then :
   ac_cv_prog_cxx_g=yes
-else $as_nop
-  CXXFLAGS=""
+else case e in #(
+  e) CXXFLAGS=""
       cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -5810,8 +6045,8 @@ _ACEOF
 if ac_fn_cxx_try_compile "$LINENO"
 then :
 
-else $as_nop
-  ac_cxx_werror_flag=$ac_save_cxx_werror_flag
+else case e in #(
+  e) ac_cxx_werror_flag=$ac_save_cxx_werror_flag
 	 CXXFLAGS="-g"
 	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -5828,12 +6063,15 @@ if ac_fn_cxx_try_compile "$LINENO"
 then :
   ac_cv_prog_cxx_g=yes
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
+   ac_cxx_werror_flag=$ac_save_cxx_werror_flag ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cxx_g" >&5
 printf "%s\n" "$ac_cv_prog_cxx_g" >&6; }
@@ -5857,11 +6095,11 @@ if test x$ac_prog_cxx_stdcxx = xno
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $CXX option to enable C++11 features" >&5
 printf %s "checking for $CXX option to enable C++11 features... " >&6; }
-if test ${ac_cv_prog_cxx_11+y}
+if test ${ac_cv_prog_cxx_cxx11+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_cv_prog_cxx_11=no
+else case e in #(
+  e) ac_cv_prog_cxx_cxx11=no
 ac_save_CXX=$CXX
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -5878,36 +6116,39 @@ rm -f core conftest.err conftest.$ac_objext conftest.beam
   test "x$ac_cv_prog_cxx_cxx11" != "xno" && break
 done
 rm -f conftest.$ac_ext
-CXX=$ac_save_CXX
+CXX=$ac_save_CXX ;;
+esac
 fi
 
 if test "x$ac_cv_prog_cxx_cxx11" = xno
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
 printf "%s\n" "unsupported" >&6; }
-else $as_nop
-  if test "x$ac_cv_prog_cxx_cxx11" = x
+else case e in #(
+  e) if test "x$ac_cv_prog_cxx_cxx11" = x
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
 printf "%s\n" "none needed" >&6; }
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cxx_cxx11" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cxx_cxx11" >&5
 printf "%s\n" "$ac_cv_prog_cxx_cxx11" >&6; }
-     CXX="$CXX $ac_cv_prog_cxx_cxx11"
+     CXX="$CXX $ac_cv_prog_cxx_cxx11" ;;
+esac
 fi
   ac_cv_prog_cxx_stdcxx=$ac_cv_prog_cxx_cxx11
-  ac_prog_cxx_stdcxx=cxx11
+  ac_prog_cxx_stdcxx=cxx11 ;;
+esac
 fi
 fi
 if test x$ac_prog_cxx_stdcxx = xno
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $CXX option to enable C++98 features" >&5
 printf %s "checking for $CXX option to enable C++98 features... " >&6; }
-if test ${ac_cv_prog_cxx_98+y}
+if test ${ac_cv_prog_cxx_cxx98+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_cv_prog_cxx_98=no
+else case e in #(
+  e) ac_cv_prog_cxx_cxx98=no
 ac_save_CXX=$CXX
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -5924,25 +6165,28 @@ rm -f core conftest.err conftest.$ac_objext conftest.beam
   test "x$ac_cv_prog_cxx_cxx98" != "xno" && break
 done
 rm -f conftest.$ac_ext
-CXX=$ac_save_CXX
+CXX=$ac_save_CXX ;;
+esac
 fi
 
 if test "x$ac_cv_prog_cxx_cxx98" = xno
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
 printf "%s\n" "unsupported" >&6; }
-else $as_nop
-  if test "x$ac_cv_prog_cxx_cxx98" = x
+else case e in #(
+  e) if test "x$ac_cv_prog_cxx_cxx98" = x
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
 printf "%s\n" "none needed" >&6; }
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cxx_cxx98" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cxx_cxx98" >&5
 printf "%s\n" "$ac_cv_prog_cxx_cxx98" >&6; }
-     CXX="$CXX $ac_cv_prog_cxx_cxx98"
+     CXX="$CXX $ac_cv_prog_cxx_cxx98" ;;
+esac
 fi
   ac_cv_prog_cxx_stdcxx=$ac_cv_prog_cxx_cxx98
-  ac_prog_cxx_stdcxx=cxx98
+  ac_prog_cxx_stdcxx=cxx98 ;;
+esac
 fi
 fi
 
@@ -5960,8 +6204,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_CPPBIN+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$CPPBIN"; then
+else case e in #(
+  e) if test -n "$CPPBIN"; then
   ac_cv_prog_CPPBIN="$CPPBIN" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -5983,7 +6227,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 CPPBIN=$ac_cv_prog_CPPBIN
 if test -n "$CPPBIN"; then
@@ -6005,8 +6250,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_CPPBIN+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_CPPBIN"; then
+else case e in #(
+  e) if test -n "$ac_ct_CPPBIN"; then
   ac_cv_prog_ac_ct_CPPBIN="$ac_ct_CPPBIN" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6028,7 +6273,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_CPPBIN=$ac_cv_prog_ac_ct_CPPBIN
 if test -n "$ac_ct_CPPBIN"; then
@@ -6065,8 +6311,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_LD+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$LD"; then
+else case e in #(
+  e) if test -n "$LD"; then
   ac_cv_prog_LD="$LD" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6088,7 +6334,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 LD=$ac_cv_prog_LD
 if test -n "$LD"; then
@@ -6110,8 +6357,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_LD+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_LD"; then
+else case e in #(
+  e) if test -n "$ac_ct_LD"; then
   ac_cv_prog_ac_ct_LD="$ac_ct_LD" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6133,7 +6380,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_LD=$ac_cv_prog_ac_ct_LD
 if test -n "$ac_ct_LD"; then
@@ -6183,8 +6431,8 @@ printf %s "checking whether $CC works... " >&6; }
 if test ${wine_cv_cc_m32+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -6198,11 +6446,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   wine_cv_cc_m32=yes
-else $as_nop
-  wine_cv_cc_m32=no
+else case e in #(
+  e) wine_cv_cc_m32=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_cc_m32" >&5
 printf "%s\n" "$wine_cv_cc_m32" >&6; }
@@ -6214,37 +6464,6 @@ printf "%s\n" "$wine_cv_cc_m32" >&6; }
       export PKG_CONFIG_LIBDIR
       with_unwind=${with_unwind:-no}
     else
-      if test "x${GCC}" = "xyes"
-      then
-        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports __builtin_ms_va_list" >&5
-printf %s "checking whether $CC supports __builtin_ms_va_list... " >&6; }
-if test ${wine_cv_builtin_ms_va_list+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <stdarg.h>
-int
-main (void)
-{
-void func(__builtin_ms_va_list *args);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"
-then :
-  wine_cv_builtin_ms_va_list=yes
-else $as_nop
-  wine_cv_builtin_ms_va_list=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_builtin_ms_va_list" >&5
-printf "%s\n" "$wine_cv_builtin_ms_va_list" >&6; }
-        test $wine_cv_builtin_ms_va_list != no || as_fn_error $? "You need gcc >= 4.4 or clang >= 3.8 to build Wine as 64-bit." "$LINENO" 5
-      fi
       CC="$CC -m64"
       CXX="$CXX -m64"
       host_cpu="x86_64"
@@ -6258,8 +6477,8 @@ printf %s "checking whether $CC supports Thumb-2... " >&6; }
 if test ${wine_cv_thumb2+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -6273,11 +6492,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   wine_cv_thumb2=yes
-else $as_nop
-  wine_cv_thumb2=no
+else case e in #(
+  e) wine_cv_thumb2=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_thumb2" >&5
 printf "%s\n" "$wine_cv_thumb2" >&6; }
@@ -6305,8 +6526,8 @@ printf %s "checking whether $CC supports -mfloat-abi=$float_abi... " >&6; }
 if test ${wine_cv_float_abi+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -6320,11 +6541,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   wine_cv_float_abi=yes
-else $as_nop
-  wine_cv_float_abi=no
+else case e in #(
+  e) wine_cv_float_abi=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_float_abi" >&5
 printf "%s\n" "$wine_cv_float_abi" >&6; }
@@ -6350,6 +6573,16 @@ enable_win64=${enable_win64:-no}
 enable_wow64=${enable_wow64:-aarch64,x86_64}
 enable_wow64win=${enable_wow64win:-aarch64,x86_64}
 enable_wow64cpu=${enable_wow64cpu:-x86_64}
+enable_vcruntime140_1=${enable_vcruntime140_1:-x86_64,arm64ec}
+
+enable_cmd=${enable_cmd:-yes}
+enable_dllhost=${enable_dllhost:-yes}
+enable_dpnsvr=${enable_dpnsvr:-i386,x86_64,arm64ec}
+enable_dxdiag=${enable_dxdiag:-yes}
+enable_msiexec=${enable_msiexec:-yes}
+enable_netsh=${enable_netsh:-yes}
+enable_regsvr32=${enable_regsvr32:-yes}
+enable_rundll32=${enable_rundll32:-yes}
 
 enable_winetest=${enable_winetest:-$enable_tests}
 
@@ -6380,15 +6613,16 @@ printf %s "checking for the directory containing the Wine tools... " >&6; }
 if test ${wine_cv_toolsdir+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  wine_cv_toolsdir="$with_wine_tools"
+else case e in #(
+  e) wine_cv_toolsdir="$with_wine_tools"
    if test -z "$with_wine_tools"; then
      if test "$cross_compiling" = "yes"; then
        as_fn_error $? "you must use the --with-wine-tools option when cross-compiling." "$LINENO" 5
      elif test -n "$with_wine64"; then
        wine_cv_toolsdir="$with_wine64"
      fi
-   fi
+   fi ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_toolsdir" >&5
 printf "%s\n" "$wine_cv_toolsdir" >&6; }
@@ -6424,8 +6658,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_FLEX+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$FLEX"; then
+else case e in #(
+  e) if test -n "$FLEX"; then
   ac_cv_prog_FLEX="$FLEX" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6447,7 +6681,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 FLEX=$ac_cv_prog_FLEX
 if test -n "$FLEX"; then
@@ -6472,8 +6707,8 @@ printf %s "checking whether flex is recent enough... " >&6; }
 if test ${wine_cv_recent_flex+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat >conftest.l <<EOF
+else case e in #(
+  e) cat >conftest.l <<EOF
 %top{
 #include "prediluvian.h"
 }
@@ -6484,7 +6719,8 @@ EOF
       wine_cv_recent_flex=yes
     else
       wine_cv_recent_flex=no
-    fi
+    fi ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_recent_flex" >&5
 printf "%s\n" "$wine_cv_recent_flex" >&6; }
@@ -6499,8 +6735,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_BISON+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$BISON"; then
+else case e in #(
+  e) if test -n "$BISON"; then
   ac_cv_prog_BISON="$BISON" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6522,7 +6758,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 BISON=$ac_cv_prog_BISON
 if test -n "$BISON"; then
@@ -6547,8 +6784,8 @@ printf %s "checking whether bison is recent enough... " >&6; }
 if test ${wine_cv_recent_bison+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat >conftest.y <<EOF
+else case e in #(
+  e) cat >conftest.y <<EOF
 %define parse.error verbose
 %%
 empty: ;
@@ -6558,7 +6795,8 @@ EOF
       wine_cv_recent_bison=yes
     else
       wine_cv_recent_bison=no
-    fi
+    fi ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_recent_bison" >&5
 printf "%s\n" "$wine_cv_recent_bison" >&6; }
@@ -6574,8 +6812,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_AR+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$AR"; then
+else case e in #(
+  e) if test -n "$AR"; then
   ac_cv_prog_AR="$AR" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6597,7 +6835,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 AR=$ac_cv_prog_AR
 if test -n "$AR"; then
@@ -6623,8 +6862,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_AR+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_AR"; then
+else case e in #(
+  e) if test -n "$ac_ct_AR"; then
   ac_cv_prog_ac_ct_AR="$ac_ct_AR" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6646,7 +6885,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_AR=$ac_cv_prog_ac_ct_AR
 if test -n "$ac_ct_AR"; then
@@ -6682,8 +6922,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_STRIP+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$STRIP"; then
+else case e in #(
+  e) if test -n "$STRIP"; then
   ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6705,7 +6945,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 STRIP=$ac_cv_prog_STRIP
 if test -n "$STRIP"; then
@@ -6727,8 +6968,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_STRIP+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_STRIP"; then
+else case e in #(
+  e) if test -n "$ac_ct_STRIP"; then
   ac_cv_prog_ac_ct_STRIP="$ac_ct_STRIP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6750,7 +6991,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_STRIP=$ac_cv_prog_ac_ct_STRIP
 if test -n "$ac_ct_STRIP"; then
@@ -6784,8 +7026,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_RANLIB+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$RANLIB"; then
+else case e in #(
+  e) if test -n "$RANLIB"; then
   ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6807,7 +7049,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 RANLIB=$ac_cv_prog_RANLIB
 if test -n "$RANLIB"; then
@@ -6829,8 +7072,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_RANLIB+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_RANLIB"; then
+else case e in #(
+  e) if test -n "$ac_ct_RANLIB"; then
   ac_cv_prog_ac_ct_RANLIB="$ac_ct_RANLIB" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6852,7 +7095,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_RANLIB=$ac_cv_prog_ac_ct_RANLIB
 if test -n "$ac_ct_RANLIB"; then
@@ -6894,8 +7138,8 @@ printf %s "checking for grep that handles long lines and -e... " >&6; }
 if test ${ac_cv_path_GREP+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -z "$GREP"; then
+else case e in #(
+  e) if test -z "$GREP"; then
   ac_path_GREP_found=false
   # Loop through the user's path and test for each of PROGNAME-LIST
   as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -6914,9 +7158,10 @@ do
       as_fn_executable_p "$ac_path_GREP" || continue
 # Check for GNU ac_path_GREP and select it if it is found.
   # Check for GNU $ac_path_GREP
-case `"$ac_path_GREP" --version 2>&1` in
+case `"$ac_path_GREP" --version 2>&1` in #(
 *GNU*)
   ac_cv_path_GREP="$ac_path_GREP" ac_path_GREP_found=:;;
+#(
 *)
   ac_count=0
   printf %s 0123456789 >"conftest.in"
@@ -6951,7 +7196,8 @@ IFS=$as_save_IFS
 else
   ac_cv_path_GREP=$GREP
 fi
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_GREP" >&5
 printf "%s\n" "$ac_cv_path_GREP" >&6; }
@@ -6963,8 +7209,8 @@ printf %s "checking for egrep... " >&6; }
 if test ${ac_cv_path_EGREP+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
+else case e in #(
+  e) if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
    then ac_cv_path_EGREP="$GREP -E"
    else
      if test -z "$EGREP"; then
@@ -6986,9 +7232,10 @@ do
       as_fn_executable_p "$ac_path_EGREP" || continue
 # Check for GNU ac_path_EGREP and select it if it is found.
   # Check for GNU $ac_path_EGREP
-case `"$ac_path_EGREP" --version 2>&1` in
+case `"$ac_path_EGREP" --version 2>&1` in #(
 *GNU*)
   ac_cv_path_EGREP="$ac_path_EGREP" ac_path_EGREP_found=:;;
+#(
 *)
   ac_count=0
   printf %s 0123456789 >"conftest.in"
@@ -7024,12 +7271,15 @@ else
   ac_cv_path_EGREP=$EGREP
 fi
 
-   fi
+   fi ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_EGREP" >&5
 printf "%s\n" "$ac_cv_path_EGREP" >&6; }
  EGREP="$ac_cv_path_EGREP"
 
+         EGREP_TRADITIONAL=$EGREP
+ ac_cv_path_EGREP_TRADITIONAL=$EGREP
 
 # Extract the first word of "ldconfig", so it can be a program name with args.
 set dummy ldconfig; ac_word=$2
@@ -7038,8 +7288,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_path_LDCONFIG+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  case $LDCONFIG in
+else case e in #(
+  e) case $LDCONFIG in
   [\\/]* | ?:[\\/]*)
   ac_cv_path_LDCONFIG="$LDCONFIG" # Let the user override the test with a path.
   ;;
@@ -7065,6 +7315,7 @@ IFS=$as_save_IFS
 
   test -z "$ac_cv_path_LDCONFIG" && ac_cv_path_LDCONFIG="true"
   ;;
+esac ;;
 esac
 fi
 LDCONFIG=$ac_cv_path_LDCONFIG
@@ -7086,8 +7337,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_MSGFMT+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$MSGFMT"; then
+else case e in #(
+  e) if test -n "$MSGFMT"; then
   ac_cv_prog_MSGFMT="$MSGFMT" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -7109,7 +7360,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 MSGFMT=$ac_cv_prog_MSGFMT
 if test -n "$MSGFMT"; then
@@ -7134,8 +7386,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_PKG_CONFIG+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$PKG_CONFIG"; then
+else case e in #(
+  e) if test -n "$PKG_CONFIG"; then
   ac_cv_prog_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -7157,7 +7409,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 PKG_CONFIG=$ac_cv_prog_PKG_CONFIG
 if test -n "$PKG_CONFIG"; then
@@ -7175,8 +7428,8 @@ then :
   if test "x$cross_compiling" = xyes
 then :
 
-else $as_nop
-  { ac_cv_prog_PKG_CONFIG=; unset ac_cv_prog_PKG_CONFIG;}
+else case e in #(
+  e) { ac_cv_prog_PKG_CONFIG=; unset ac_cv_prog_PKG_CONFIG;}
      # Extract the first word of "pkg-config", so it can be a program name with args.
 set dummy pkg-config; ac_word=$2
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
@@ -7184,8 +7437,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_PKG_CONFIG+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$PKG_CONFIG"; then
+else case e in #(
+  e) if test -n "$PKG_CONFIG"; then
   ac_cv_prog_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -7207,7 +7460,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 PKG_CONFIG=$ac_cv_prog_PKG_CONFIG
 if test -n "$PKG_CONFIG"; then
@@ -7218,10 +7472,12 @@ else
 printf "%s\n" "no" >&6; }
 fi
 
-
+ ;;
+esac
 fi
-else $as_nop
-  PKG_CONFIG=$ac_cv_prog_PKG_CONFIG
+else case e in #(
+  e) PKG_CONFIG=$ac_cv_prog_PKG_CONFIG ;;
+esac
 fi
 
 if test "x$enable_maintainer_mode" != "xyes"
@@ -7241,8 +7497,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_FONTFORGE+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$FONTFORGE"; then
+else case e in #(
+  e) if test -n "$FONTFORGE"; then
   ac_cv_prog_FONTFORGE="$FONTFORGE" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -7264,7 +7520,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 FONTFORGE=$ac_cv_prog_FONTFORGE
 if test -n "$FONTFORGE"; then
@@ -7289,8 +7546,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_RSVG+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$RSVG"; then
+else case e in #(
+  e) if test -n "$RSVG"; then
   ac_cv_prog_RSVG="$RSVG" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -7312,7 +7569,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 RSVG=$ac_cv_prog_RSVG
 if test -n "$RSVG"; then
@@ -7337,8 +7595,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_CONVERT+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$CONVERT"; then
+else case e in #(
+  e) if test -n "$CONVERT"; then
   ac_cv_prog_CONVERT="$CONVERT" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -7360,7 +7618,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 CONVERT=$ac_cv_prog_CONVERT
 if test -n "$CONVERT"; then
@@ -7385,8 +7644,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ICOTOOL+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ICOTOOL"; then
+else case e in #(
+  e) if test -n "$ICOTOOL"; then
   ac_cv_prog_ICOTOOL="$ICOTOOL" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -7408,7 +7667,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ICOTOOL=$ac_cv_prog_ICOTOOL
 if test -n "$ICOTOOL"; then
@@ -7496,8 +7756,8 @@ printf %s "checking whether msgfmt supports contexts... " >&6; }
 if test ${wine_cv_msgfmt_contexts+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat >conftest.po <<EOF
+else case e in #(
+  e) cat >conftest.po <<EOF
 # comment
 msgctxt "ctxt"
 msgid "id"
@@ -7508,7 +7768,8 @@ EOF
     wine_cv_msgfmt_contexts=yes
   else
     wine_cv_msgfmt_contexts=no
-  fi
+  fi ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_msgfmt_contexts" >&5
 printf "%s\n" "$wine_cv_msgfmt_contexts" >&6; }
@@ -7531,16 +7792,22 @@ printf %s "checking for i386_set_ldt in -li386... " >&6; }
 if test ${ac_cv_lib_i386_i386_set_ldt+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-li386  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char i386_set_ldt ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char i386_set_ldt (void);
 int
 main (void)
 {
@@ -7552,12 +7819,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_i386_i386_set_ldt=yes
-else $as_nop
-  ac_cv_lib_i386_i386_set_ldt=no
+else case e in #(
+  e) ac_cv_lib_i386_i386_set_ldt=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_i386_i386_set_ldt" >&5
 printf "%s\n" "$ac_cv_lib_i386_i386_set_ldt" >&6; }
@@ -7577,31 +7846,34 @@ if test ${enable_largefile+y}
 then :
   enableval=$enable_largefile;
 fi
-
-if test "$enable_largefile" != no; then
-
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for special C compiler options needed for large files" >&5
-printf %s "checking for special C compiler options needed for large files... " >&6; }
-if test ${ac_cv_sys_largefile_CC+y}
+if test "$enable_largefile,$enable_year2038" != no,no
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $CC option to enable large file support" >&5
+printf %s "checking for $CC option to enable large file support... " >&6; }
+if test ${ac_cv_sys_largefile_opts+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_cv_sys_largefile_CC=no
-     if test "$GCC" != yes; then
-       ac_save_CC=$CC
-       while :; do
-	 # IRIX 6.2 and later do not support large files by default,
-	 # so use the C compiler's -n32 option if that helps.
-	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) ac_save_CC="$CC"
+  ac_opt_found=no
+  for ac_opt in "none needed" "-D_FILE_OFFSET_BITS=64" "-D_LARGE_FILES=1" "-n32"; do
+    if test x"$ac_opt" != x"none needed"
+then :
+  CC="$ac_save_CC $ac_opt"
+fi
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <sys/types.h>
- /* Check that off_t can represent 2**63 - 1 correctly.
-    We can't simply define LARGE_OFF_T to be 9223372036854775807,
+#ifndef FTYPE
+# define FTYPE off_t
+#endif
+ /* Check that FTYPE can represent 2**63 - 1 correctly.
+    We can't simply define LARGE_FTYPE to be 9223372036854775807,
     since some C++ compilers masquerading as C compilers
     incorrectly reject 9223372036854775807.  */
-#define LARGE_OFF_T (((off_t) 1 << 31 << 31) - 1 + ((off_t) 1 << 31 << 31))
-  int off_t_is_large[(LARGE_OFF_T % 2147483629 == 721
-		       && LARGE_OFF_T % 2147483647 == 1)
+#define LARGE_FTYPE (((FTYPE) 1 << 31 << 31) - 1 + ((FTYPE) 1 << 31 << 31))
+  int FTYPE_is_large[(LARGE_FTYPE % 2147483629 == 721
+		       && LARGE_FTYPE % 2147483647 == 1)
 		      ? 1 : -1];
 int
 main (void)
@@ -7611,142 +7883,88 @@ main (void)
   return 0;
 }
 _ACEOF
-	 if ac_fn_c_try_compile "$LINENO"
+if ac_fn_c_try_compile "$LINENO"
 then :
-  break
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam
-	 CC="$CC -n32"
+  if test x"$ac_opt" = x"none needed"
+then :
+  # GNU/Linux s390x and alpha need _FILE_OFFSET_BITS=64 for wide ino_t.
+	 CC="$CC -DFTYPE=ino_t"
 	 if ac_fn_c_try_compile "$LINENO"
 then :
-  ac_cv_sys_largefile_CC=' -n32'; break
+
+else case e in #(
+  e) CC="$CC -D_FILE_OFFSET_BITS=64"
+	    if ac_fn_c_try_compile "$LINENO"
+then :
+  ac_opt='-D_FILE_OFFSET_BITS=64'
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam
-	 break
-       done
-       CC=$ac_save_CC
-       rm -f conftest.$ac_ext
-    fi
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_sys_largefile_CC" >&5
-printf "%s\n" "$ac_cv_sys_largefile_CC" >&6; }
-  if test "$ac_cv_sys_largefile_CC" != no; then
-    CC=$CC$ac_cv_sys_largefile_CC
-  fi
-
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for _FILE_OFFSET_BITS value needed for large files" >&5
-printf %s "checking for _FILE_OFFSET_BITS value needed for large files... " >&6; }
-if test ${ac_cv_sys_file_offset_bits+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  while :; do
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <sys/types.h>
- /* Check that off_t can represent 2**63 - 1 correctly.
-    We can't simply define LARGE_OFF_T to be 9223372036854775807,
-    since some C++ compilers masquerading as C compilers
-    incorrectly reject 9223372036854775807.  */
-#define LARGE_OFF_T (((off_t) 1 << 31 << 31) - 1 + ((off_t) 1 << 31 << 31))
-  int off_t_is_large[(LARGE_OFF_T % 2147483629 == 721
-		       && LARGE_OFF_T % 2147483647 == 1)
-		      ? 1 : -1];
-int
-main (void)
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"
-then :
-  ac_cv_sys_file_offset_bits=no; break
+      ac_cv_sys_largefile_opts=$ac_opt
+      ac_opt_found=yes
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#define _FILE_OFFSET_BITS 64
-#include <sys/types.h>
- /* Check that off_t can represent 2**63 - 1 correctly.
-    We can't simply define LARGE_OFF_T to be 9223372036854775807,
-    since some C++ compilers masquerading as C compilers
-    incorrectly reject 9223372036854775807.  */
-#define LARGE_OFF_T (((off_t) 1 << 31 << 31) - 1 + ((off_t) 1 << 31 << 31))
-  int off_t_is_large[(LARGE_OFF_T % 2147483629 == 721
-		       && LARGE_OFF_T % 2147483647 == 1)
-		      ? 1 : -1];
-int
-main (void)
-{
+    test $ac_opt_found = no || break
+  done
+  CC="$ac_save_CC"
 
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"
-then :
-  ac_cv_sys_file_offset_bits=64; break
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-  ac_cv_sys_file_offset_bits=unknown
-  break
-done
+  test $ac_opt_found = yes || ac_cv_sys_largefile_opts="support not detected" ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_sys_file_offset_bits" >&5
-printf "%s\n" "$ac_cv_sys_file_offset_bits" >&6; }
-case $ac_cv_sys_file_offset_bits in #(
-  no | unknown) ;;
-  *)
-printf "%s\n" "#define _FILE_OFFSET_BITS $ac_cv_sys_file_offset_bits" >>confdefs.h
-;;
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_sys_largefile_opts" >&5
+printf "%s\n" "$ac_cv_sys_largefile_opts" >&6; }
+
+ac_have_largefile=yes
+case $ac_cv_sys_largefile_opts in #(
+  "none needed") :
+     ;; #(
+  "supported through gnulib") :
+     ;; #(
+  "support not detected") :
+    ac_have_largefile=no ;; #(
+  "-D_FILE_OFFSET_BITS=64") :
+
+printf "%s\n" "#define _FILE_OFFSET_BITS 64" >>confdefs.h
+ ;; #(
+  "-D_LARGE_FILES=1") :
+
+printf "%s\n" "#define _LARGE_FILES 1" >>confdefs.h
+ ;; #(
+  "-n32") :
+    CC="$CC -n32" ;; #(
+  *) :
+    as_fn_error $? "internal error: bad value for \$ac_cv_sys_largefile_opts" "$LINENO" 5 ;;
 esac
-rm -rf conftest*
-  if test $ac_cv_sys_file_offset_bits = unknown; then
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for _LARGE_FILES value needed for large files" >&5
-printf %s "checking for _LARGE_FILES value needed for large files... " >&6; }
-if test ${ac_cv_sys_large_files+y}
+
+if test "$enable_year2038" != no
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $CC option for timestamps after 2038" >&5
+printf %s "checking for $CC option for timestamps after 2038... " >&6; }
+if test ${ac_cv_sys_year2038_opts+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  while :; do
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <sys/types.h>
- /* Check that off_t can represent 2**63 - 1 correctly.
-    We can't simply define LARGE_OFF_T to be 9223372036854775807,
-    since some C++ compilers masquerading as C compilers
-    incorrectly reject 9223372036854775807.  */
-#define LARGE_OFF_T (((off_t) 1 << 31 << 31) - 1 + ((off_t) 1 << 31 << 31))
-  int off_t_is_large[(LARGE_OFF_T % 2147483629 == 721
-		       && LARGE_OFF_T % 2147483647 == 1)
-		      ? 1 : -1];
-int
-main (void)
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"
+else case e in #(
+  e) ac_save_CPPFLAGS="$CPPFLAGS"
+  ac_opt_found=no
+  for ac_opt in "none needed" "-D_TIME_BITS=64" "-D__MINGW_USE_VC2005_COMPAT" "-U_USE_32_BIT_TIME_T -D__MINGW_USE_VC2005_COMPAT"; do
+    if test x"$ac_opt" != x"none needed"
 then :
-  ac_cv_sys_large_files=no; break
+  CPPFLAGS="$ac_save_CPPFLAGS $ac_opt"
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
-#define _LARGE_FILES 1
-#include <sys/types.h>
- /* Check that off_t can represent 2**63 - 1 correctly.
-    We can't simply define LARGE_OFF_T to be 9223372036854775807,
-    since some C++ compilers masquerading as C compilers
-    incorrectly reject 9223372036854775807.  */
-#define LARGE_OFF_T (((off_t) 1 << 31 << 31) - 1 + ((off_t) 1 << 31 << 31))
-  int off_t_is_large[(LARGE_OFF_T % 2147483629 == 721
-		       && LARGE_OFF_T % 2147483647 == 1)
-		      ? 1 : -1];
+
+  #include <time.h>
+  /* Check that time_t can represent 2**32 - 1 correctly.  */
+  #define LARGE_TIME_T \\
+    ((time_t) (((time_t) 1 << 30) - 1 + 3 * ((time_t) 1 << 30)))
+  int verify_time_t_range[(LARGE_TIME_T / 65537 == 65535
+                           && LARGE_TIME_T % 65537 == 0)
+                          ? 1 : -1];
+
 int
 main (void)
 {
@@ -7757,25 +7975,47 @@ main (void)
 _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
-  ac_cv_sys_large_files=1; break
+  ac_cv_sys_year2038_opts="$ac_opt"
+      ac_opt_found=yes
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-  ac_cv_sys_large_files=unknown
-  break
-done
+    test $ac_opt_found = no || break
+  done
+  CPPFLAGS="$ac_save_CPPFLAGS"
+  test $ac_opt_found = yes || ac_cv_sys_year2038_opts="support not detected" ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_sys_large_files" >&5
-printf "%s\n" "$ac_cv_sys_large_files" >&6; }
-case $ac_cv_sys_large_files in #(
-  no | unknown) ;;
-  *)
-printf "%s\n" "#define _LARGE_FILES $ac_cv_sys_large_files" >>confdefs.h
-;;
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_sys_year2038_opts" >&5
+printf "%s\n" "$ac_cv_sys_year2038_opts" >&6; }
+
+ac_have_year2038=yes
+case $ac_cv_sys_year2038_opts in #(
+  "none needed") :
+     ;; #(
+  "support not detected") :
+    ac_have_year2038=no ;; #(
+  "-D_TIME_BITS=64") :
+
+printf "%s\n" "#define _TIME_BITS 64" >>confdefs.h
+ ;; #(
+  "-D__MINGW_USE_VC2005_COMPAT") :
+
+printf "%s\n" "#define __MINGW_USE_VC2005_COMPAT 1" >>confdefs.h
+ ;; #(
+  "-U_USE_32_BIT_TIME_T"*) :
+    { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
+as_fn_error $? "the 'time_t' type is currently forced to be 32-bit. It
+will stop working after mid-January 2038. Remove
+_USE_32BIT_TIME_T from the compiler flags.
+See 'config.log' for more details" "$LINENO" 5; } ;; #(
+  *) :
+    as_fn_error $? "internal error: bad value for \$ac_cv_sys_year2038_opts" "$LINENO" 5 ;;
 esac
-rm -rf conftest*
-  fi
+
 fi
 
+fi
 
 ac_header= ac_cache=
 for ac_item in $ac_header_c_list
@@ -7865,12 +8105,6 @@ if test "x$ac_cv_header_gettext_po_h" = xyes
 then :
   printf "%s\n" "#define HAVE_GETTEXT_PO_H 1" >>confdefs.h
 
-fi
-ac_fn_c_check_header_compile "$LINENO" "libproc.h" "ac_cv_header_libproc_h" "$ac_includes_default"
-if test "x$ac_cv_header_libproc_h" = xyes
-then :
-  printf "%s\n" "#define HAVE_LIBPROC_H 1" >>confdefs.h
-
 fi
 ac_fn_c_check_header_compile "$LINENO" "link.h" "ac_cv_header_link_h" "$ac_includes_default"
 if test "x$ac_cv_header_link_h" = xyes
@@ -7889,6 +8123,12 @@ if test "x$ac_cv_header_linux_filter_h" = xyes
 then :
   printf "%s\n" "#define HAVE_LINUX_FILTER_H 1" >>confdefs.h
 
+fi
+ac_fn_c_check_header_compile "$LINENO" "linux/futex.h" "ac_cv_header_linux_futex_h" "$ac_includes_default"
+if test "x$ac_cv_header_linux_futex_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_LINUX_FUTEX_H 1" >>confdefs.h
+
 fi
 ac_fn_c_check_header_compile "$LINENO" "linux/hdreg.h" "ac_cv_header_linux_hdreg_h" "$ac_includes_default"
 if test "x$ac_cv_header_linux_hdreg_h" = xyes
@@ -7925,6 +8165,12 @@ if test "x$ac_cv_header_linux_param_h" = xyes
 then :
   printf "%s\n" "#define HAVE_LINUX_PARAM_H 1" >>confdefs.h
 
+fi
+ac_fn_c_check_header_compile "$LINENO" "linux/seccomp.h" "ac_cv_header_linux_seccomp_h" "$ac_includes_default"
+if test "x$ac_cv_header_linux_seccomp_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_LINUX_SECCOMP_H 1" >>confdefs.h
+
 fi
 ac_fn_c_check_header_compile "$LINENO" "linux/serial.h" "ac_cv_header_linux_serial_h" "$ac_includes_default"
 if test "x$ac_cv_header_linux_serial_h" = xyes
@@ -7943,6 +8189,12 @@ if test "x$ac_cv_header_linux_ucdrom_h" = xyes
 then :
   printf "%s\n" "#define HAVE_LINUX_UCDROM_H 1" >>confdefs.h
 
+fi
+ac_fn_c_check_header_compile "$LINENO" "linux/wireless.h" "ac_cv_header_linux_wireless_h" "$ac_includes_default"
+if test "x$ac_cv_header_linux_wireless_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_LINUX_WIRELESS_H 1" >>confdefs.h
+
 fi
 ac_fn_c_check_header_compile "$LINENO" "lwp.h" "ac_cv_header_lwp_h" "$ac_includes_default"
 if test "x$ac_cv_header_lwp_h" = xyes
@@ -8021,12 +8273,6 @@ if test "x$ac_cv_header_port_h" = xyes
 then :
   printf "%s\n" "#define HAVE_PORT_H 1" >>confdefs.h
 
-fi
-ac_fn_c_check_header_compile "$LINENO" "pthread.h" "ac_cv_header_pthread_h" "$ac_includes_default"
-if test "x$ac_cv_header_pthread_h" = xyes
-then :
-  printf "%s\n" "#define HAVE_PTHREAD_H 1" >>confdefs.h
-
 fi
 ac_fn_c_check_header_compile "$LINENO" "pwd.h" "ac_cv_header_pwd_h" "$ac_includes_default"
 if test "x$ac_cv_header_pwd_h" = xyes
@@ -8093,6 +8339,12 @@ if test "x$ac_cv_header_sys_event_h" = xyes
 then :
   printf "%s\n" "#define HAVE_SYS_EVENT_H 1" >>confdefs.h
 
+fi
+ac_fn_c_check_header_compile "$LINENO" "sys/eventfd.h" "ac_cv_header_sys_eventfd_h" "$ac_includes_default"
+if test "x$ac_cv_header_sys_eventfd_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_SYS_EVENTFD_H 1" >>confdefs.h
+
 fi
 ac_fn_c_check_header_compile "$LINENO" "sys/extattr.h" "ac_cv_header_sys_extattr_h" "$ac_includes_default"
 if test "x$ac_cv_header_sys_extattr_h" = xyes
@@ -8279,6 +8531,12 @@ if test "x$ac_cv_header_valgrind_valgrind_h" = xyes
 then :
   printf "%s\n" "#define HAVE_VALGRIND_VALGRIND_H 1" >>confdefs.h
 
+fi
+ac_fn_c_check_header_compile "$LINENO" "vosk_api.h" "ac_cv_header_vosk_api_h" "$ac_includes_default"
+if test "x$ac_cv_header_vosk_api_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_VOSK_API_H 1" >>confdefs.h
+
 fi
 
 ac_fn_c_check_header_compile "$LINENO" "sys/mkdev.h" "ac_cv_header_sys_mkdev_h" "$ac_includes_default"
@@ -8304,8 +8562,8 @@ printf %s "checking whether stat file-mode macros are broken... " >&6; }
 if test ${ac_cv_header_stat_broken+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -8330,10 +8588,12 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_header_stat_broken=no
-else $as_nop
-  ac_cv_header_stat_broken=yes
+else case e in #(
+  e) ac_cv_header_stat_broken=yes ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_header_stat_broken" >&5
 printf "%s\n" "$ac_cv_header_stat_broken" >&6; }
@@ -8998,9 +9258,7 @@ then :
 fi
 
 
-ac_fn_c_check_header_compile "$LINENO" "pthread_np.h" "ac_cv_header_pthread_np_h" "#ifdef HAVE_PTHREAD_H
-#include <pthread.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "pthread_np.h" "ac_cv_header_pthread_np_h" "#include <pthread.h>
 "
 if test "x$ac_cv_header_pthread_np_h" = xyes
 then :
@@ -9044,8 +9302,8 @@ printf %s "checking whether getxattr takes additional arguments... " >&6; }
 if test ${wine_cv_xattr_extra_args+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <sys/xattr.h>
 int
@@ -9059,10 +9317,12 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   wine_cv_xattr_extra_args=yes
-else $as_nop
-  wine_cv_xattr_extra_args=no
+else case e in #(
+  e) wine_cv_xattr_extra_args=no ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_xattr_extra_args" >&5
 printf "%s\n" "$wine_cv_xattr_extra_args" >&6; }
@@ -9092,6 +9352,8 @@ WINELOADER_LDFLAGS=""
 
 WINEPRELOADER_LDFLAGS=""
 
+DLLEXT=".so"
+
 LIBEXT="so"
 # Extract the first word of "ldd", so it can be a program name with args.
 set dummy ldd; ac_word=$2
@@ -9100,8 +9362,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_path_LDD+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  case $LDD in
+else case e in #(
+  e) case $LDD in
   [\\/]* | ?:[\\/]*)
   ac_cv_path_LDD="$LDD" # Let the user override the test with a path.
   ;;
@@ -9128,6 +9390,7 @@ IFS=$as_save_IFS
 
   test -z "$ac_cv_path_LDD" && ac_cv_path_LDD="true"
   ;;
+esac ;;
 esac
 fi
 LDD=$ac_cv_path_LDD
@@ -9148,8 +9411,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_OTOOL+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$OTOOL"; then
+else case e in #(
+  e) if test -n "$OTOOL"; then
   ac_cv_prog_OTOOL="$OTOOL" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -9171,7 +9434,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 OTOOL=$ac_cv_prog_OTOOL
 if test -n "$OTOOL"; then
@@ -9193,8 +9457,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_OTOOL+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_OTOOL"; then
+else case e in #(
+  e) if test -n "$ac_ct_OTOOL"; then
   ac_cv_prog_ac_ct_OTOOL="$ac_ct_OTOOL" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -9216,7 +9480,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_OTOOL=$ac_cv_prog_ac_ct_OTOOL
 if test -n "$ac_ct_OTOOL"; then
@@ -9250,8 +9515,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_READELF+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$READELF"; then
+else case e in #(
+  e) if test -n "$READELF"; then
   ac_cv_prog_READELF="$READELF" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -9273,7 +9538,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 READELF=$ac_cv_prog_READELF
 if test -n "$READELF"; then
@@ -9295,8 +9561,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_READELF+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_READELF"; then
+else case e in #(
+  e) if test -n "$ac_ct_READELF"; then
   ac_cv_prog_ac_ct_READELF="$ac_ct_READELF" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -9318,7 +9584,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_READELF=$ac_cv_prog_ac_ct_READELF
 if test -n "$ac_ct_READELF"; then
@@ -9358,6 +9625,7 @@ wine_fn_config_makefile ()
     eval enable=\$$2
     case "$enable" in
       no) as_fn_append DISABLED_SUBDIRS " $1" ;;
+      yes) ;;
       *aarch64*|*arm*|*i386*|*x86_64*)
         if test -n "$PE_ARCHS"
         then
@@ -9367,7 +9635,11 @@ wine_fn_config_makefile ()
             done
         else
             test $(expr ",$enable," : ".*,$HOST_ARCH,") -gt 0 || as_fn_append DISABLED_SUBDIRS " $1"
-        fi;;
+        fi ;;
+      "")
+        case "$1, $PE_ARCHS " in
+          programs/*,*\ arm64ec\ *) as_fn_append arm64ec_DISABLED_SUBDIRS " $1" ;;
+        esac ;;
     esac
 }
 
@@ -9380,20 +9652,20 @@ $ac_links:
     for f in $ac_links; do as_fn_append CONFIGURE_TARGETS " $f"; done
 }
 
-libwine_soversion=`expr $libwine_version : '\([0-9]*\)\..*'`
-
 case $host_os in
   cygwin*|mingw32*)
     LIBEXT="dll"
+    DLLEXT=""
     EXTRACFLAGS="-D__WINE_PE_BUILD"
-        case $host_cpu in
-      *i[3456]86*) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,--disable-stdcall-fixup" >&5
+        if test "x$HOST_ARCH" = xi386
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,--disable-stdcall-fixup" >&5
 printf %s "checking whether the compiler supports -Wl,--disable-stdcall-fixup... " >&6; }
 if test ${ac_cv_cflags__Wl___disable_stdcall_fixup+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wl,--disable-stdcall-fixup"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -9402,20 +9674,22 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wl___disable_stdcall_fixup=yes
-else $as_nop
-  ac_cv_cflags__Wl___disable_stdcall_fixup=no
+else case e in #(
+  e) ac_cv_cflags__Wl___disable_stdcall_fixup=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl___disable_stdcall_fixup" >&5
 printf "%s\n" "$ac_cv_cflags__Wl___disable_stdcall_fixup" >&6; }
 if test "x$ac_cv_cflags__Wl___disable_stdcall_fixup" = xyes
 then :
   LDDLLFLAGS="-Wl,--disable-stdcall-fixup"
-fi ;;
-    esac
+fi
+fi
         enable_loader=${enable_loader:-no}
     enable_server=${enable_server:-no}
         with_x=${with_x:-no}
@@ -9450,106 +9724,21 @@ fi ;;
 
     WINELOADER_LDFLAGS="-Wl,-pie,-segalign,0x1000,-pagezero_size,0x1000,-sectcreate,__TEXT,__info_plist,loader/wine_info.plist"
 
-    wine_can_build_preloader=yes
-    WINEPRELOADER_LDFLAGS="-nostartfiles -nodefaultlibs -e _start -ldylib1.o -Wl,-image_base,0x7d400000,-segalign,0x1000,-pagezero_size,0x1000,-sectcreate,__TEXT,__info_plist,loader/wine_info.plist,-segaddr,WINE_4GB_RESERVE,0x100000000"
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,-no_new_main -e _main" >&5
-printf %s "checking whether the compiler supports -Wl,-no_new_main -e _main... " >&6; }
-if test ${ac_cv_cflags__Wl__no_new_main__e__main+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
-CFLAGS="$CFLAGS -Wl,-no_new_main -e _main"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(int argc, char **argv) { return 0; }
-_ACEOF
-if ac_fn_c_try_link "$LINENO"
-then :
-  ac_cv_cflags__Wl__no_new_main__e__main=yes
-else $as_nop
-  ac_cv_cflags__Wl__no_new_main__e__main=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__no_new_main__e__main" >&5
-printf "%s\n" "$ac_cv_cflags__Wl__no_new_main__e__main" >&6; }
-if test "x$ac_cv_cflags__Wl__no_new_main__e__main" = xyes
-then :
-  WINEPRELOADER_LDFLAGS="-Wl,-no_new_main $WINEPRELOADER_LDFLAGS"
-                     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,-no_new_main -e _main -mmacosx-version-min=10.7 -nostartfiles -nodefaultlibs" >&5
-printf %s "checking whether the compiler supports -Wl,-no_new_main -e _main -mmacosx-version-min=10.7 -nostartfiles -nodefaultlibs... " >&6; }
-if test ${ac_cv_cflags__Wl__no_new_main__e__main__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
-CFLAGS="$CFLAGS -Wl,-no_new_main -e _main -mmacosx-version-min=10.7 -nostartfiles -nodefaultlibs"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(int argc, char **argv) { return 0; }
-_ACEOF
-if ac_fn_c_try_link "$LINENO"
-then :
-  ac_cv_cflags__Wl__no_new_main__e__main__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs=yes
-else $as_nop
-  ac_cv_cflags__Wl__no_new_main__e__main__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__no_new_main__e__main__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs" >&5
-printf "%s\n" "$ac_cv_cflags__Wl__no_new_main__e__main__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs" >&6; }
-if test "x$ac_cv_cflags__Wl__no_new_main__e__main__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs" = xyes
-then :
-  WINEPRELOADER_LDFLAGS="-mmacosx-version-min=10.7 $WINEPRELOADER_LDFLAGS"
-else $as_nop
-  wine_can_build_preloader=no
-fi
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -mmacosx-version-min=10.7 -nostartfiles -nodefaultlibs" >&5
-printf %s "checking whether the compiler supports -mmacosx-version-min=10.7 -nostartfiles -nodefaultlibs... " >&6; }
-if test ${ac_cv_cflags__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
-CFLAGS="$CFLAGS -mmacosx-version-min=10.7 -nostartfiles -nodefaultlibs"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(int argc, char **argv) { return 0; }
-_ACEOF
-if ac_fn_c_try_link "$LINENO"
-then :
-  ac_cv_cflags__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs=yes
-else $as_nop
-  ac_cv_cflags__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs" >&5
-printf "%s\n" "$ac_cv_cflags__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs" >&6; }
-if test "x$ac_cv_cflags__mmacosx_version_min_10_7__nostartfiles__nodefaultlibs" = xyes
-then :
-  WINEPRELOADER_LDFLAGS="-mmacosx-version-min=10.7 $WINEPRELOADER_LDFLAGS"
-else $as_nop
-  wine_can_build_preloader=no
-fi
-fi
+    case $HOST_ARCH in
+      i386|x86_64) wine_can_build_preloader=yes ;;
+      *)           wine_can_build_preloader=no ;;
+    esac
+
     if test "$wine_can_build_preloader" = "yes"
     then
+        WINEPRELOADER_LDFLAGS="-nostartfiles -nodefaultlibs -e _start -ldylib1.o -mmacosx-version-min=10.7 -Wl,-no_new_main,-segalign,0x1000,-pagezero_size,0x1000,-sectcreate,__TEXT,__info_plist,loader/wine_info.plist"
         { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,-no_pie" >&5
 printf %s "checking whether the compiler supports -Wl,-no_pie... " >&6; }
 if test ${ac_cv_cflags__Wl__no_pie+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wl,-no_pie"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -9558,12 +9747,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wl__no_pie=yes
-else $as_nop
-  ac_cv_cflags__Wl__no_pie=no
+else case e in #(
+  e) ac_cv_cflags__Wl__no_pie=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__no_pie" >&5
 printf "%s\n" "$ac_cv_cflags__Wl__no_pie" >&6; }
@@ -9571,6 +9762,14 @@ if test "x$ac_cv_cflags__Wl__no_pie" = xyes
 then :
   WINEPRELOADER_LDFLAGS="-Wl,-no_pie $WINEPRELOADER_LDFLAGS"
 fi
+        case $HOST_ARCH in
+          i386)
+            WINEPRELOADER_LDFLAGS="-Wl,-image_base,0x7d400000 $WINEPRELOADER_LDFLAGS"
+            ;;
+          x86_64)
+            WINEPRELOADER_LDFLAGS="-Wl,-image_base,0x200000000,-segalign,0x1000,-segaddr,WINE_RESERVE,0x1000 $WINEPRELOADER_LDFLAGS"
+            ;;
+        esac
                 WINELOADER_LDFLAGS="$WINELOADER_LDFLAGS -mmacosx-version-min=10.7"
     else
         as_fn_append wine_warnings "|can't build Wine preloader; many programs won't work"
@@ -9612,8 +9811,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_OBJC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$OBJC"; then
+else case e in #(
+  e) if test -n "$OBJC"; then
   ac_cv_prog_OBJC="$OBJC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -9635,7 +9834,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 OBJC=$ac_cv_prog_OBJC
 if test -n "$OBJC"; then
@@ -9661,8 +9861,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_ac_ct_OBJC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$ac_ct_OBJC"; then
+else case e in #(
+  e) if test -n "$ac_ct_OBJC"; then
   ac_cv_prog_ac_ct_OBJC="$ac_ct_OBJC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -9684,7 +9884,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 ac_ct_OBJC=$ac_cv_prog_ac_ct_OBJC
 if test -n "$ac_ct_OBJC"; then
@@ -9716,7 +9917,7 @@ fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for Objective C compiler version" >&5
 set X $ac_compile
 ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
+for ac_option in --version; do
   { { ac_try="$ac_compiler $ac_option >&5"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
@@ -9742,8 +9943,8 @@ printf %s "checking whether the compiler supports GNU Objective C... " >&6; }
 if test ${ac_cv_objc_compiler_gnu+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -9760,12 +9961,14 @@ _ACEOF
 if ac_fn_objc_try_compile "$LINENO"
 then :
   ac_compiler_gnu=yes
-else $as_nop
-  ac_compiler_gnu=no
+else case e in #(
+  e) ac_compiler_gnu=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 ac_cv_objc_compiler_gnu=$ac_compiler_gnu
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_objc_compiler_gnu" >&5
 printf "%s\n" "$ac_cv_objc_compiler_gnu" >&6; }
@@ -9783,8 +9986,8 @@ printf %s "checking whether $OBJC accepts -g... " >&6; }
 if test ${ac_cv_prog_objc_g+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_save_objc_werror_flag=$ac_objc_werror_flag
+else case e in #(
+  e) ac_save_objc_werror_flag=$ac_objc_werror_flag
    ac_objc_werror_flag=yes
    ac_cv_prog_objc_g=no
    OBJCFLAGS="-g"
@@ -9802,8 +10005,8 @@ _ACEOF
 if ac_fn_objc_try_compile "$LINENO"
 then :
   ac_cv_prog_objc_g=yes
-else $as_nop
-  OBJCFLAGS=""
+else case e in #(
+  e) OBJCFLAGS=""
       cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -9818,8 +10021,8 @@ _ACEOF
 if ac_fn_objc_try_compile "$LINENO"
 then :
 
-else $as_nop
-  ac_objc_werror_flag=$ac_save_objc_werror_flag
+else case e in #(
+  e) ac_objc_werror_flag=$ac_save_objc_werror_flag
 	 OBJCFLAGS="-g"
 	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -9836,12 +10039,15 @@ if ac_fn_objc_try_compile "$LINENO"
 then :
   ac_cv_prog_objc_g=yes
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-   ac_objc_werror_flag=$ac_save_objc_werror_flag
+   ac_objc_werror_flag=$ac_save_objc_werror_flag ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_objc_g" >&5
 printf "%s\n" "$ac_cv_prog_objc_g" >&6; }
@@ -9885,9 +10091,10 @@ printf "%s\n" "yes" >&6; }
 
 printf "%s\n" "#define HAVE_MTLDEVICE_REGISTRYID 1" >>confdefs.h
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
-printf "%s\n" "no" >&6; }
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; } ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
     ac_ext=c
@@ -9898,13 +10105,8 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
     UNIXLDFLAGS="-dynamiclib -install_name @rpath/\$(UNIXLIB) -Wl,-rpath,@loader_path\/"
-    LIBWINE_SHAREDLIB="libwine.$libwine_version.dylib"
-
-    LIBWINE_LDFLAGS="-dynamiclib -install_name @rpath/libwine.$libwine_soversion.dylib -Wl,-rpath,@loader_path/ -compatibility_version $libwine_soversion -current_version $libwine_version"
-
     WINELOADER_DEPENDS="wine_info.plist"
 
-    TOP_INSTALL_LIB="$TOP_INSTALL_LIB libs/wine/libwine.$libwine_version.dylib libs/wine/libwine.$libwine_soversion.dylib"
     ;;
 
   linux-android*)
@@ -9920,8 +10122,8 @@ printf %s "checking whether the compiler supports -Wl,-z,defs... " >&6; }
 if test ${ac_cv_cflags__Wl__z_defs+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wl,-z,defs"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -9930,12 +10132,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wl__z_defs=yes
-else $as_nop
-  ac_cv_cflags__Wl__z_defs=no
+else case e in #(
+  e) ac_cv_cflags__Wl__z_defs=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__z_defs" >&5
 printf "%s\n" "$ac_cv_cflags__Wl__z_defs" >&6; }
@@ -9948,8 +10152,8 @@ printf %s "checking whether the compiler supports -fPIC -Wl,--export-dynamic...
 if test ${ac_cv_cflags__fPIC__Wl___export_dynamic+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -fPIC -Wl,--export-dynamic"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -9958,12 +10162,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__fPIC__Wl___export_dynamic=yes
-else $as_nop
-  ac_cv_cflags__fPIC__Wl___export_dynamic=no
+else case e in #(
+  e) ac_cv_cflags__fPIC__Wl___export_dynamic=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fPIC__Wl___export_dynamic" >&5
 printf "%s\n" "$ac_cv_cflags__fPIC__Wl___export_dynamic" >&6; }
@@ -9978,16 +10184,22 @@ printf %s "checking for -lEGL... " >&6; }
 if test ${ac_cv_lib_soname_EGL+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lEGL  $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char eglGetProcAddress ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char eglGetProcAddress (void);
 int
 main (void)
 {
@@ -10007,41 +10219,50 @@ then :
   ac_cv_lib_soname_EGL=`$LDD conftest$ac_exeext | grep "libEGL\\.$LIBEXT" | sed -e "s/^.*\(libEGL\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_EGL=
+else case e in #(
+  e) ac_cv_lib_soname_EGL= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_EGL:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_EGL" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_EGL" >&5
 printf "%s\n" "$ac_cv_lib_soname_EGL" >&6; }
 
 printf "%s\n" "#define SONAME_LIBEGL \"$ac_cv_lib_soname_EGL\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lGLESv2" >&5
 printf %s "checking for -lGLESv2... " >&6; }
 if test ${ac_cv_lib_soname_GLESv2+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lGLESv2  $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char glFlush ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char glFlush (void);
 int
 main (void)
 {
@@ -10061,34 +10282,37 @@ then :
   ac_cv_lib_soname_GLESv2=`$LDD conftest$ac_exeext | grep "libGLESv2\\.$LIBEXT" | sed -e "s/^.*\(libGLESv2\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_GLESv2=
+else case e in #(
+  e) ac_cv_lib_soname_GLESv2= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_GLESv2:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_GLESv2" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_GLESv2" >&5
 printf "%s\n" "$ac_cv_lib_soname_GLESv2" >&6; }
 
 printf "%s\n" "#define SONAME_LIBGLESV2 \"$ac_cv_lib_soname_GLESv2\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
 
     if test "x$exec_prefix" = xNONE
     then
-      case $host_cpu in
-        *i[3456]86*) exec_prefix='${prefix}/x86' ;;
-        *x86_64*)      exec_prefix='${prefix}/x86_64' ;;
-        *arm*)         exec_prefix='${prefix}/armeabi-v7a' ;;
-        *aarch64*)     exec_prefix='${prefix}/arm64-v8a' ;;
+      case $HOST_ARCH in
+        i386)    exec_prefix='${prefix}/x86' ;;
+        x86_64)  exec_prefix='${prefix}/x86_64' ;;
+        arm)     exec_prefix='${prefix}/armeabi-v7a' ;;
+        aarch64) exec_prefix='${prefix}/arm64-v8a' ;;
       esac
     fi
     ;;
@@ -10100,8 +10324,8 @@ printf "%s\n" "#define _GNU_SOURCE 1" >>confdefs.h
     test "$ac_cv_sys_file_offset_bits" = 64 &&
 printf "%s\n" "#define _TIME_BITS 64" >>confdefs.h
 
-    case $host_cpu in
-      *i[3456789]86*)
+    if test $HOST_ARCH = i386
+    then
         DLLFLAGS="$DLLFLAGS -fno-PIC"
         LDDLLFLAGS="-fno-PIC"
         { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -fno-PIC -Wl,-z,notext" >&5
@@ -10109,8 +10333,8 @@ printf %s "checking whether the compiler supports -fno-PIC -Wl,-z,notext... " >&
 if test ${ac_cv_cflags__fno_PIC__Wl__z_notext+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -fno-PIC -Wl,-z,notext"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -10119,12 +10343,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__fno_PIC__Wl__z_notext=yes
-else $as_nop
-  ac_cv_cflags__fno_PIC__Wl__z_notext=no
+else case e in #(
+  e) ac_cv_cflags__fno_PIC__Wl__z_notext=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fno_PIC__Wl__z_notext" >&5
 printf "%s\n" "$ac_cv_cflags__fno_PIC__Wl__z_notext" >&6; }
@@ -10132,79 +10358,46 @@ if test "x$ac_cv_cflags__fno_PIC__Wl__z_notext" = xyes
 then :
   LDDLLFLAGS="$LDDLLFLAGS -Wl,-z,notext"
 fi
-        ;;
-      *)
+    else
         DLLFLAGS="$DLLFLAGS -fPIC"
-        LDDLLFLAGS="-fPIC" ;;
-    esac
-    LIBWINE_LDFLAGS="-shared -Wl,-soname,libwine.so.$libwine_soversion"
+        LDDLLFLAGS="-fPIC"
+    fi
 
-    echo '{ global: *; };' >conftest.map
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -shared -Wl,--version-script=conftest.map" >&5
-printf %s "checking whether the compiler supports -shared -Wl,--version-script=conftest.map... " >&6; }
-if test ${ac_cv_cflags__shared__Wl___version_script_conftest_map+y}
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether -Wl,-z,defs works correctly" >&5
+printf %s "checking whether -Wl,-z,defs works correctly... " >&6; }
+if test ${ac_cv_wl_z_defs+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
-CFLAGS="$CFLAGS -shared -Wl,--version-script=conftest.map"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) ac_save_CFLAGS="$CFLAGS"
+                    CFLAGS="$CFLAGS $UNIXDLLFLAGS $UNIXLDFLAGS -Wl,-z,defs"
+                                        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
-int main(int argc, char **argv) { return 0; }
+extern char **environ; char **envp; void myfunc(void) { envp = environ; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_cflags__shared__Wl___version_script_conftest_map=yes
-else $as_nop
-  ac_cv_cflags__shared__Wl___version_script_conftest_map=no
+  ac_cv_wl_z_defs=yes
+else case e in #(
+  e) ac_cv_wl_z_defs=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__shared__Wl___version_script_conftest_map" >&5
-printf "%s\n" "$ac_cv_cflags__shared__Wl___version_script_conftest_map" >&6; }
-if test "x$ac_cv_cflags__shared__Wl___version_script_conftest_map" = xyes
-then :
-  LIBWINE_LDFLAGS="$LIBWINE_LDFLAGS -Wl,--version-script=\$(srcdir)/wine.map"
+                    CFLAGS=$ac_save_CFLAGS ;;
+esac
 fi
-    rm -f conftest.map
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_wl_z_defs" >&5
+printf "%s\n" "$ac_cv_wl_z_defs" >&6; }
+    test $ac_cv_wl_z_defs != yes || as_fn_append UNIXLDFLAGS " -Wl,-z,defs"
 
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,-z,defs" >&5
-printf %s "checking whether the compiler supports -Wl,-z,defs... " >&6; }
-if test ${ac_cv_cflags__Wl__z_defs+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
-CFLAGS="$CFLAGS -Wl,-z,defs"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-int main(int argc, char **argv) { return 0; }
-_ACEOF
-if ac_fn_c_try_link "$LINENO"
-then :
-  ac_cv_cflags__Wl__z_defs=yes
-else $as_nop
-  ac_cv_cflags__Wl__z_defs=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__z_defs" >&5
-printf "%s\n" "$ac_cv_cflags__Wl__z_defs" >&6; }
-if test "x$ac_cv_cflags__Wl__z_defs" = xyes
-then :
-  UNIXLDFLAGS="$UNIXLDFLAGS -Wl,-z,defs"
-fi
     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,--export-dynamic" >&5
 printf %s "checking whether the compiler supports -Wl,--export-dynamic... " >&6; }
 if test ${ac_cv_cflags__Wl___export_dynamic+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wl,--export-dynamic"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -10213,12 +10406,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wl___export_dynamic=yes
-else $as_nop
-  ac_cv_cflags__Wl___export_dynamic=no
+else case e in #(
+  e) ac_cv_cflags__Wl___export_dynamic=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl___export_dynamic" >&5
 printf "%s\n" "$ac_cv_cflags__Wl___export_dynamic" >&6; }
@@ -10226,158 +10421,123 @@ if test "x$ac_cv_cflags__Wl___export_dynamic" = xyes
 then :
   WINELOADER_LDFLAGS="-Wl,--export-dynamic"
 fi
-    WINEPRELOADER_LDFLAGS="-static -nostartfiles -nodefaultlibs -Wl,-Ttext=0x7d400000"
+    WINEPRELOADER_LDFLAGS="-nostartfiles -nodefaultlibs"
 
-    case $host_cpu in
-      *i[3456789]86* | x86_64 | *aarch64* | arm*)
-        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,-Ttext-segment=0x7bc00000" >&5
-printf %s "checking whether the compiler supports -Wl,-Ttext-segment=0x7bc00000... " >&6; }
-if test ${ac_cv_cflags__Wl__Ttext_segment_0x7bc00000+y}
+    case $host_os in
+      linux*)
+        as_fn_append WINELOADER_LDFLAGS " -pie"
+        case $HOST_ARCH in
+          i386|arm)
+            as_fn_append WINEPRELOADER_LDFLAGS " -static -Wl,-Ttext=0x7d400000" ;;
+          *)
+            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -static-pie" >&5
+printf %s "checking whether the compiler supports -static-pie... " >&6; }
+if test ${ac_cv_cflags__static_pie+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
-CFLAGS="$CFLAGS -Wl,-Ttext-segment=0x7bc00000"
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+CFLAGS="$CFLAGS -static-pie"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 int main(int argc, char **argv) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_cflags__Wl__Ttext_segment_0x7bc00000=yes
-else $as_nop
-  ac_cv_cflags__Wl__Ttext_segment_0x7bc00000=no
+  ac_cv_cflags__static_pie=yes
+else case e in #(
+  e) ac_cv_cflags__static_pie=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__Ttext_segment_0x7bc00000" >&5
-printf "%s\n" "$ac_cv_cflags__Wl__Ttext_segment_0x7bc00000" >&6; }
-if test "x$ac_cv_cflags__Wl__Ttext_segment_0x7bc00000" = xyes
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__static_pie" >&5
+printf "%s\n" "$ac_cv_cflags__static_pie" >&6; }
+if test "x$ac_cv_cflags__static_pie" = xyes
 then :
-  case $host_os in
-                         freebsd* | kfreebsd*-gnu) WINELOADER_LDFLAGS="$WINELOADER_LDFLAGS -Wl,-Ttext-segment=0x60000000" ;;
-                         *) WINELOADER_LDFLAGS="$WINELOADER_LDFLAGS -Wl,-Ttext-segment=0x7d000000" ;;
-                         esac
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,--section-start,.interp=0x7d000400" >&5
-printf %s "checking whether the compiler supports -Wl,--section-start,.interp=0x7d000400... " >&6; }
-if test ${ac_cv_cflags__Wl___section_start__interp_0x7d000400+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
-CFLAGS="$CFLAGS -Wl,--section-start,.interp=0x7d000400"
+  as_fn_append WINEPRELOADER_LDFLAGS " -static-pie"
+else case e in #(
+  e) as_fn_append WINEPRELOADER_LDFLAGS " -static -Wl,-Ttext=0x7d7d00000000" ;;
+esac
+fi
+            ;;
+        esac
+        ;;
+      *)
+        case $HOST_ARCH in
+          i386|arm)
+            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,-Ttext-segment=0x60000000" >&5
+printf %s "checking whether the compiler supports -Wl,-Ttext-segment=0x60000000... " >&6; }
+if test ${ac_cv_cflags__Wl__Ttext_segment_0x60000000+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+CFLAGS="$CFLAGS -Wl,-Ttext-segment=0x60000000"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 int main(int argc, char **argv) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_cflags__Wl___section_start__interp_0x7d000400=yes
-else $as_nop
-  ac_cv_cflags__Wl___section_start__interp_0x7d000400=no
+  ac_cv_cflags__Wl__Ttext_segment_0x60000000=yes
+else case e in #(
+  e) ac_cv_cflags__Wl__Ttext_segment_0x60000000=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl___section_start__interp_0x7d000400" >&5
-printf "%s\n" "$ac_cv_cflags__Wl___section_start__interp_0x7d000400" >&6; }
-if test "x$ac_cv_cflags__Wl___section_start__interp_0x7d000400" = xyes
-then :
-  case $host_os in
-                                            freebsd* | kfreebsd*-gnu) WINELOADER_LDFLAGS="$WINELOADER_LDFLAGS -Wl,--section-start,.interp=0x60000400" ;;
-                                            *) WINELOADER_LDFLAGS="$WINELOADER_LDFLAGS -Wl,--section-start,.interp=0x7d000400" ;;
-                                         esac
-fi
-                         # Extract the first word of "prelink", so it can be a program name with args.
-set dummy prelink; ac_word=$2
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-printf %s "checking for $ac_word... " >&6; }
-if test ${ac_cv_path_PRELINK+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  case $PRELINK in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_PRELINK="$PRELINK" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /sbin /usr/sbin $PATH
-do
-  IFS=$as_save_IFS
-  case $as_dir in #(((
-    '') as_dir=./ ;;
-    */) ;;
-    *) as_dir=$as_dir/ ;;
-  esac
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
-    ac_cv_path_PRELINK="$as_dir$ac_word$ac_exec_ext"
-    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-  test -z "$ac_cv_path_PRELINK" && ac_cv_path_PRELINK="false"
-  ;;
+CFLAGS=$ac_wine_try_cflags_saved ;;
 esac
 fi
-PRELINK=$ac_cv_path_PRELINK
-if test -n "$PRELINK"; then
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $PRELINK" >&5
-printf "%s\n" "$PRELINK" >&6; }
-else
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
-printf "%s\n" "no" >&6; }
-fi
-
-
-                         if test "x$PRELINK" = xfalse
-                         then
-                             as_fn_append wine_warnings "|prelink not found and linker does not support relocation, base address of core dlls won't be set correctly."
-                         fi
-fi
-        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,-z,max-page-size=0x1000" >&5
-printf %s "checking whether the compiler supports -Wl,-z,max-page-size=0x1000... " >&6; }
-if test ${ac_cv_cflags__Wl__z_max_page_size_0x1000+y}
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__Ttext_segment_0x60000000" >&5
+printf "%s\n" "$ac_cv_cflags__Wl__Ttext_segment_0x60000000" >&6; }
+if test "x$ac_cv_cflags__Wl__Ttext_segment_0x60000000" = xyes
+then :
+  as_fn_append WINELOADER_LDFLAGS " -Wl,-Ttext-segment=0x60000000"
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wl,--section-start,.interp=0x60000400" >&5
+printf %s "checking whether the compiler supports -Wl,--section-start,.interp=0x60000400... " >&6; }
+if test ${ac_cv_cflags__Wl___section_start__interp_0x60000400+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
-CFLAGS="$CFLAGS -Wl,-z,max-page-size=0x1000"
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+CFLAGS="$CFLAGS -Wl,--section-start,.interp=0x60000400"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 int main(int argc, char **argv) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_cflags__Wl__z_max_page_size_0x1000=yes
-else $as_nop
-  ac_cv_cflags__Wl__z_max_page_size_0x1000=no
+  ac_cv_cflags__Wl___section_start__interp_0x60000400=yes
+else case e in #(
+  e) ac_cv_cflags__Wl___section_start__interp_0x60000400=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__z_max_page_size_0x1000" >&5
-printf "%s\n" "$ac_cv_cflags__Wl__z_max_page_size_0x1000" >&6; }
-if test "x$ac_cv_cflags__Wl__z_max_page_size_0x1000" = xyes
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl___section_start__interp_0x60000400" >&5
+printf "%s\n" "$ac_cv_cflags__Wl___section_start__interp_0x60000400" >&6; }
+if test "x$ac_cv_cflags__Wl___section_start__interp_0x60000400" = xyes
 then :
-  WINELOADER_LDFLAGS="$WINELOADER_LDFLAGS -Wl,-z,max-page-size=0x1000"
+  as_fn_append WINELOADER_LDFLAGS " -Wl,--section-start,.interp=0x60000400"
+fi ;;
+esac
 fi
+            ;;
+          *)
+            as_fn_append WINELOADER_LDFLAGS " -pie"
+            ;;
+        esac
         ;;
     esac
-    LIBWINE_SHAREDLIB="libwine.so.$libwine_version"
-
-    LIBWINE_DEPENDS="wine.map"
-
-    TOP_INSTALL_LIB="$TOP_INSTALL_LIB libs/wine/libwine.so.$libwine_version libs/wine/libwine.so.$libwine_soversion"
     ;;
 esac
 
@@ -10387,6 +10547,8 @@ enable_winemac_drv=${enable_winemac_drv:-no}
 
 PE_ARCHS=""
 
+MSHTML_CFLAGS=""
+
 cross_archs=
 if test ${enable_archs+y}
 then :
@@ -10399,23 +10561,23 @@ then :
      for arch
      do
          case $arch in
-           i386|x86_64|arm|aarch64) cross_archs="$cross_archs $arch" ;;
+           i386|x86_64|arm|aarch64|arm64ec) cross_archs="$cross_archs $arch" ;;
            *) as_fn_error $? "Unknown cross-compilation architecture '$arch'" "$LINENO" 5 ;;
          esac
      done
-else $as_nop
-  if test "x$with_mingw" != xno
+else case e in #(
+  e) if test "x$with_mingw" != xno
      then
          test $HOST_ARCH = unknown || cross_archs=$HOST_ARCH
-         case "x$with_mingw" in
-           x|xyes) ;;
-           *) eval "${cross_archs}_CC=\$with_mingw" ;;
-         esac
-     fi
+     fi ;;
+esac
 fi
 
 for wine_arch in $cross_archs
 do
+    case "x$with_mingw" in
+      xclang|x*/clang) eval "${wine_arch}_CC=\$with_mingw" ;;
+    esac
     if eval \${${wine_arch}_CC:+false} :
 then :
   case $wine_arch in
@@ -10429,8 +10591,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_aarch64_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$aarch64_CC"; then
+else case e in #(
+  e) if test -n "$aarch64_CC"; then
   ac_cv_prog_aarch64_CC="$aarch64_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -10452,7 +10614,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 aarch64_CC=$ac_cv_prog_aarch64_CC
 if test -n "$aarch64_CC"; then
@@ -10468,6 +10631,57 @@ fi
 done
 test -n "$aarch64_CC" || aarch64_CC="false"
 
+            ;;
+          arm64ec)
+            for ac_prog in arm64ec-w64-mingw32-clang arm64ec-w64-mingw32-gcc clang
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_arm64ec_CC+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) if test -n "$arm64ec_CC"; then
+  ac_cv_prog_arm64ec_CC="$arm64ec_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_prog_arm64ec_CC="$ac_prog"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi ;;
+esac
+fi
+arm64ec_CC=$ac_cv_prog_arm64ec_CC
+if test -n "$arm64ec_CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $arm64ec_CC" >&5
+printf "%s\n" "$arm64ec_CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+
+  test -n "$arm64ec_CC" && break
+done
+test -n "$arm64ec_CC" || arm64ec_CC="false"
+
             ;;
           arm)
             for ac_prog in armv7-w64-mingw32-clang armv7-w64-mingw32-gcc clang
@@ -10479,8 +10693,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_arm_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$arm_CC"; then
+else case e in #(
+  e) if test -n "$arm_CC"; then
   ac_cv_prog_arm_CC="$arm_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -10502,7 +10716,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 arm_CC=$ac_cv_prog_arm_CC
 if test -n "$arm_CC"; then
@@ -10530,8 +10745,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_i386_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$i386_CC"; then
+else case e in #(
+  e) if test -n "$i386_CC"; then
   ac_cv_prog_i386_CC="$i386_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -10553,7 +10768,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 i386_CC=$ac_cv_prog_i386_CC
 if test -n "$i386_CC"; then
@@ -10581,8 +10797,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_x86_64_CC+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$x86_64_CC"; then
+else case e in #(
+  e) if test -n "$x86_64_CC"; then
   ac_cv_prog_x86_64_CC="$x86_64_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -10604,7 +10820,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 x86_64_CC=$ac_cv_prog_x86_64_CC
 if test -n "$x86_64_CC"; then
@@ -10624,30 +10841,31 @@ test -n "$x86_64_CC" || x86_64_CC="false"
         esac
 fi
 
-    if eval test \"x\$"${wine_arch}_CC"\" = x"false"
-then :
-  continue
-fi
-
     saved_CC=$CC
     saved_CFLAGS=$CFLAGS
+    saved_LDFLAGS=$LDFLAGS
 
     CFLAGS=${CROSSCFLAGS:-"-g -O2"}
+    LDFLAGS=$CROSSLDFLAGS
     eval CC=\$${wine_arch}_CC
     eval ${wine_arch}_CFLAGS=\$CFLAGS
-    eval ${wine_arch}_LDFLAGS=\$CROSSLDFLAGS
+    eval ${wine_arch}_LDFLAGS=\$LDFLAGS
     eval "${wine_arch}_EXTRACFLAGS=\"-D__WINE_PE_BUILD -Wall\""
 
     target=""
-    as_wine_cv_crosscc=`printf "%s\n" "ac_cv_${wine_arch}_crosscc" | $as_tr_sh`
+    as_wine_cv_crosscc=`printf "%s\n" "ac_cv_${wine_arch}_crosscc" | sed "$as_sed_sh"`
+
+    if eval test \"x\$"${wine_arch}_CC"\" = x"false"
+then :
 
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC works" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC works" >&5
 printf %s "checking whether $CC works... " >&6; }
 if eval test \${$as_wine_cv_crosscc+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -10661,14 +10879,18 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   eval "$as_wine_cv_crosscc=yes"
-else $as_nop
-  eval "$as_wine_cv_crosscc=no"
+else case e in #(
+  e) eval "$as_wine_cv_crosscc=no" ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 eval ac_res=\$$as_wine_cv_crosscc
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-printf "%s\n" "$ac_res" >&6; }
+printf "%s\n" "$ac_res" >&6; } ;;
+esac
+fi
     if eval test \"x\$"$as_wine_cv_crosscc"\" = x"yes"
 then :
   set x $CC
@@ -10692,67 +10914,123 @@ then :
             esac
         fi
         llvm_extra_cflags="-target $llvm_target -fuse-ld=lld"
+        llvm_extra_ldflags=""
         case $llvm_target in
           *windows) llvm_cflags="-Wl,-subsystem:console -Wl,-WX" ;;
         esac
-        { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_$llvm_extra_cflags $llvm_cflags" | $as_tr_sh`
+        { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_$llvm_extra_cflags $llvm_cflags --no-default-config" | sed "$as_sed_sh"`
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports $llvm_extra_cflags $llvm_cflags --no-default-config" >&5
+printf %s "checking whether $CC supports $llvm_extra_cflags $llvm_cflags --no-default-config... " >&6; }
+if eval test \${$as_ac_var+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+ac_wine_try_cflags_saved_exeext=$ac_exeext
+CFLAGS="$CFLAGS -nostdlib -nodefaultlibs $llvm_extra_cflags $llvm_cflags --no-default-config"
+ac_exeext=".exe"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
+int __cdecl mainCRTStartup(void) { return 0; }
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  eval "$as_ac_var=yes"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+CFLAGS=$ac_wine_try_cflags_saved
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
+fi
+eval ac_res=\$$as_ac_var
+	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+printf "%s\n" "$ac_res" >&6; }
+if eval test \"x\$"$as_ac_var"\" = x"yes"
+then :
+  llvm_extra_cflags="$llvm_extra_cflags --no-default-config"
+                            llvm_extra_ldflags="--no-default-config"
+else case e in #(
+  e) { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_$llvm_extra_cflags $llvm_cflags" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports $llvm_extra_cflags $llvm_cflags" >&5
 printf %s "checking whether $CC supports $llvm_extra_cflags $llvm_cflags... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs $llvm_extra_cflags $llvm_cflags"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
 printf "%s\n" "$ac_res" >&6; }
 if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
-  target=$llvm_target
-                            eval "${wine_arch}_DELAYLOADFLAG=\"-Wl,-delayload,\""
-                            as_fn_append ${wine_arch}_EXTRACFLAGS " $llvm_extra_cflags"
-                            CFLAGS="$llvm_extra_cflags $llvm_cflags"
+  :
+else case e in #(
+  e) llvm_extra_cflags="" ;;
+esac
+fi } ;;
+esac
 fi }
+        if test -n "$llvm_extra_cflags"
+        then
+            target=$llvm_target
+            eval "${wine_arch}_DELAYLOADFLAG=\"-Wl,-delayload,\""
+            as_fn_append ${wine_arch}_EXTRACFLAGS " $llvm_extra_cflags"
+            as_fn_append ${wine_arch}_LDFLAGS " $llvm_extra_ldflags"
+            CFLAGS="$llvm_extra_cflags $llvm_cflags"
+        fi
         eval "${wine_arch}_TARGET=\$target"
 fi
 
 
     if test -z "$target"
     then
+        if test ${enable_archs+y}
+then :
+  as_fn_error $? "MinGW $wine_arch compiler not found.
+This is an error since --enable-archs=$wine_arch was requested." "$LINENO" 5
+fi
         CC=$saved_CC
         CFLAGS=$saved_CFLAGS
+        LDFLAGS=$saved_LDFLAGS
         continue
     fi
-    as_fn_append PE_ARCHS " $wine_arch"
 
-    as_wine_cv_crosscc_c99=`printf "%s\n" "ac_cv_${wine_arch}_crosscc_c99" | $as_tr_sh`
+    as_wine_cv_crosscc_c99=`printf "%s\n" "ac_cv_${wine_arch}_crosscc_c99" | sed "$as_sed_sh"`
 
     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $CC option to enable C99 features" >&5
 printf %s "checking for $CC option to enable C99 features... " >&6; }
     if eval test \${$as_wine_cv_crosscc_c99+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  eval "$as_wine_cv_crosscc_c99=no"
-         for arg in '' '-std=gnu99'
+else case e in #(
+  e) eval "$as_wine_cv_crosscc_c99=no"
+         for arg in '' '-std=gnu99' '-D__STDC__'
          do
              test -z "$arg" || CC="$CC $arg"
              cat confdefs.h - <<_ACEOF >conftest.$ac_ext
@@ -10762,57 +11040,127 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   eval "$as_wine_cv_crosscc_c99=\$arg"
-else $as_nop
-  eval "$as_wine_cv_crosscc_c99=no"
+else case e in #(
+  e) eval "$as_wine_cv_crosscc_c99=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
              eval CC=\$${wine_arch}_CC
              if eval test \"x\$"$as_wine_cv_crosscc_c99"\" = x"no"
 then :
 
-else $as_nop
-  break
+else case e in #(
+  e) break ;;
+esac
 fi
-         done
+         done ;;
+esac
 fi
 
     eval res=\$$as_wine_cv_crosscc_c99
+
     case "x$res" in
       x) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
 printf "%s\n" "none needed" >&6; } ;;
       xno) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
-printf "%s\n" "unsupported" >&6; } ;;
+printf "%s\n" "unsupported" >&6; }
+           CC=$saved_CC
+           CFLAGS=$saved_CFLAGS
+           LDFLAGS=$saved_LDFLAGS
+           if test ${enable_archs+y}
+then :
+  as_fn_error $? "MinGW $wine_arch compiler supporting C99 not found.
+This is an error since --enable-archs=$wine_arch was requested." "$LINENO" 5
+fi
+           continue
+           ;;
       x*) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $res" >&5
 printf "%s\n" "$res" >&6; }
           as_fn_append ${wine_arch}_CC " $res" ;;
     esac
 
+    if test "x$wine_arch" = xi386
+then :
+
+else case e in #(
+  e) as_wine_cv_seh_support=`printf "%s\n" "ac_cv_${wine_arch}_seh_support" | sed "$as_sed_sh"`
+
+               { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports SEH directives" >&5
+printf %s "checking whether $CC supports SEH directives... " >&6; }
+if eval test \${$as_wine_cv_seh_support+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+asm(".text\nac_test:\t.seh_proc ac_test\n\tnop\n\t.seh_stackalloc 16\n\t.seh_endprologue\n\t.seh_endproc");
+int
+main (void)
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+  eval "$as_wine_cv_seh_support=yes"
+else case e in #(
+  e) eval "$as_wine_cv_seh_support=no" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
+fi
+eval ac_res=\$$as_wine_cv_seh_support
+	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+printf "%s\n" "$ac_res" >&6; }
+               eval res=\$$as_wine_cv_seh_support
+
+               if test "x$res" = xyes
+then :
+
+else case e in #(
+  e) if test ${enable_archs+y}
+then :
+  as_fn_error $? "The $wine_arch cross-compiler doesn't support SEH directives.
+This is an error since --enable-archs=$wine_arch was requested." "$LINENO" 5
+fi
+                          continue ;;
+esac
+fi ;;
+esac
+fi
 
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-fno-strict-aliasing" | $as_tr_sh`
+    as_fn_append PE_ARCHS " $wine_arch"
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-fno-strict-aliasing" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -fno-strict-aliasing" >&5
 printf %s "checking whether $CC supports -fno-strict-aliasing... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -fno-strict-aliasing"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -10821,31 +11169,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -fno-strict-aliasing"
 fi }
-        { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Werror=unknown-warning-option" | $as_tr_sh`
+        { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Werror=unknown-warning-option" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Werror=unknown-warning-option" >&5
 printf %s "checking whether $CC supports -Werror=unknown-warning-option... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Werror=unknown-warning-option"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -10854,31 +11205,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   CFLAGS="$CFLAGS -Werror=unknown-warning-option"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Werror=ignored-optimization-argument" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Werror=ignored-optimization-argument" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Werror=ignored-optimization-argument" >&5
 printf %s "checking whether $CC supports -Werror=ignored-optimization-argument... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Werror=ignored-optimization-argument"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -10887,31 +11241,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   CFLAGS="$CFLAGS -Werror=ignored-optimization-argument"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wdeclaration-after-statement" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wdeclaration-after-statement" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wdeclaration-after-statement" >&5
 printf %s "checking whether $CC supports -Wdeclaration-after-statement... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wdeclaration-after-statement"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -10920,31 +11277,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wdeclaration-after-statement"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wempty-body" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wempty-body" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wempty-body" >&5
 printf %s "checking whether $CC supports -Wempty-body... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wempty-body"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -10953,31 +11313,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wempty-body"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wignored-qualifiers" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wignored-qualifiers" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wignored-qualifiers" >&5
 printf %s "checking whether $CC supports -Wignored-qualifiers... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wignored-qualifiers"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -10986,31 +11349,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wignored-qualifiers"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Winit-self" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Winit-self" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Winit-self" >&5
 printf %s "checking whether $CC supports -Winit-self... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Winit-self"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11019,31 +11385,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Winit-self"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wpacked-not-aligned" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wpacked-not-aligned" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wpacked-not-aligned" >&5
 printf %s "checking whether $CC supports -Wpacked-not-aligned... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wpacked-not-aligned"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11052,31 +11421,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wno-packed-not-aligned"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wpragma-pack" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wpragma-pack" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wpragma-pack" >&5
 printf %s "checking whether $CC supports -Wpragma-pack... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wpragma-pack"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11085,31 +11457,70 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wno-pragma-pack"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wshift-overflow=2" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wmicrosoft-enum-forward-reference" | sed "$as_sed_sh"`
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wmicrosoft-enum-forward-reference" >&5
+printf %s "checking whether $CC supports -Wmicrosoft-enum-forward-reference... " >&6; }
+if eval test \${$as_ac_var+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+ac_wine_try_cflags_saved_exeext=$ac_exeext
+CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wmicrosoft-enum-forward-reference"
+ac_exeext=".exe"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
+int __cdecl mainCRTStartup(void) { return 0; }
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  eval "$as_ac_var=yes"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+CFLAGS=$ac_wine_try_cflags_saved
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
+fi
+eval ac_res=\$$as_ac_var
+	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+printf "%s\n" "$ac_res" >&6; }
+if eval test \"x\$"$as_ac_var"\" = x"yes"
+then :
+  as_fn_append ${wine_arch}_EXTRACFLAGS " -Wno-microsoft-enum-forward-reference"
+fi }
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wshift-overflow=2" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wshift-overflow=2" >&5
 printf %s "checking whether $CC supports -Wshift-overflow=2... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wshift-overflow=2"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11118,31 +11529,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wshift-overflow=2"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wstrict-prototypes" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wstrict-prototypes" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wstrict-prototypes" >&5
 printf %s "checking whether $CC supports -Wstrict-prototypes... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wstrict-prototypes"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11151,31 +11565,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wstrict-prototypes"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wtype-limits" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wtype-limits" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wtype-limits" >&5
 printf %s "checking whether $CC supports -Wtype-limits... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wtype-limits"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11184,31 +11601,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wtype-limits"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wunused-but-set-parameter" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wunused-but-set-parameter" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wunused-but-set-parameter" >&5
 printf %s "checking whether $CC supports -Wunused-but-set-parameter... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wunused-but-set-parameter"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11217,31 +11637,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wunused-but-set-parameter"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wvla" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wvla" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wvla" >&5
 printf %s "checking whether $CC supports -Wvla... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wvla"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11250,31 +11673,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wvla"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wwrite-strings" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wwrite-strings" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wwrite-strings" >&5
 printf %s "checking whether $CC supports -Wwrite-strings... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wwrite-strings"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11283,31 +11709,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wwrite-strings"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wpointer-arith" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wpointer-arith" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wpointer-arith" >&5
 printf %s "checking whether $CC supports -Wpointer-arith... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wpointer-arith"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11316,31 +11745,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wpointer-arith"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wlogical-op" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wlogical-op" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wlogical-op" >&5
 printf %s "checking whether $CC supports -Wlogical-op... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wlogical-op"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11349,31 +11781,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wlogical-op"
 fi }
-    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wabsolute-value" | $as_tr_sh`
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wabsolute-value" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wabsolute-value" >&5
 printf %s "checking whether $CC supports -Wabsolute-value... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wabsolute-value"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11382,33 +11817,108 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wabsolute-value"
 fi }
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wenum-conversion" | sed "$as_sed_sh"`
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wenum-conversion" >&5
+printf %s "checking whether $CC supports -Wenum-conversion... " >&6; }
+if eval test \${$as_ac_var+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+ac_wine_try_cflags_saved_exeext=$ac_exeext
+CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wenum-conversion"
+ac_exeext=".exe"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
+int __cdecl mainCRTStartup(void) { return 0; }
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  eval "$as_ac_var=yes"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+CFLAGS=$ac_wine_try_cflags_saved
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
+fi
+eval ac_res=\$$as_ac_var
+	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+printf "%s\n" "$ac_res" >&6; }
+if eval test \"x\$"$as_ac_var"\" = x"yes"
+then :
+  as_fn_append ${wine_arch}_EXTRACFLAGS " -Wenum-conversion"
+fi }
+    { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wno-misleading-indentation" | sed "$as_sed_sh"`
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wno-misleading-indentation" >&5
+printf %s "checking whether $CC supports -Wno-misleading-indentation... " >&6; }
+if eval test \${$as_ac_var+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+ac_wine_try_cflags_saved_exeext=$ac_exeext
+CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wno-misleading-indentation"
+ac_exeext=".exe"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
+int __cdecl mainCRTStartup(void) { return 0; }
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  eval "$as_ac_var=yes"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+CFLAGS=$ac_wine_try_cflags_saved
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
+fi
+eval ac_res=\$$as_ac_var
+	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+printf "%s\n" "$ac_res" >&6; }
+if eval test \"x\$"$as_ac_var"\" = x"yes"
+then :
+  as_fn_append MSHTML_CFLAGS " -Wno-misleading-indentation"
+fi }
 
     case $wine_arch in
-      i386) { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-fno-omit-frame-pointer" | $as_tr_sh`
+      i386) { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-fno-omit-frame-pointer" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -fno-omit-frame-pointer" >&5
 printf %s "checking whether $CC supports -fno-omit-frame-pointer... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -fno-omit-frame-pointer"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11417,31 +11927,70 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -fno-omit-frame-pointer"
 fi }
-            { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wl,--disable-stdcall-fixup" | $as_tr_sh`
+            { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-mpreferred-stack-boundary=2" | sed "$as_sed_sh"`
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -mpreferred-stack-boundary=2" >&5
+printf %s "checking whether $CC supports -mpreferred-stack-boundary=2... " >&6; }
+if eval test \${$as_ac_var+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+ac_wine_try_cflags_saved_exeext=$ac_exeext
+CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -mpreferred-stack-boundary=2"
+ac_exeext=".exe"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
+int __cdecl mainCRTStartup(void) { return 0; }
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  eval "$as_ac_var=yes"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+CFLAGS=$ac_wine_try_cflags_saved
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
+fi
+eval ac_res=\$$as_ac_var
+	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+printf "%s\n" "$ac_res" >&6; }
+if eval test \"x\$"$as_ac_var"\" = x"yes"
+then :
+  as_fn_append ${wine_arch}_EXTRACFLAGS " -mpreferred-stack-boundary=2"
+fi }
+            { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wl,--disable-stdcall-fixup" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wl,--disable-stdcall-fixup" >&5
 printf %s "checking whether $CC supports -Wl,--disable-stdcall-fixup... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wl,--disable-stdcall-fixup"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11450,31 +11999,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_LDFLAGS " -Wl,--disable-stdcall-fixup"
 fi } ;;
-      x86_64) { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wformat-overflow" | $as_tr_sh`
+      x86_64) { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wformat-overflow" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wformat-overflow" >&5
 printf %s "checking whether $CC supports -Wformat-overflow... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wformat-overflow"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11483,31 +12035,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wformat-overflow"
 fi }
-              { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wnonnull" | $as_tr_sh`
+              { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wnonnull" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wnonnull" >&5
 printf %s "checking whether $CC supports -Wnonnull... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wnonnull"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11516,31 +12071,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Wnonnull"
 fi }
-              { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-mcx16" | $as_tr_sh`
+              { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-mcx16" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -mcx16" >&5
 printf %s "checking whether $CC supports -mcx16... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -mcx16"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11548,6 +12106,42 @@ printf "%s\n" "$ac_res" >&6; }
 if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -mcx16"
+fi }
+              { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-mcmodel=small" | sed "$as_sed_sh"`
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -mcmodel=small" >&5
+printf %s "checking whether $CC supports -mcmodel=small... " >&6; }
+if eval test \${$as_ac_var+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+ac_wine_try_cflags_saved_exeext=$ac_exeext
+CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -mcmodel=small"
+ac_exeext=".exe"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
+int __cdecl mainCRTStartup(void) { return 0; }
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  eval "$as_ac_var=yes"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+CFLAGS=$ac_wine_try_cflags_saved
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
+fi
+eval ac_res=\$$as_ac_var
+	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+printf "%s\n" "$ac_res" >&6; }
+if eval test \"x\$"$as_ac_var"\" = x"yes"
+then :
+  as_fn_append ${wine_arch}_EXTRACFLAGS " -mcmodel=small"
 fi } ;;
     esac
 
@@ -11572,31 +12166,34 @@ fi } ;;
     if test "x$ac_debug_format_seen" = x
     then
       case $wine_crossdebug in
-        *dwarf)  { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-gdwarf-4" | $as_tr_sh`
+        *dwarf)  { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-gdwarf-4" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -gdwarf-4" >&5
 printf %s "checking whether $CC supports -gdwarf-4... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -gdwarf-4"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11605,31 +12202,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -gdwarf-4"
 fi } ;;
-        pdb)     { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-gcodeview" | $as_tr_sh`
+        pdb)     { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-gcodeview" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -gcodeview" >&5
 printf %s "checking whether $CC supports -gcodeview... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -gcodeview"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11642,31 +12242,34 @@ fi } ;;
     fi
     eval "${wine_arch}_DEBUG=\$wine_crossdebug"
 
-    test "x$enable_werror" != xyes || { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Werror" | $as_tr_sh`
+    test "x$enable_werror" != xyes || { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Werror" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Werror" >&5
 printf %s "checking whether $CC supports -Werror... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Werror"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11675,31 +12278,34 @@ if eval test \"x\$"$as_ac_var"\" = x"yes"
 then :
   as_fn_append ${wine_arch}_EXTRACFLAGS " -Werror"
 fi }
-    test "x$enable_build_id" != xyes || { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wl,--build-id" | $as_tr_sh`
+    test "x$enable_build_id" != xyes || { as_ac_var=`printf "%s\n" "ac_cv_${wine_arch}_cflags_-Wl,--build-id" | sed "$as_sed_sh"`
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC supports -Wl,--build-id" >&5
 printf %s "checking whether $CC supports -Wl,--build-id... " >&6; }
 if eval test \${$as_ac_var+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 ac_wine_try_cflags_saved_exeext=$ac_exeext
 CFLAGS="$CFLAGS -nostdlib -nodefaultlibs -Wl,--build-id"
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
+void *__os_arm64x_dispatch_ret = 0;
 int __cdecl mainCRTStartup(void) { return 0; }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   eval "$as_ac_var=yes"
-else $as_nop
-  eval "$as_ac_var=no"
+else case e in #(
+  e) eval "$as_ac_var=no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CFLAGS=$ac_wine_try_cflags_saved
-ac_exeext=$ac_wine_try_cflags_saved_exeext
+ac_exeext=$ac_wine_try_cflags_saved_exeext ;;
+esac
 fi
 eval ac_res=\$$as_ac_var
 	       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
@@ -11712,33 +12318,25 @@ fi }
 
     CC=$saved_CC
     CFLAGS=$saved_CFLAGS
+    LDFLAGS=$saved_LDFLAGS
 done
 
-if test $HOST_ARCH = aarch64 -a "x$PE_ARCHS" = x
+if test $HOST_ARCH = aarch64
 then
-    as_fn_error $? "PE cross-compilation is required for ARM64, please install clang/llvm-dlltool/lld, or llvm-mingw." "$LINENO" 5
-fi
-
-if test "x$PE_ARCHS" = "x"
-then :
-  case "x$with_mingw" in
-  x)   as_fn_append wine_notices "|MinGW compiler not found, cross-compiling PE files won't be supported." ;;
-  xno) ;;
-  *)   as_fn_error $? "MinGW compiler not found, cross-compiling PE files won't be supported.
-This is an error since --with-mingw was requested." "$LINENO" 5 ;;
-esac
-
+    test "x$PE_ARCHS" != x || as_fn_error $? "PE cross-compilation is required for ARM64, please install clang/llvm-dlltool/lld, or llvm-mingw." "$LINENO" 5
+    DLLEXT=""
 fi
 
 
 if test "x$with_system_dllpath" != "x" -a -n "$PE_ARCHS"
 then
-    case "$host_cpu" in
-  i[3456789]86*)
-    ac_prefix_list="i686-w64-mingw32-pkg-config i586-w64-mingw32-pkg-config i486-w64-mingw32-pkg-config i386-w64-mingw32-pkg-config " ;;
-  *)
-    ac_prefix_list="$host_cpu-w64-mingw32-pkg-config" ;;
+    if test "x$HOST_ARCH" = xi386
+then :
+  ac_prefix_list="i686-w64-mingw32-pkg-config i586-w64-mingw32-pkg-config i486-w64-mingw32-pkg-config i386-w64-mingw32-pkg-config "
+else case e in #(
+  e) ac_prefix_list="$host_cpu-w64-mingw32-pkg-config" ;;
 esac
+fi
 for ac_prog in $ac_prefix_list
 do
   # Extract the first word of "$ac_prog", so it can be a program name with args.
@@ -11748,8 +12346,8 @@ printf %s "checking for $ac_word... " >&6; }
 if test ${ac_cv_prog_MINGW_PKG_CONFIG+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  if test -n "$MINGW_PKG_CONFIG"; then
+else case e in #(
+  e) if test -n "$MINGW_PKG_CONFIG"; then
   ac_cv_prog_MINGW_PKG_CONFIG="$MINGW_PKG_CONFIG" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
@@ -11771,7 +12369,8 @@ done
   done
 IFS=$as_save_IFS
 
-fi
+fi ;;
+esac
 fi
 MINGW_PKG_CONFIG=$ac_cv_prog_MINGW_PKG_CONFIG
 if test -n "$MINGW_PKG_CONFIG"; then
@@ -11809,8 +12408,8 @@ printf %s "checking for MinGW FAudio.h... " >&6; }
 if test ${ac_cv_mingw_header_FAudio_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -11829,12 +12428,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_FAudio_h=yes
-else $as_nop
-  ac_cv_mingw_header_FAudio_h=no
+else case e in #(
+  e) ac_cv_mingw_header_FAudio_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_FAudio_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_FAudio_h" >&6; }
@@ -11845,8 +12446,8 @@ printf %s "checking for FAudio_CommitOperationSet in MinGW -lFAudio... " >&6; }
 if test ${ac_cv_mingw_lib_FAudio+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -11857,8 +12458,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char FAudio_CommitOperationSet ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char FAudio_CommitOperationSet (void);
 int
 main (void)
 {
@@ -11870,25 +12477,29 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_FAudio=yes
-else $as_nop
-  ac_cv_mingw_lib_FAudio=no
+else case e in #(
+  e) ac_cv_mingw_lib_FAudio=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_FAudio" >&5
 printf "%s\n" "$ac_cv_mingw_lib_FAudio" >&6; }
 if test "x$ac_cv_mingw_lib_FAudio" = xyes
 then :
   :
-else $as_nop
-  FAUDIO_PE_CFLAGS=""; FAUDIO_PE_LIBS=""
+else case e in #(
+  e) FAUDIO_PE_CFLAGS=""; FAUDIO_PE_LIBS="" ;;
+esac
 fi
-else $as_nop
-  FAUDIO_PE_CFLAGS=""; FAUDIO_PE_LIBS=""
+else case e in #(
+  e) FAUDIO_PE_CFLAGS=""; FAUDIO_PE_LIBS="" ;;
+esac
 fi
 CPPFLAGS=$ac_save_CPPFLAGS
 
@@ -11897,38 +12508,37 @@ CPPFLAGS=$ac_save_CPPFLAGS
         as_fn_append wine_notices "|FAudio ${notice_platform}MinGW development files not found (or too old); using bundled version."
     fi
 
-    if ${JPEG_PE_CFLAGS:+false} :
+    if ${FLUIDSYNTH_PE_CFLAGS:+false} :
 then :
   if test ${MINGW_PKG_CONFIG+y}
 then :
-  JPEG_PE_CFLAGS=`$MINGW_PKG_CONFIG --cflags libjpeg 2>/dev/null`
+  FLUIDSYNTH_PE_CFLAGS=`$MINGW_PKG_CONFIG --cflags fluidsynth 2>/dev/null`
 fi
 fi
-if ${JPEG_PE_LIBS:+false} :
+if ${FLUIDSYNTH_PE_LIBS:+false} :
 then :
   if test ${MINGW_PKG_CONFIG+y}
 then :
-  JPEG_PE_LIBS=`$MINGW_PKG_CONFIG --libs libjpeg 2>/dev/null`
+  FLUIDSYNTH_PE_LIBS=`$MINGW_PKG_CONFIG --libs fluidsynth 2>/dev/null`
 fi
 fi
-
+FLUIDSYNTH_PE_LIBS=${FLUIDSYNTH_PE_LIBS:-"-lfluidsynth"}
 ac_save_CPPFLAGS=$CPPFLAGS
-CPPFLAGS="$CPPFLAGS $JPEG_PE_CFLAGS"
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for MinGW jpeglib.h" >&5
-printf %s "checking for MinGW jpeglib.h... " >&6; }
-if test ${ac_cv_mingw_header_jpeglib_h+y}
+CPPFLAGS="$CPPFLAGS $FLUIDSYNTH_PE_CFLAGS"
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for MinGW fluidsynth.h" >&5
+printf %s "checking for MinGW fluidsynth.h... " >&6; }
+if test ${ac_cv_mingw_header_fluidsynth_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
-#include <stddef.h>
-             #include <stdio.h>
-#include <jpeglib.h>
+
+#include <fluidsynth.h>
 int
 main (void)
 {
@@ -11939,99 +12549,234 @@ main (void)
 _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
-  ac_cv_mingw_header_jpeglib_h=yes
-else $as_nop
-  ac_cv_mingw_header_jpeglib_h=no
+  ac_cv_mingw_header_fluidsynth_h=yes
+else case e in #(
+  e) ac_cv_mingw_header_fluidsynth_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_jpeglib_h" >&5
-printf "%s\n" "$ac_cv_mingw_header_jpeglib_h" >&6; }
-if test "x$ac_cv_mingw_header_jpeglib_h" = xyes
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_fluidsynth_h" >&5
+printf "%s\n" "$ac_cv_mingw_header_fluidsynth_h" >&6; }
+if test "x$ac_cv_mingw_header_fluidsynth_h" = xyes
 then :
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for jpeg_start_decompress in MinGW -ljpeg" >&5
-printf %s "checking for jpeg_start_decompress in MinGW -ljpeg... " >&6; }
-if test ${ac_cv_mingw_lib_jpeg+y}
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for new_fluid_synth in MinGW -lfluidsynth" >&5
+printf %s "checking for new_fluid_synth in MinGW -lfluidsynth... " >&6; }
+if test ${ac_cv_mingw_lib_fluidsynth+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
-LIBS="-ljpeg $JPEG_PE_LIBS $LIBS"
+LIBS="-lfluidsynth $FLUIDSYNTH_PE_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char jpeg_start_decompress ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char new_fluid_synth (void);
 int
 main (void)
 {
-return jpeg_start_decompress ();
+return new_fluid_synth ();
   ;
   return 0;
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_mingw_lib_jpeg=yes
-else $as_nop
-  ac_cv_mingw_lib_jpeg=no
+  ac_cv_mingw_lib_fluidsynth=yes
+else case e in #(
+  e) ac_cv_mingw_lib_fluidsynth=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_jpeg" >&5
-printf "%s\n" "$ac_cv_mingw_lib_jpeg" >&6; }
-if test "x$ac_cv_mingw_lib_jpeg" = xyes
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_fluidsynth" >&5
+printf "%s\n" "$ac_cv_mingw_lib_fluidsynth" >&6; }
+if test "x$ac_cv_mingw_lib_fluidsynth" = xyes
 then :
   :
-else $as_nop
-  JPEG_PE_CFLAGS=""; JPEG_PE_LIBS=""
+else case e in #(
+  e) FLUIDSYNTH_PE_CFLAGS=""; FLUIDSYNTH_PE_LIBS="" ;;
+esac
 fi
-else $as_nop
-  JPEG_PE_CFLAGS=""; JPEG_PE_LIBS=""
+else case e in #(
+  e) FLUIDSYNTH_PE_CFLAGS=""; FLUIDSYNTH_PE_LIBS="" ;;
+esac
 fi
 CPPFLAGS=$ac_save_CPPFLAGS
 
-    if test "x$JPEG_PE_LIBS" = "x"
+    if test "x$FLUIDSYNTH_PE_LIBS" = "x"
     then
-        as_fn_append wine_notices "|libjpeg ${notice_platform}MinGW development files not found; using bundled version."
+        as_fn_append wine_notices "|Fluidsynth ${notice_platform}MinGW development files not found (or too old); using bundled version."
     fi
 
-    if ${LCMS2_PE_CFLAGS:+false} :
+    if ${JPEG_PE_CFLAGS:+false} :
 then :
   if test ${MINGW_PKG_CONFIG+y}
 then :
-  LCMS2_PE_CFLAGS=`$MINGW_PKG_CONFIG --cflags lcms2 2>/dev/null`
+  JPEG_PE_CFLAGS=`$MINGW_PKG_CONFIG --cflags libjpeg 2>/dev/null`
 fi
 fi
-if ${LCMS2_PE_LIBS:+false} :
+if ${JPEG_PE_LIBS:+false} :
 then :
   if test ${MINGW_PKG_CONFIG+y}
 then :
-  LCMS2_PE_LIBS=`$MINGW_PKG_CONFIG --libs lcms2 2>/dev/null`
+  JPEG_PE_LIBS=`$MINGW_PKG_CONFIG --libs libjpeg 2>/dev/null`
 fi
 fi
-LCMS2_PE_LIBS=${LCMS2_PE_LIBS:-"-llcms2"}
+
 ac_save_CPPFLAGS=$CPPFLAGS
-CPPFLAGS="$CPPFLAGS $LCMS2_PE_CFLAGS"
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for MinGW lcms2.h" >&5
-printf %s "checking for MinGW lcms2.h... " >&6; }
-if test ${ac_cv_mingw_header_lcms2_h+y}
-then :
+CPPFLAGS="$CPPFLAGS $JPEG_PE_CFLAGS"
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for MinGW jpeglib.h" >&5
+printf %s "checking for MinGW jpeglib.h... " >&6; }
+if test ${ac_cv_mingw_header_jpeglib_h+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
+ac_wine_check_headers_saved_exeext=$ac_exeext
+eval CC=\$${wine_arch}_CC
+ac_exeext=".exe"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <stddef.h>
+             #include <stdio.h>
+#include <jpeglib.h>
+int
+main (void)
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+  ac_cv_mingw_header_jpeglib_h=yes
+else case e in #(
+  e) ac_cv_mingw_header_jpeglib_h=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+CC=$ac_wine_check_headers_saved_cc
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_jpeglib_h" >&5
+printf "%s\n" "$ac_cv_mingw_header_jpeglib_h" >&6; }
+if test "x$ac_cv_mingw_header_jpeglib_h" = xyes
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for jpeg_start_decompress in MinGW -ljpeg" >&5
+printf %s "checking for jpeg_start_decompress in MinGW -ljpeg... " >&6; }
+if test ${ac_cv_mingw_lib_jpeg+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
+ac_wine_check_headers_saved_exeext=$ac_exeext
+ac_wine_check_headers_saved_libs=$LIBS
+eval CC=\$${wine_arch}_CC
+ac_exeext=".exe"
+LIBS="-ljpeg $JPEG_PE_LIBS $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char jpeg_start_decompress (void);
+int
+main (void)
+{
+return jpeg_start_decompress ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  ac_cv_mingw_lib_jpeg=yes
+else case e in #(
+  e) ac_cv_mingw_lib_jpeg=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+CC=$ac_wine_check_headers_saved_cc
+ac_exeext=$ac_wine_check_headers_saved_exeext
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_jpeg" >&5
+printf "%s\n" "$ac_cv_mingw_lib_jpeg" >&6; }
+if test "x$ac_cv_mingw_lib_jpeg" = xyes
+then :
+  :
+else case e in #(
+  e) JPEG_PE_CFLAGS=""; JPEG_PE_LIBS="" ;;
+esac
+fi
+else case e in #(
+  e) JPEG_PE_CFLAGS=""; JPEG_PE_LIBS="" ;;
+esac
+fi
+CPPFLAGS=$ac_save_CPPFLAGS
+
+    if test "x$JPEG_PE_LIBS" = "x"
+    then
+        as_fn_append wine_notices "|libjpeg ${notice_platform}MinGW development files not found; using bundled version."
+    fi
+
+    if ${LCMS2_PE_CFLAGS:+false} :
+then :
+  if test ${MINGW_PKG_CONFIG+y}
+then :
+  LCMS2_PE_CFLAGS=`$MINGW_PKG_CONFIG --cflags lcms2 2>/dev/null`
+fi
+fi
+if ${LCMS2_PE_LIBS:+false} :
+then :
+  if test ${MINGW_PKG_CONFIG+y}
+then :
+  LCMS2_PE_LIBS=`$MINGW_PKG_CONFIG --libs lcms2 2>/dev/null`
+fi
+fi
+LCMS2_PE_LIBS=${LCMS2_PE_LIBS:-"-llcms2"}
+ac_save_CPPFLAGS=$CPPFLAGS
+CPPFLAGS="$CPPFLAGS $LCMS2_PE_CFLAGS"
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for MinGW lcms2.h" >&5
+printf %s "checking for MinGW lcms2.h... " >&6; }
+if test ${ac_cv_mingw_header_lcms2_h+y}
+then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12050,12 +12795,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_lcms2_h=yes
-else $as_nop
-  ac_cv_mingw_header_lcms2_h=no
+else case e in #(
+  e) ac_cv_mingw_header_lcms2_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_lcms2_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_lcms2_h" >&6; }
@@ -12066,8 +12813,8 @@ printf %s "checking for cmsOpenProfileFromFile in MinGW -llcms2... " >&6; }
 if test ${ac_cv_mingw_lib_lcms2+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -12078,8 +12825,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char cmsOpenProfileFromFile ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char cmsOpenProfileFromFile (void);
 int
 main (void)
 {
@@ -12091,25 +12844,29 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_lcms2=yes
-else $as_nop
-  ac_cv_mingw_lib_lcms2=no
+else case e in #(
+  e) ac_cv_mingw_lib_lcms2=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_lcms2" >&5
 printf "%s\n" "$ac_cv_mingw_lib_lcms2" >&6; }
 if test "x$ac_cv_mingw_lib_lcms2" = xyes
 then :
   :
-else $as_nop
-  LCMS2_PE_CFLAGS=""; LCMS2_PE_LIBS=""
+else case e in #(
+  e) LCMS2_PE_CFLAGS=""; LCMS2_PE_LIBS="" ;;
+esac
 fi
-else $as_nop
-  LCMS2_PE_CFLAGS=""; LCMS2_PE_LIBS=""
+else case e in #(
+  e) LCMS2_PE_CFLAGS=""; LCMS2_PE_LIBS="" ;;
+esac
 fi
 CPPFLAGS=$ac_save_CPPFLAGS
 
@@ -12140,8 +12897,8 @@ printf %s "checking for MinGW mpg123.h... " >&6; }
 if test ${ac_cv_mingw_header_mpg123_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12160,12 +12917,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_mpg123_h=yes
-else $as_nop
-  ac_cv_mingw_header_mpg123_h=no
+else case e in #(
+  e) ac_cv_mingw_header_mpg123_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_mpg123_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_mpg123_h" >&6; }
@@ -12176,8 +12935,8 @@ printf %s "checking for mpg123_feed in MinGW -lmpg123... " >&6; }
 if test ${ac_cv_mingw_lib_mpg123+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -12188,8 +12947,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char mpg123_feed ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char mpg123_feed (void);
 int
 main (void)
 {
@@ -12201,25 +12966,29 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_mpg123=yes
-else $as_nop
-  ac_cv_mingw_lib_mpg123=no
+else case e in #(
+  e) ac_cv_mingw_lib_mpg123=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_mpg123" >&5
 printf "%s\n" "$ac_cv_mingw_lib_mpg123" >&6; }
 if test "x$ac_cv_mingw_lib_mpg123" = xyes
 then :
   :
-else $as_nop
-  MPG123_PE_CFLAGS=""; MPG123_PE_LIBS=""
+else case e in #(
+  e) MPG123_PE_CFLAGS=""; MPG123_PE_LIBS="" ;;
+esac
 fi
-else $as_nop
-  MPG123_PE_CFLAGS=""; MPG123_PE_LIBS=""
+else case e in #(
+  e) MPG123_PE_CFLAGS=""; MPG123_PE_LIBS="" ;;
+esac
 fi
 CPPFLAGS=$ac_save_CPPFLAGS
 
@@ -12250,8 +13019,8 @@ printf %s "checking for MinGW png.h... " >&6; }
 if test ${ac_cv_mingw_header_png_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12270,12 +13039,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_png_h=yes
-else $as_nop
-  ac_cv_mingw_header_png_h=no
+else case e in #(
+  e) ac_cv_mingw_header_png_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_png_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_png_h" >&6; }
@@ -12286,8 +13057,8 @@ printf %s "checking for png_create_read_struct in MinGW -lpng... " >&6; }
 if test ${ac_cv_mingw_lib_png+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -12298,8 +13069,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char png_create_read_struct ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char png_create_read_struct (void);
 int
 main (void)
 {
@@ -12311,25 +13088,29 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_png=yes
-else $as_nop
-  ac_cv_mingw_lib_png=no
+else case e in #(
+  e) ac_cv_mingw_lib_png=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_png" >&5
 printf "%s\n" "$ac_cv_mingw_lib_png" >&6; }
 if test "x$ac_cv_mingw_lib_png" = xyes
 then :
   :
-else $as_nop
-  PNG_PE_CFLAGS=""; PNG_PE_LIBS=""
+else case e in #(
+  e) PNG_PE_CFLAGS=""; PNG_PE_LIBS="" ;;
+esac
 fi
-else $as_nop
-  PNG_PE_CFLAGS=""; PNG_PE_LIBS=""
+else case e in #(
+  e) PNG_PE_CFLAGS=""; PNG_PE_LIBS="" ;;
+esac
 fi
 CPPFLAGS=$ac_save_CPPFLAGS
 
@@ -12360,8 +13141,8 @@ printf %s "checking for MinGW tiffio.h... " >&6; }
 if test ${ac_cv_mingw_header_tiffio_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12380,12 +13161,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_tiffio_h=yes
-else $as_nop
-  ac_cv_mingw_header_tiffio_h=no
+else case e in #(
+  e) ac_cv_mingw_header_tiffio_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_tiffio_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_tiffio_h" >&6; }
@@ -12396,8 +13179,8 @@ printf %s "checking for TIFFClientOpen in MinGW -ltiff... " >&6; }
 if test ${ac_cv_mingw_lib_tiff+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -12408,8 +13191,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char TIFFClientOpen ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char TIFFClientOpen (void);
 int
 main (void)
 {
@@ -12421,25 +13210,29 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_tiff=yes
-else $as_nop
-  ac_cv_mingw_lib_tiff=no
+else case e in #(
+  e) ac_cv_mingw_lib_tiff=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_tiff" >&5
 printf "%s\n" "$ac_cv_mingw_lib_tiff" >&6; }
 if test "x$ac_cv_mingw_lib_tiff" = xyes
 then :
   :
-else $as_nop
-  TIFF_PE_CFLAGS=""; TIFF_PE_LIBS=""
+else case e in #(
+  e) TIFF_PE_CFLAGS=""; TIFF_PE_LIBS="" ;;
+esac
 fi
-else $as_nop
-  TIFF_PE_CFLAGS=""; TIFF_PE_LIBS=""
+else case e in #(
+  e) TIFF_PE_CFLAGS=""; TIFF_PE_LIBS="" ;;
+esac
 fi
 CPPFLAGS=$ac_save_CPPFLAGS
 
@@ -12470,8 +13263,8 @@ printf %s "checking for MinGW libxml/parser.h... " >&6; }
 if test ${ac_cv_mingw_header_libxml_parser_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12490,12 +13283,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_libxml_parser_h=yes
-else $as_nop
-  ac_cv_mingw_header_libxml_parser_h=no
+else case e in #(
+  e) ac_cv_mingw_header_libxml_parser_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_libxml_parser_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_libxml_parser_h" >&6; }
@@ -12508,8 +13303,8 @@ printf %s "checking for MinGW libxml/xmlsave.h... " >&6; }
 if test ${ac_cv_mingw_header_libxml_xmlsave_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12528,12 +13323,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_libxml_xmlsave_h=yes
-else $as_nop
-  ac_cv_mingw_header_libxml_xmlsave_h=no
+else case e in #(
+  e) ac_cv_mingw_header_libxml_xmlsave_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_libxml_xmlsave_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_libxml_xmlsave_h" >&6; }
@@ -12546,8 +13343,8 @@ printf %s "checking for MinGW libxml/SAX2.h... " >&6; }
 if test ${ac_cv_mingw_header_libxml_SAX2_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12566,12 +13363,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_libxml_SAX2_h=yes
-else $as_nop
-  ac_cv_mingw_header_libxml_SAX2_h=no
+else case e in #(
+  e) ac_cv_mingw_header_libxml_SAX2_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_libxml_SAX2_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_libxml_SAX2_h" >&6; }
@@ -12586,8 +13385,8 @@ printf %s "checking for xmlFirstElementChild in MinGW -lxml2... " >&6; }
 if test ${ac_cv_mingw_lib_xml2+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -12598,8 +13397,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char xmlFirstElementChild ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char xmlFirstElementChild (void);
 int
 main (void)
 {
@@ -12611,22 +13416,25 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_xml2=yes
-else $as_nop
-  ac_cv_mingw_lib_xml2=no
+else case e in #(
+  e) ac_cv_mingw_lib_xml2=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_xml2" >&5
 printf "%s\n" "$ac_cv_mingw_lib_xml2" >&6; }
 if test "x$ac_cv_mingw_lib_xml2" = xyes
 then :
   :
-else $as_nop
-  XML2_PE_CFLAGS=""; XML2_PE_LIBS=""
+else case e in #(
+  e) XML2_PE_CFLAGS=""; XML2_PE_LIBS="" ;;
+esac
 fi
         else
             XML2_PE_CFLAGS=""
@@ -12661,8 +13469,8 @@ printf %s "checking for MinGW libxslt/pattern.h... " >&6; }
 if test ${ac_cv_mingw_header_libxslt_pattern_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12681,12 +13489,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_libxslt_pattern_h=yes
-else $as_nop
-  ac_cv_mingw_header_libxslt_pattern_h=no
+else case e in #(
+  e) ac_cv_mingw_header_libxslt_pattern_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_libxslt_pattern_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_libxslt_pattern_h" >&6; }
@@ -12699,8 +13509,8 @@ printf %s "checking for MinGW libxslt/transform.h... " >&6; }
 if test ${ac_cv_mingw_header_libxslt_transform_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12719,12 +13529,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_libxslt_transform_h=yes
-else $as_nop
-  ac_cv_mingw_header_libxslt_transform_h=no
+else case e in #(
+  e) ac_cv_mingw_header_libxslt_transform_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_libxslt_transform_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_libxslt_transform_h" >&6; }
@@ -12739,8 +13551,8 @@ printf %s "checking for xsltCompilePattern in MinGW -lxslt... " >&6; }
 if test ${ac_cv_mingw_lib_xslt+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -12751,8 +13563,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char xsltCompilePattern ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char xsltCompilePattern (void);
 int
 main (void)
 {
@@ -12764,22 +13582,25 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_xslt=yes
-else $as_nop
-  ac_cv_mingw_lib_xslt=no
+else case e in #(
+  e) ac_cv_mingw_lib_xslt=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_xslt" >&5
 printf "%s\n" "$ac_cv_mingw_lib_xslt" >&6; }
 if test "x$ac_cv_mingw_lib_xslt" = xyes
 then :
   :
-else $as_nop
-  XSLT_PE_CFLAGS=""; XSLT_PE_LIBS=""
+else case e in #(
+  e) XSLT_PE_CFLAGS=""; XSLT_PE_LIBS="" ;;
+esac
 fi
         else
             XSLT_PE_CFLAGS=""
@@ -12814,8 +13635,8 @@ printf %s "checking for MinGW vkd3d.h... " >&6; }
 if test ${ac_cv_mingw_header_vkd3d_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12834,12 +13655,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_vkd3d_h=yes
-else $as_nop
-  ac_cv_mingw_header_vkd3d_h=no
+else case e in #(
+  e) ac_cv_mingw_header_vkd3d_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_vkd3d_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_vkd3d_h" >&6; }
@@ -12852,8 +13675,8 @@ printf %s "checking for MinGW vkd3d_shader.h... " >&6; }
 if test ${ac_cv_mingw_header_vkd3d_shader_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -12872,12 +13695,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_vkd3d_shader_h=yes
-else $as_nop
-  ac_cv_mingw_header_vkd3d_shader_h=no
+else case e in #(
+  e) ac_cv_mingw_header_vkd3d_shader_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_vkd3d_shader_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_vkd3d_shader_h" >&6; }
@@ -12892,8 +13717,8 @@ printf %s "checking for vkd3d_set_log_callback in MinGW -lvkd3d... " >&6; }
 if test ${ac_cv_mingw_lib_vkd3d+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -12904,8 +13729,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char vkd3d_set_log_callback ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char vkd3d_set_log_callback (void);
 int
 main (void)
 {
@@ -12917,30 +13748,33 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_vkd3d=yes
-else $as_nop
-  ac_cv_mingw_lib_vkd3d=no
+else case e in #(
+  e) ac_cv_mingw_lib_vkd3d=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_vkd3d" >&5
 printf "%s\n" "$ac_cv_mingw_lib_vkd3d" >&6; }
 if test "x$ac_cv_mingw_lib_vkd3d" = xyes
 then :
   :
-else $as_nop
-  :
+else case e in #(
+  e) : ;;
+esac
 fi
-            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for vkd3d_shader_compile in MinGW -lvkd3d-shader" >&5
-printf %s "checking for vkd3d_shader_compile in MinGW -lvkd3d-shader... " >&6; }
+            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for vkd3d_shader_serialize_dxbc in MinGW -lvkd3d-shader" >&5
+printf %s "checking for vkd3d_shader_serialize_dxbc in MinGW -lvkd3d-shader... " >&6; }
 if test ${ac_cv_mingw_lib_vkd3d_shader+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -12951,12 +13785,18 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char vkd3d_shader_compile ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char vkd3d_shader_serialize_dxbc (void);
 int
 main (void)
 {
-return vkd3d_shader_compile ();
+return vkd3d_shader_serialize_dxbc ();
   ;
   return 0;
 }
@@ -12964,22 +13804,25 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_vkd3d_shader=yes
-else $as_nop
-  ac_cv_mingw_lib_vkd3d_shader=no
+else case e in #(
+  e) ac_cv_mingw_lib_vkd3d_shader=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_vkd3d_shader" >&5
 printf "%s\n" "$ac_cv_mingw_lib_vkd3d_shader" >&6; }
 if test "x$ac_cv_mingw_lib_vkd3d_shader" = xyes
 then :
   :
-else $as_nop
-  :
+else case e in #(
+  e) : ;;
+esac
 fi
             if test "$ac_cv_mingw_lib_vkd3d" = "no" -o "$ac_cv_mingw_lib_vkd3d_shader" = "no"
             then
@@ -13019,8 +13862,8 @@ printf %s "checking for MinGW zlib.h... " >&6; }
 if test ${ac_cv_mingw_header_zlib_h+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 eval CC=\$${wine_arch}_CC
 ac_exeext=".exe"
@@ -13039,12 +13882,14 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mingw_header_zlib_h=yes
-else $as_nop
-  ac_cv_mingw_header_zlib_h=no
+else case e in #(
+  e) ac_cv_mingw_header_zlib_h=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
-ac_exeext=$ac_wine_check_headers_saved_exeext
+ac_exeext=$ac_wine_check_headers_saved_exeext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_header_zlib_h" >&5
 printf "%s\n" "$ac_cv_mingw_header_zlib_h" >&6; }
@@ -13055,8 +13900,8 @@ printf %s "checking for inflate in MinGW -lz... " >&6; }
 if test ${ac_cv_mingw_lib_z+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_check_headers_saved_cc=$CC
+else case e in #(
+  e) ac_wine_check_headers_saved_cc=$CC
 ac_wine_check_headers_saved_exeext=$ac_exeext
 ac_wine_check_headers_saved_libs=$LIBS
 eval CC=\$${wine_arch}_CC
@@ -13067,8 +13912,14 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char inflate ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char inflate (void);
 int
 main (void)
 {
@@ -13080,25 +13931,29 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_mingw_lib_z=yes
-else $as_nop
-  ac_cv_mingw_lib_z=no
+else case e in #(
+  e) ac_cv_mingw_lib_z=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
 CC=$ac_wine_check_headers_saved_cc
 ac_exeext=$ac_wine_check_headers_saved_exeext
-LIBS=$ac_wine_check_headers_saved_libs
+LIBS=$ac_wine_check_headers_saved_libs ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mingw_lib_z" >&5
 printf "%s\n" "$ac_cv_mingw_lib_z" >&6; }
 if test "x$ac_cv_mingw_lib_z" = xyes
 then :
   :
-else $as_nop
-  ZLIB_PE_CFLAGS=""; ZLIB_PE_LIBS=""
+else case e in #(
+  e) ZLIB_PE_CFLAGS=""; ZLIB_PE_LIBS="" ;;
+esac
 fi
-else $as_nop
-  ZLIB_PE_CFLAGS=""; ZLIB_PE_LIBS=""
+else case e in #(
+  e) ZLIB_PE_CFLAGS=""; ZLIB_PE_LIBS="" ;;
+esac
 fi
 CPPFLAGS=$ac_save_CPPFLAGS
 
@@ -13114,26 +13969,47 @@ then :
    if ${FAUDIO_PE_CFLAGS:+false} :
 then :
   FAUDIO_PE_CFLAGS="-I\$(top_srcdir)/libs/faudio/include"
-else $as_nop
-  enable_faudio=no
+else case e in #(
+  e) enable_faudio=no ;;
+esac
 fi
-else $as_nop
-  enable_faudio=no
+else case e in #(
+  e) enable_faudio=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: faudio cflags: $FAUDIO_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: faudio libs: $FAUDIO_PE_LIBS" >&5
 
+if ${FLUIDSYNTH_PE_LIBS:+false} :
+then :
+  FLUIDSYNTH_PE_LIBS="fluidsynth"
+   if ${FLUIDSYNTH_PE_CFLAGS:+false} :
+then :
+  FLUIDSYNTH_PE_CFLAGS="-I\$(top_srcdir)/libs/fluidsynth/include"
+else case e in #(
+  e) enable_fluidsynth=no ;;
+esac
+fi
+else case e in #(
+  e) enable_fluidsynth=no ;;
+esac
+fi
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: fluidsynth cflags: $FLUIDSYNTH_PE_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: fluidsynth libs: $FLUIDSYNTH_PE_LIBS" >&5
+
 if ${GSM_PE_LIBS:+false} :
 then :
   GSM_PE_LIBS=gsm
    if ${GSM_PE_CFLAGS:+false} :
 then :
   GSM_PE_CFLAGS="-I\$(top_srcdir)/libs/gsm/inc"
-else $as_nop
-  enable_gsm=no
+else case e in #(
+  e) enable_gsm=no ;;
+esac
 fi
-else $as_nop
-  enable_gsm=no
+else case e in #(
+  e) enable_gsm=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: gsm cflags: $GSM_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: gsm libs: $GSM_PE_LIBS" >&5
@@ -13144,11 +14020,13 @@ then :
    if ${JPEG_PE_CFLAGS:+false} :
 then :
   JPEG_PE_CFLAGS="-I\$(top_srcdir)/libs/jpeg"
-else $as_nop
-  enable_jpeg=no
+else case e in #(
+  e) enable_jpeg=no ;;
+esac
 fi
-else $as_nop
-  enable_jpeg=no
+else case e in #(
+  e) enable_jpeg=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: jpeg cflags: $JPEG_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: jpeg libs: $JPEG_PE_LIBS" >&5
@@ -13159,11 +14037,13 @@ then :
    if ${JXR_PE_CFLAGS:+false} :
 then :
   JXR_PE_CFLAGS="-I\$(top_srcdir)/libs/jxr/jxrgluelib -I\$(top_srcdir)/libs/jxr/image/sys"
-else $as_nop
-  enable_jxr=no
+else case e in #(
+  e) enable_jxr=no ;;
+esac
 fi
-else $as_nop
-  enable_jxr=no
+else case e in #(
+  e) enable_jxr=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: jxr cflags: $JXR_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: jxr libs: $JXR_PE_LIBS" >&5
@@ -13174,11 +14054,13 @@ then :
    if ${LCMS2_PE_CFLAGS:+false} :
 then :
   LCMS2_PE_CFLAGS="-I\$(top_srcdir)/libs/lcms2/include"
-else $as_nop
-  enable_lcms2=no
+else case e in #(
+  e) enable_lcms2=no ;;
+esac
 fi
-else $as_nop
-  enable_lcms2=no
+else case e in #(
+  e) enable_lcms2=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: lcms2 cflags: $LCMS2_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: lcms2 libs: $LCMS2_PE_LIBS" >&5
@@ -13189,11 +14071,13 @@ then :
    if ${LDAP_PE_CFLAGS:+false} :
 then :
   LDAP_PE_CFLAGS="-I\$(top_srcdir)/libs/ldap/include"
-else $as_nop
-  enable_ldap=no
+else case e in #(
+  e) enable_ldap=no ;;
+esac
 fi
-else $as_nop
-  enable_ldap=no
+else case e in #(
+  e) enable_ldap=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: ldap cflags: $LDAP_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: ldap libs: $LDAP_PE_LIBS" >&5
@@ -13204,26 +14088,47 @@ then :
    if ${MPG123_PE_CFLAGS:+false} :
 then :
   MPG123_PE_CFLAGS="-I\$(top_srcdir)/libs/mpg123/src/libmpg123"
-else $as_nop
-  enable_mpg123=no
+else case e in #(
+  e) enable_mpg123=no ;;
+esac
 fi
-else $as_nop
-  enable_mpg123=no
+else case e in #(
+  e) enable_mpg123=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: mpg123 cflags: $MPG123_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: mpg123 libs: $MPG123_PE_LIBS" >&5
 
+if ${MUSL_PE_LIBS:+false} :
+then :
+  MUSL_PE_LIBS=musl
+   if ${MUSL_PE_CFLAGS:+false} :
+then :
+  MUSL_PE_CFLAGS=
+else case e in #(
+  e) enable_musl=no ;;
+esac
+fi
+else case e in #(
+  e) enable_musl=no ;;
+esac
+fi
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: musl cflags: $MUSL_PE_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: musl libs: $MUSL_PE_LIBS" >&5
+
 if ${PNG_PE_LIBS:+false} :
 then :
   PNG_PE_LIBS="png \$(ZLIB_PE_LIBS)"
    if ${PNG_PE_CFLAGS:+false} :
 then :
   PNG_PE_CFLAGS="-I\$(top_srcdir)/libs/png"
-else $as_nop
-  enable_png=no
+else case e in #(
+  e) enable_png=no ;;
+esac
 fi
-else $as_nop
-  enable_png=no
+else case e in #(
+  e) enable_png=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: png cflags: $PNG_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: png libs: $PNG_PE_LIBS" >&5
@@ -13234,11 +14139,13 @@ then :
    if ${TIFF_PE_CFLAGS:+false} :
 then :
   TIFF_PE_CFLAGS="-I\$(top_srcdir)/libs/tiff/libtiff"
-else $as_nop
-  enable_tiff=no
+else case e in #(
+  e) enable_tiff=no ;;
+esac
 fi
-else $as_nop
-  enable_tiff=no
+else case e in #(
+  e) enable_tiff=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: tiff cflags: $TIFF_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: tiff libs: $TIFF_PE_LIBS" >&5
@@ -13249,11 +14156,13 @@ then :
    if ${VKD3D_PE_CFLAGS:+false} :
 then :
   VKD3D_PE_CFLAGS="-I\$(top_srcdir)/libs/vkd3d/include"
-else $as_nop
-  enable_vkd3d=no
+else case e in #(
+  e) enable_vkd3d=no ;;
+esac
 fi
-else $as_nop
-  enable_vkd3d=no
+else case e in #(
+  e) enable_vkd3d=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: vkd3d cflags: $VKD3D_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: vkd3d libs: $VKD3D_PE_LIBS" >&5
@@ -13264,11 +14173,13 @@ then :
    if ${XML2_PE_CFLAGS:+false} :
 then :
   XML2_PE_CFLAGS="-I\$(top_srcdir)/libs/xml2/include -DLIBXML_STATIC"
-else $as_nop
-  enable_xml2=no
+else case e in #(
+  e) enable_xml2=no ;;
+esac
 fi
-else $as_nop
-  enable_xml2=no
+else case e in #(
+  e) enable_xml2=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: xml2 cflags: $XML2_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: xml2 libs: $XML2_PE_LIBS" >&5
@@ -13279,11 +14190,13 @@ then :
    if ${XSLT_PE_CFLAGS:+false} :
 then :
   XSLT_PE_CFLAGS="-I\$(top_srcdir)/libs/xslt/libxslt -I\$(top_srcdir)/libs/xslt -DLIBXSLT_STATIC"
-else $as_nop
-  enable_xslt=no
+else case e in #(
+  e) enable_xslt=no ;;
+esac
 fi
-else $as_nop
-  enable_xslt=no
+else case e in #(
+  e) enable_xslt=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: xslt cflags: $XSLT_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: xslt libs: $XSLT_PE_LIBS" >&5
@@ -13294,39 +14207,66 @@ then :
    if ${ZLIB_PE_CFLAGS:+false} :
 then :
   ZLIB_PE_CFLAGS="-I\$(top_srcdir)/libs/zlib -DFAR= -DZ_SOLO"
-else $as_nop
-  enable_zlib=no
+else case e in #(
+  e) enable_zlib=no ;;
+esac
 fi
-else $as_nop
-  enable_zlib=no
+else case e in #(
+  e) enable_zlib=no ;;
+esac
 fi
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: zlib cflags: $ZLIB_PE_CFLAGS" >&5
 printf "%s\n" "$as_me:${as_lineno-$LINENO}: zlib libs: $ZLIB_PE_LIBS" >&5
 
+if ${ZYDIS_PE_LIBS:+false} :
+then :
+  ZYDIS_PE_LIBS=zydis
+   if ${ZYDIS_PE_CFLAGS:+false} :
+then :
+  ZYDIS_PE_CFLAGS="-I\$(top_srcdir)/libs/zydis/include"
+else case e in #(
+  e) enable_zydis=no ;;
+esac
+fi
+else case e in #(
+  e) enable_zydis=no ;;
+esac
+fi
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: zydis cflags: $ZYDIS_PE_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: zydis libs: $ZYDIS_PE_LIBS" >&5
 
-
-if test "$ac_cv_header_pthread_h" = "yes"
-then
-    ac_fn_c_check_func "$LINENO" "pthread_create" "ac_cv_func_pthread_create"
+
+
+if test "x$with_pthread" = xno
+then :
+
+else case e in #(
+  e) ac_fn_c_check_func "$LINENO" "pthread_create" "ac_cv_func_pthread_create"
 if test "x$ac_cv_func_pthread_create" = xyes
 then :
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pthread_create in -lpthread" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pthread_create in -lpthread" >&5
 printf %s "checking for pthread_create in -lpthread... " >&6; }
 if test ${ac_cv_lib_pthread_pthread_create+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lpthread  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char pthread_create ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char pthread_create (void);
 int
 main (void)
 {
@@ -13338,12 +14278,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_pthread_pthread_create=yes
-else $as_nop
-  ac_cv_lib_pthread_pthread_create=no
+else case e in #(
+  e) ac_cv_lib_pthread_pthread_create=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pthread_pthread_create" >&5
 printf "%s\n" "$ac_cv_lib_pthread_pthread_create" >&6; }
@@ -13352,9 +14294,11 @@ then :
   PTHREAD_LIBS="-lpthread"
 
 fi
-
+ ;;
+esac
 fi
-
+ ;;
+esac
 fi
 if test "x$ac_cv_func_pthread_create" != xyes -a "x$PTHREAD_LIBS" = x
 then :
@@ -13383,8 +14327,8 @@ if test -z "$CPP"; then
   if test ${ac_cv_prog_CPP+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-      # Double quotes because $CC needs to be expanded
+else case e in #(
+  e)     # Double quotes because $CC needs to be expanded
     for CPP in "$CC -E" "$CC -E -traditional-cpp" cpp /lib/cpp
     do
       ac_preproc_ok=false
@@ -13402,9 +14346,10 @@ _ACEOF
 if ac_fn_c_try_cpp "$LINENO"
 then :
 
-else $as_nop
-  # Broken: fails on valid input.
-continue
+else case e in #(
+  e) # Broken: fails on valid input.
+continue ;;
+esac
 fi
 rm -f conftest.err conftest.i conftest.$ac_ext
 
@@ -13418,15 +14363,16 @@ if ac_fn_c_try_cpp "$LINENO"
 then :
   # Broken: success on invalid input.
 continue
-else $as_nop
-  # Passes both tests.
+else case e in #(
+  e) # Passes both tests.
 ac_preproc_ok=:
-break
+break ;;
+esac
 fi
 rm -f conftest.err conftest.i conftest.$ac_ext
 
 done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
+# Because of 'break', _AC_PREPROC_IFELSE's cleaning code was skipped.
 rm -f conftest.i conftest.err conftest.$ac_ext
 if $ac_preproc_ok
 then :
@@ -13435,7 +14381,8 @@ fi
 
     done
     ac_cv_prog_CPP=$CPP
-
+   ;;
+esac
 fi
   CPP=$ac_cv_prog_CPP
 else
@@ -13458,9 +14405,10 @@ _ACEOF
 if ac_fn_c_try_cpp "$LINENO"
 then :
 
-else $as_nop
-  # Broken: fails on valid input.
-continue
+else case e in #(
+  e) # Broken: fails on valid input.
+continue ;;
+esac
 fi
 rm -f conftest.err conftest.i conftest.$ac_ext
 
@@ -13474,24 +14422,26 @@ if ac_fn_c_try_cpp "$LINENO"
 then :
   # Broken: success on invalid input.
 continue
-else $as_nop
-  # Passes both tests.
+else case e in #(
+  e) # Passes both tests.
 ac_preproc_ok=:
-break
+break ;;
+esac
 fi
 rm -f conftest.err conftest.i conftest.$ac_ext
 
 done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
+# Because of 'break', _AC_PREPROC_IFELSE's cleaning code was skipped.
 rm -f conftest.i conftest.err conftest.$ac_ext
 if $ac_preproc_ok
 then :
 
-else $as_nop
-  { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+else case e in #(
+  e) { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in '$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in '$ac_pwd':" >&2;}
 as_fn_error $? "C preprocessor \"$CPP\" fails sanity check
-See \`config.log' for more details" "$LINENO" 5; }
+See 'config.log' for more details" "$LINENO" 5; } ;;
+esac
 fi
 
 ac_ext=c
@@ -13511,7 +14461,7 @@ then :
   withval=$with_x;
 fi
 
-# $have_x is `yes', `no', `disabled', or empty when we do not yet know.
+# $have_x is 'yes', 'no', 'disabled', or empty when we do not yet know.
 if test "x$with_x" = xno; then
   # The user explicitly disabled X.
   have_x=disabled
@@ -13521,8 +14471,8 @@ else
     *,NONE | NONE,*) if test ${ac_cv_have_x+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  # One or both of the vars are not set, and there is no cached value.
+else case e in #(
+  e) # One or both of the vars are not set, and there is no cached value.
 ac_x_includes=no
 ac_x_libraries=no
 # Do we need to do anything special at all?
@@ -13645,13 +14595,14 @@ if ac_fn_c_try_cpp "$LINENO"
 then :
   # We can compile using X headers with no special include directory.
 ac_x_includes=
-else $as_nop
-  for ac_dir in $ac_x_header_dirs; do
+else case e in #(
+  e) for ac_dir in $ac_x_header_dirs; do
   if test -r "$ac_dir/X11/Xlib.h"; then
     ac_x_includes=$ac_dir
     break
   fi
-done
+done ;;
+esac
 fi
 rm -f conftest.err conftest.i conftest.$ac_ext
 fi # $ac_x_includes = no
@@ -13678,8 +14629,8 @@ then :
   LIBS=$ac_save_LIBS
 # We can link X programs with no special library path.
 ac_x_libraries=
-else $as_nop
-  LIBS=$ac_save_LIBS
+else case e in #(
+  e) LIBS=$ac_save_LIBS
 for ac_dir in `printf "%s\n" "$ac_x_includes $ac_x_header_dirs" | sed s/include/lib/g`
 do
   # Don't even attempt the hair of trying to link an X program!
@@ -13689,7 +14640,8 @@ do
       break 2
     fi
   done
-done
+done ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
@@ -13706,6 +14658,7 @@ case $ac_x_includes,$ac_x_libraries in #(
     ac_cv_have_x="have_x=yes\
 	ac_x_includes='$ac_x_includes'\
 	ac_x_libraries='$ac_x_libraries'" ;;
+esac ;;
 esac
 fi
 ;; #(
@@ -13767,8 +14720,8 @@ then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
 printf "%s\n" "no" >&6; }
        X_LIBS="$X_LIBS -R$x_libraries"
-else $as_nop
-  LIBS="$ac_xsave_LIBS -R $x_libraries"
+else case e in #(
+  e) LIBS="$ac_xsave_LIBS -R $x_libraries"
        cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -13785,12 +14738,14 @@ then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 printf "%s\n" "yes" >&6; }
 	  X_LIBS="$X_LIBS -R $x_libraries"
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: neither works" >&5
-printf "%s\n" "neither works" >&6; }
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: neither works" >&5
+printf "%s\n" "neither works" >&6; } ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
@@ -13814,8 +14769,14 @@ rm -f core conftest.err conftest.$ac_objext conftest.beam \
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XOpenDisplay ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XOpenDisplay (void);
 int
 main (void)
 {
@@ -13827,22 +14788,28 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for dnet_ntoa in -ldnet" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for dnet_ntoa in -ldnet" >&5
 printf %s "checking for dnet_ntoa in -ldnet... " >&6; }
 if test ${ac_cv_lib_dnet_dnet_ntoa+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldnet  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char dnet_ntoa ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char dnet_ntoa (void);
 int
 main (void)
 {
@@ -13854,12 +14821,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_dnet_dnet_ntoa=yes
-else $as_nop
-  ac_cv_lib_dnet_dnet_ntoa=no
+else case e in #(
+  e) ac_cv_lib_dnet_dnet_ntoa=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_dnet_dnet_ntoa" >&5
 printf "%s\n" "$ac_cv_lib_dnet_dnet_ntoa" >&6; }
@@ -13874,16 +14843,22 @@ printf %s "checking for dnet_ntoa in -ldnet_stub... " >&6; }
 if test ${ac_cv_lib_dnet_stub_dnet_ntoa+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldnet_stub  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char dnet_ntoa ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char dnet_ntoa (void);
 int
 main (void)
 {
@@ -13895,12 +14870,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_dnet_stub_dnet_ntoa=yes
-else $as_nop
-  ac_cv_lib_dnet_stub_dnet_ntoa=no
+else case e in #(
+  e) ac_cv_lib_dnet_stub_dnet_ntoa=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_dnet_stub_dnet_ntoa" >&5
 printf "%s\n" "$ac_cv_lib_dnet_stub_dnet_ntoa" >&6; }
@@ -13909,7 +14886,8 @@ then :
   X_EXTRA_LIBS="$X_EXTRA_LIBS -ldnet_stub"
 fi
 
-    fi
+    fi ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
@@ -13935,16 +14913,22 @@ printf %s "checking for gethostbyname in -lnsl... " >&6; }
 if test ${ac_cv_lib_nsl_gethostbyname+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lnsl  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char gethostbyname ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gethostbyname (void);
 int
 main (void)
 {
@@ -13956,12 +14940,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_nsl_gethostbyname=yes
-else $as_nop
-  ac_cv_lib_nsl_gethostbyname=no
+else case e in #(
+  e) ac_cv_lib_nsl_gethostbyname=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_nsl_gethostbyname" >&5
 printf "%s\n" "$ac_cv_lib_nsl_gethostbyname" >&6; }
@@ -13976,16 +14962,22 @@ printf %s "checking for gethostbyname in -lbsd... " >&6; }
 if test ${ac_cv_lib_bsd_gethostbyname+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lbsd  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char gethostbyname ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gethostbyname (void);
 int
 main (void)
 {
@@ -13997,12 +14989,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_bsd_gethostbyname=yes
-else $as_nop
-  ac_cv_lib_bsd_gethostbyname=no
+else case e in #(
+  e) ac_cv_lib_bsd_gethostbyname=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_bsd_gethostbyname" >&5
 printf "%s\n" "$ac_cv_lib_bsd_gethostbyname" >&6; }
@@ -14033,16 +15027,22 @@ printf %s "checking for connect in -lsocket... " >&6; }
 if test ${ac_cv_lib_socket_connect+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lsocket $X_EXTRA_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char connect ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char connect (void);
 int
 main (void)
 {
@@ -14054,12 +15054,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_socket_connect=yes
-else $as_nop
-  ac_cv_lib_socket_connect=no
+else case e in #(
+  e) ac_cv_lib_socket_connect=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_socket_connect" >&5
 printf "%s\n" "$ac_cv_lib_socket_connect" >&6; }
@@ -14083,16 +15085,22 @@ printf %s "checking for remove in -lposix... " >&6; }
 if test ${ac_cv_lib_posix_remove+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lposix  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char remove ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char remove (void);
 int
 main (void)
 {
@@ -14104,12 +15112,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_posix_remove=yes
-else $as_nop
-  ac_cv_lib_posix_remove=no
+else case e in #(
+  e) ac_cv_lib_posix_remove=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_posix_remove" >&5
 printf "%s\n" "$ac_cv_lib_posix_remove" >&6; }
@@ -14133,16 +15143,22 @@ printf %s "checking for shmat in -lipc... " >&6; }
 if test ${ac_cv_lib_ipc_shmat+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lipc  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char shmat ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char shmat (void);
 int
 main (void)
 {
@@ -14154,12 +15170,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_ipc_shmat=yes
-else $as_nop
-  ac_cv_lib_ipc_shmat=no
+else case e in #(
+  e) ac_cv_lib_ipc_shmat=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_ipc_shmat" >&5
 printf "%s\n" "$ac_cv_lib_ipc_shmat" >&6; }
@@ -14185,16 +15203,22 @@ printf %s "checking for IceConnectionNumber in -lICE... " >&6; }
 if test ${ac_cv_lib_ICE_IceConnectionNumber+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lICE $X_EXTRA_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char IceConnectionNumber ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char IceConnectionNumber (void);
 int
 main (void)
 {
@@ -14206,12 +15230,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_ICE_IceConnectionNumber=yes
-else $as_nop
-  ac_cv_lib_ICE_IceConnectionNumber=no
+else case e in #(
+  e) ac_cv_lib_ICE_IceConnectionNumber=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_ICE_IceConnectionNumber" >&5
 printf "%s\n" "$ac_cv_lib_ICE_IceConnectionNumber" >&6; }
@@ -14235,16 +15261,22 @@ printf %s "checking for -lX11... " >&6; }
 if test ${ac_cv_lib_soname_X11+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lX11 $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XCreateWindow ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XCreateWindow (void);
 int
 main (void)
 {
@@ -14264,41 +15296,50 @@ then :
   ac_cv_lib_soname_X11=`$LDD conftest$ac_exeext | grep "libX11\\.$LIBEXT" | sed -e "s/^.*\(libX11\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_X11=
+else case e in #(
+  e) ac_cv_lib_soname_X11= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_X11:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_X11" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_X11" >&5
 printf "%s\n" "$ac_cv_lib_soname_X11" >&6; }
 
 printf "%s\n" "#define SONAME_LIBX11 \"$ac_cv_lib_soname_X11\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lXext" >&5
 printf %s "checking for -lXext... " >&6; }
 if test ${ac_cv_lib_soname_Xext+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXext $X_LIBS -lX11 $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XextCreateExtension ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XextCreateExtension (void);
 int
 main (void)
 {
@@ -14318,202 +15359,98 @@ then :
   ac_cv_lib_soname_Xext=`$LDD conftest$ac_exeext | grep "libXext\\.$LIBEXT" | sed -e "s/^.*\(libXext\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xext=
+else case e in #(
+  e) ac_cv_lib_soname_Xext= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xext:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xext" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xext" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xext" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXEXT \"$ac_cv_lib_soname_Xext\"" >>confdefs.h
 
-       X_LIBS="$X_LIBS -lXext"
+       X_LIBS="$X_LIBS -lXext" ;;
+esac
 fi
     X_LIBS="$X_LIBS -lX11"
 
-        ac_fn_c_check_header_compile "$LINENO" "X11/Xlib.h" "ac_cv_header_X11_Xlib_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
-"
-if test "x$ac_cv_header_X11_Xlib_h" = xyes
-then :
-  printf "%s\n" "#define HAVE_X11_XLIB_H 1" >>confdefs.h
-
-fi
-ac_fn_c_check_header_compile "$LINENO" "X11/XKBlib.h" "ac_cv_header_X11_XKBlib_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
-"
-if test "x$ac_cv_header_X11_XKBlib_h" = xyes
-then :
-  printf "%s\n" "#define HAVE_X11_XKBLIB_H 1" >>confdefs.h
-
-fi
-ac_fn_c_check_header_compile "$LINENO" "X11/Xutil.h" "ac_cv_header_X11_Xutil_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
-"
-if test "x$ac_cv_header_X11_Xutil_h" = xyes
-then :
-  printf "%s\n" "#define HAVE_X11_XUTIL_H 1" >>confdefs.h
-
-fi
-ac_fn_c_check_header_compile "$LINENO" "X11/Xcursor/Xcursor.h" "ac_cv_header_X11_Xcursor_Xcursor_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
-"
-if test "x$ac_cv_header_X11_Xcursor_Xcursor_h" = xyes
-then :
-  printf "%s\n" "#define HAVE_X11_XCURSOR_XCURSOR_H 1" >>confdefs.h
+    xlib_includes="#include <X11/Xlib.h>
+#include <X11/Xutil.h>"
 
-fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/shape.h" "ac_cv_header_X11_extensions_shape_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+        ac_fn_c_check_header_compile "$LINENO" "X11/extensions/shape.h" "ac_cv_header_X11_extensions_shape_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_shape_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_SHAPE_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/XInput.h" "ac_cv_header_X11_extensions_XInput_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/XInput.h" "ac_cv_header_X11_extensions_XInput_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_XInput_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_XINPUT_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/XInput2.h" "ac_cv_header_X11_extensions_XInput2_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/XInput2.h" "ac_cv_header_X11_extensions_XInput2_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_XInput2_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_XINPUT2_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/XShm.h" "ac_cv_header_X11_extensions_XShm_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/XShm.h" "ac_cv_header_X11_extensions_XShm_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_XShm_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_XSHM_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xcomposite.h" "ac_cv_header_X11_extensions_Xcomposite_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
-"
-if test "x$ac_cv_header_X11_extensions_Xcomposite_h" = xyes
-then :
-  printf "%s\n" "#define HAVE_X11_EXTENSIONS_XCOMPOSITE_H 1" >>confdefs.h
-
-fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xfixes.h" "ac_cv_header_X11_extensions_Xfixes_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xfixes.h" "ac_cv_header_X11_extensions_Xfixes_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_Xfixes_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_XFIXES_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xinerama.h" "ac_cv_header_X11_extensions_Xinerama_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xinerama.h" "ac_cv_header_X11_extensions_Xinerama_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_Xinerama_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_XINERAMA_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xrandr.h" "ac_cv_header_X11_extensions_Xrandr_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xrandr.h" "ac_cv_header_X11_extensions_Xrandr_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_Xrandr_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_XRANDR_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xrender.h" "ac_cv_header_X11_extensions_Xrender_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xrender.h" "ac_cv_header_X11_extensions_Xrender_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_Xrender_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_XRENDER_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/xf86vmode.h" "ac_cv_header_X11_extensions_xf86vmode_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/xf86vmode.h" "ac_cv_header_X11_extensions_xf86vmode_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_xf86vmode_h" = xyes
 then :
   printf "%s\n" "#define HAVE_X11_EXTENSIONS_XF86VMODE_H 1" >>confdefs.h
 
 fi
-ac_fn_c_check_header_compile "$LINENO" "X11/extensions/xf86vmproto.h" "ac_cv_header_X11_extensions_xf86vmproto_h" "#ifdef HAVE_X11_XLIB_H
-# include <X11/Xlib.h>
-#endif
-#ifdef HAVE_X11_XUTIL_H
-# include <X11/Xutil.h>
-#endif
+ac_fn_c_check_header_compile "$LINENO" "X11/extensions/xf86vmproto.h" "ac_cv_header_X11_extensions_xf86vmproto_h" "$xlib_includes
 "
 if test "x$ac_cv_header_X11_extensions_xf86vmproto_h" = xyes
 then :
@@ -14522,69 +15459,31 @@ then :
 fi
 
 
-                if test "$ac_cv_header_X11_XKBlib_h" = "yes"
-        then
-              { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for XkbQueryExtension in -lX11" >&5
-printf %s "checking for XkbQueryExtension in -lX11... " >&6; }
-if test ${ac_cv_lib_X11_XkbQueryExtension+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lX11 $X_LIBS $X_EXTRA_LIBS $LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XkbQueryExtension ();
-int
-main (void)
-{
-return XkbQueryExtension ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"
-then :
-  ac_cv_lib_X11_XkbQueryExtension=yes
-else $as_nop
-  ac_cv_lib_X11_XkbQueryExtension=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_X11_XkbQueryExtension" >&5
-printf "%s\n" "$ac_cv_lib_X11_XkbQueryExtension" >&6; }
-if test "x$ac_cv_lib_X11_XkbQueryExtension" = xyes
+                ac_fn_c_check_header_compile "$LINENO" "X11/Xcursor/Xcursor.h" "ac_cv_header_X11_Xcursor_Xcursor_h" "$xlib_includes
+"
+if test "x$ac_cv_header_X11_Xcursor_Xcursor_h" = xyes
 then :
-
-printf "%s\n" "#define HAVE_XKB 1" >>confdefs.h
-
-fi
-
-        fi
-
-                if test "$ac_cv_header_X11_Xcursor_Xcursor_h" = "yes"
-        then
-            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lXcursor" >&5
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lXcursor" >&5
 printf %s "checking for -lXcursor... " >&6; }
 if test ${ac_cv_lib_soname_Xcursor+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXcursor $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XcursorImageLoadCursor ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XcursorImageLoadCursor (void);
 int
 main (void)
 {
@@ -14604,27 +15503,31 @@ then :
   ac_cv_lib_soname_Xcursor=`$LDD conftest$ac_exeext | grep "libXcursor\\.$LIBEXT" | sed -e "s/^.*\(libXcursor\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xcursor=
+else case e in #(
+  e) ac_cv_lib_soname_Xcursor= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xcursor:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xcursor" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xcursor" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xcursor" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXCURSOR \"$ac_cv_lib_soname_Xcursor\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
-        fi
+fi
+
         if test "x$ac_cv_lib_soname_Xcursor" = "x"
 then :
   case "x$with_xcursor" in
@@ -14636,23 +15539,31 @@ esac
 
 fi
 
-                if test "$ac_cv_header_X11_extensions_XInput_h" = "yes"
-        then
-            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lXi" >&5
+                ac_fn_c_check_header_compile "$LINENO" "X11/extensions/XInput.h" "ac_cv_header_X11_extensions_XInput_h" "$xlib_includes
+"
+if test "x$ac_cv_header_X11_extensions_XInput_h" = xyes
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lXi" >&5
 printf %s "checking for -lXi... " >&6; }
 if test ${ac_cv_lib_soname_Xi+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXi $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XOpenDevice ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XOpenDevice (void);
 int
 main (void)
 {
@@ -14672,27 +15583,31 @@ then :
   ac_cv_lib_soname_Xi=`$LDD conftest$ac_exeext | grep "libXi\\.$LIBEXT" | sed -e "s/^.*\(libXi\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xi=
+else case e in #(
+  e) ac_cv_lib_soname_Xi= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xi:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xi" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xi" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xi" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXI \"$ac_cv_lib_soname_Xi\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
-        fi
+fi
+
         if test "x$ac_cv_lib_soname_Xi" = "x"
 then :
   case "x$with_xinput" in
@@ -14725,16 +15640,22 @@ printf %s "checking for XShmQueryExtension in -lXext... " >&6; }
 if test ${ac_cv_lib_Xext_XShmQueryExtension+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lXext $X_LIBS $X_EXTRA_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XShmQueryExtension ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XShmQueryExtension (void);
 int
 main (void)
 {
@@ -14746,12 +15667,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_Xext_XShmQueryExtension=yes
-else $as_nop
-  ac_cv_lib_Xext_XShmQueryExtension=no
+else case e in #(
+  e) ac_cv_lib_Xext_XShmQueryExtension=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_Xext_XShmQueryExtension" >&5
 printf "%s\n" "$ac_cv_lib_Xext_XShmQueryExtension" >&6; }
@@ -14781,16 +15704,22 @@ printf %s "checking for XShapeQueryExtension in -lXext... " >&6; }
 if test ${ac_cv_lib_Xext_XShapeQueryExtension+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lXext $X_LIBS $X_EXTRA_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XShapeQueryExtension ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XShapeQueryExtension (void);
 int
 main (void)
 {
@@ -14802,12 +15731,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_Xext_XShapeQueryExtension=yes
-else $as_nop
-  ac_cv_lib_Xext_XShapeQueryExtension=no
+else case e in #(
+  e) ac_cv_lib_Xext_XShapeQueryExtension=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_Xext_XShapeQueryExtension" >&5
 printf "%s\n" "$ac_cv_lib_Xext_XShapeQueryExtension" >&6; }
@@ -14837,16 +15768,22 @@ printf %s "checking for -lXxf86vm... " >&6; }
 if test ${ac_cv_lib_soname_Xxf86vm+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXxf86vm $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XF86VidModeQueryExtension ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XF86VidModeQueryExtension (void);
 int
 main (void)
 {
@@ -14866,25 +15803,28 @@ then :
   ac_cv_lib_soname_Xxf86vm=`$LDD conftest$ac_exeext | grep "libXxf86vm\\.$LIBEXT" | sed -e "s/^.*\(libXxf86vm\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xxf86vm=
+else case e in #(
+  e) ac_cv_lib_soname_Xxf86vm= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xxf86vm:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xxf86vm" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xxf86vm" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xxf86vm" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXXF86VM \"$ac_cv_lib_soname_Xxf86vm\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
         fi
         if test "x$ac_cv_lib_soname_Xxf86vm" = "x"
@@ -14905,16 +15845,22 @@ printf %s "checking for -lXrender... " >&6; }
 if test ${ac_cv_lib_soname_Xrender+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXrender $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XRenderQueryExtension ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XRenderQueryExtension (void);
 int
 main (void)
 {
@@ -14934,20 +15880,22 @@ then :
   ac_cv_lib_soname_Xrender=`$LDD conftest$ac_exeext | grep "libXrender\\.$LIBEXT" | sed -e "s/^.*\(libXrender\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xrender=
+else case e in #(
+  e) ac_cv_lib_soname_Xrender= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xrender:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xrender" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xrender" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xrender" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXRENDER \"$ac_cv_lib_soname_Xrender\"" >>confdefs.h
@@ -14957,16 +15905,22 @@ printf %s "checking for XRenderSetPictureTransform in -lXrender... " >&6; }
 if test ${ac_cv_lib_Xrender_XRenderSetPictureTransform+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lXrender $X_LIBS $X_EXTRA_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XRenderSetPictureTransform ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XRenderSetPictureTransform (void);
 int
 main (void)
 {
@@ -14978,12 +15932,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_Xrender_XRenderSetPictureTransform=yes
-else $as_nop
-  ac_cv_lib_Xrender_XRenderSetPictureTransform=no
+else case e in #(
+  e) ac_cv_lib_Xrender_XRenderSetPictureTransform=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_Xrender_XRenderSetPictureTransform" >&5
 printf "%s\n" "$ac_cv_lib_Xrender_XRenderSetPictureTransform" >&6; }
@@ -14999,17 +15955,23 @@ printf %s "checking for XRenderCreateLinearGradient in -lXrender... " >&6; }
 if test ${ac_cv_lib_Xrender_XRenderCreateLinearGradient+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lXrender $X_LIBS $X_EXTRA_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XRenderCreateLinearGradient ();
-int
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XRenderCreateLinearGradient (void);
+int
 main (void)
 {
 return XRenderCreateLinearGradient ();
@@ -15020,12 +15982,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_Xrender_XRenderCreateLinearGradient=yes
-else $as_nop
-  ac_cv_lib_Xrender_XRenderCreateLinearGradient=no
+else case e in #(
+  e) ac_cv_lib_Xrender_XRenderCreateLinearGradient=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_Xrender_XRenderCreateLinearGradient" >&5
 printf "%s\n" "$ac_cv_lib_Xrender_XRenderCreateLinearGradient" >&6; }
@@ -15035,7 +15999,8 @@ then :
 printf "%s\n" "#define HAVE_XRENDERCREATELINEARGRADIENT 1" >>confdefs.h
 
 fi
-
+ ;;
+esac
 fi
 
         fi
@@ -15071,16 +16036,22 @@ printf %s "checking for -lXrandr... " >&6; }
 if test ${ac_cv_lib_soname_Xrandr+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXrandr $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XRRQueryExtension ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XRRQueryExtension (void);
 int
 main (void)
 {
@@ -15100,20 +16071,22 @@ then :
   ac_cv_lib_soname_Xrandr=`$LDD conftest$ac_exeext | grep "libXrandr\\.$LIBEXT" | sed -e "s/^.*\(libXrandr\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xrandr=
+else case e in #(
+  e) ac_cv_lib_soname_Xrandr= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xrandr:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xrandr" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xrandr" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xrandr" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXRANDR \"$ac_cv_lib_soname_Xrandr\"" >>confdefs.h
@@ -15135,10 +16108,12 @@ then :
 
 printf "%s\n" "#define HAVE_XRRGETPROVIDERRESOURCES 1" >>confdefs.h
 
-else $as_nop
-  as_fn_append wine_notices "|libxrandr ${notice_platform}development files too old, XRandR display device handler won't be supported."
+else case e in #(
+  e) as_fn_append wine_notices "|libxrandr ${notice_platform}development files too old, XRandR display device handler won't be supported." ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
@@ -15175,16 +16150,22 @@ printf %s "checking for -lXfixes... " >&6; }
 if test ${ac_cv_lib_soname_Xfixes+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXfixes $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XFixesQueryVersion ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XFixesQueryVersion (void);
 int
 main (void)
 {
@@ -15204,25 +16185,28 @@ then :
   ac_cv_lib_soname_Xfixes=`$LDD conftest$ac_exeext | grep "libXfixes\\.$LIBEXT" | sed -e "s/^.*\(libXfixes\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xfixes=
+else case e in #(
+  e) ac_cv_lib_soname_Xfixes= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xfixes:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xfixes" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xfixes" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xfixes" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXFIXES \"$ac_cv_lib_soname_Xfixes\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
@@ -15259,16 +16243,22 @@ printf %s "checking for -lXinerama... " >&6; }
 if test ${ac_cv_lib_soname_Xinerama+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXinerama $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XineramaQueryScreens ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XineramaQueryScreens (void);
 int
 main (void)
 {
@@ -15288,25 +16278,28 @@ then :
   ac_cv_lib_soname_Xinerama=`$LDD conftest$ac_exeext | grep "libXinerama\\.$LIBEXT" | sed -e "s/^.*\(libXinerama\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xinerama=
+else case e in #(
+  e) ac_cv_lib_soname_Xinerama= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xinerama:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xinerama" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xinerama" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xinerama" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXINERAMA \"$ac_cv_lib_soname_Xinerama\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
@@ -15322,23 +16315,31 @@ esac
 
 fi
 
-                if test "$ac_cv_header_X11_extensions_Xcomposite_h" = "yes"
-        then
-            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lXcomposite" >&5
+                ac_fn_c_check_header_compile "$LINENO" "X11/extensions/Xcomposite.h" "ac_cv_header_X11_extensions_Xcomposite_h" "$xlib_includes
+"
+if test "x$ac_cv_header_X11_extensions_Xcomposite_h" = xyes
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lXcomposite" >&5
 printf %s "checking for -lXcomposite... " >&6; }
 if test ${ac_cv_lib_soname_Xcomposite+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lXcomposite $X_LIBS $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char XCompositeRedirectWindow ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char XCompositeRedirectWindow (void);
 int
 main (void)
 {
@@ -15358,27 +16359,31 @@ then :
   ac_cv_lib_soname_Xcomposite=`$LDD conftest$ac_exeext | grep "libXcomposite\\.$LIBEXT" | sed -e "s/^.*\(libXcomposite\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_Xcomposite=
+else case e in #(
+  e) ac_cv_lib_soname_Xcomposite= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_Xcomposite:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xcomposite" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_Xcomposite" >&5
 printf "%s\n" "$ac_cv_lib_soname_Xcomposite" >&6; }
 
 printf "%s\n" "#define SONAME_LIBXCOMPOSITE \"$ac_cv_lib_soname_Xcomposite\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
-        fi
+fi
+
         if test "x$ac_cv_lib_soname_Xcomposite" = "x"
 then :
   case "x$with_xcomposite" in
@@ -15390,9 +16395,7 @@ esac
 
 fi
 
-                ac_fn_c_check_member "$LINENO" "XICCallback" "callback" "ac_cv_member_XICCallback_callback" "#ifdef HAVE_X11_XLIB_H
-#include <X11/Xlib.h>
-#endif
+                ac_fn_c_check_member "$LINENO" "XICCallback" "callback" "ac_cv_member_XICCallback_callback" "$xlib_includes
 "
 if test "x$ac_cv_member_XICCallback_callback" = xyes
 then :
@@ -15401,9 +16404,7 @@ printf "%s\n" "#define HAVE_XICCALLBACK_CALLBACK 1" >>confdefs.h
 
 
 fi
-ac_fn_c_check_member "$LINENO" "XEvent" "xcookie" "ac_cv_member_XEvent_xcookie" "#ifdef HAVE_X11_XLIB_H
-#include <X11/Xlib.h>
-#endif
+ac_fn_c_check_member "$LINENO" "XEvent" "xcookie" "ac_cv_member_XEvent_xcookie" "$xlib_includes
 "
 if test "x$ac_cv_member_XEvent_xcookie" = xyes
 then :
@@ -15423,16 +16424,22 @@ printf %s "checking for -lGL... " >&6; }
 if test ${ac_cv_lib_soname_GL+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lGL $X_LIBS -lm $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char glXCreateContext ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char glXCreateContext (void);
 int
 main (void)
 {
@@ -15452,12 +16459,14 @@ then :
   ac_cv_lib_soname_GL=`$LDD conftest$ac_exeext | grep "libGL\\.$LIBEXT" | sed -e "s/^.*\(libGL\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_GL=
+else case e in #(
+  e) ac_cv_lib_soname_GL= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_GL:+false} :
 then :
@@ -15468,16 +16477,22 @@ printf %s "checking for -lGL... " >&6; }
 if test ${ac_cv_lib_soname_GL+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lGL $X_LIBS -lm $X_EXTRA_LIBS -dylib_file /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char glXCreateContext ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char glXCreateContext (void);
 int
 main (void)
 {
@@ -15497,12 +16512,14 @@ then :
   ac_cv_lib_soname_GL=`$LDD conftest$ac_exeext | grep "libGL\\.$LIBEXT" | sed -e "s/^.*\(libGL\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_GL=
+else case e in #(
+  e) ac_cv_lib_soname_GL= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_GL:+false} :
 then :
@@ -15515,21 +16532,23 @@ This probably prevents linking to OpenGL. Try deleting the file and restarting c
                             else
                                 opengl_msg="No OpenGL library found on this system."
                             fi
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_GL" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_GL" >&5
 printf "%s\n" "$ac_cv_lib_soname_GL" >&6; }
 
 printf "%s\n" "#define SONAME_LIBGL \"$ac_cv_lib_soname_GL\"" >>confdefs.h
 
-       OPENGL_LIBS="-Xlinker -dylib_file -Xlinker /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib -lGL"
+       OPENGL_LIBS="-Xlinker -dylib_file -Xlinker /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib -lGL" ;;
+esac
 fi
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_GL" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_GL" >&5
 printf "%s\n" "$ac_cv_lib_soname_GL" >&6; }
 
 printf "%s\n" "#define SONAME_LIBGL \"$ac_cv_lib_soname_GL\"" >>confdefs.h
 
-       OPENGL_LIBS="-lGL"
+       OPENGL_LIBS="-lGL" ;;
+esac
 fi
         if test "x$with_osmesa" != "xno"
         then
@@ -15538,16 +16557,22 @@ printf %s "checking for -lOSMesa... " >&6; }
 if test ${ac_cv_lib_soname_OSMesa+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lOSMesa $X_LIBS -lm $X_EXTRA_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char OSMesaGetProcAddress ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char OSMesaGetProcAddress (void);
 int
 main (void)
 {
@@ -15567,25 +16592,28 @@ then :
   ac_cv_lib_soname_OSMesa=`$LDD conftest$ac_exeext | grep "libOSMesa\\.$LIBEXT" | sed -e "s/^.*\(libOSMesa\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_OSMesa=
+else case e in #(
+  e) ac_cv_lib_soname_OSMesa= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_OSMesa:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_OSMesa" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_OSMesa" >&5
 printf "%s\n" "$ac_cv_lib_soname_OSMesa" >&6; }
 
 printf "%s\n" "#define SONAME_LIBOSMESA \"$ac_cv_lib_soname_OSMesa\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
             if test "x$ac_cv_lib_soname_OSMesa" = "x"
 then :
@@ -15644,259 +16672,1045 @@ enable_winex11_drv=${enable_winex11_drv:-no}
 fi
 fi
 
-if test "$ac_cv_header_CL_cl_h" = "yes"
+if test "x$with_wayland" != "xno"
 then
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for clGetPlatformInfo in -lOpenCL" >&5
-printf %s "checking for clGetPlatformInfo in -lOpenCL... " >&6; }
-if test ${ac_cv_lib_OpenCL_clGetPlatformInfo+y}
+    rm -f conftest.err
+if ${WAYLAND_CLIENT_CFLAGS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  WAYLAND_CLIENT_CFLAGS=`$PKG_CONFIG --cflags wayland-client 2>conftest.err`
+fi
+fi
+
+if ${WAYLAND_CLIENT_LIBS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  WAYLAND_CLIENT_LIBS=`$PKG_CONFIG --libs wayland-client 2>/dev/null`
+fi
+fi
+
+
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: wayland-client cflags: $WAYLAND_CLIENT_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: wayland-client libs: $WAYLAND_CLIENT_LIBS" >&5
+if test -s conftest.err; then
+     printf %s "$as_me:${as_lineno-$LINENO}: wayland-client errors: " >&5
+     cat conftest.err >&5
+fi
+rm -f conftest.err
+ac_save_CPPFLAGS=$CPPFLAGS
+CPPFLAGS="$CPPFLAGS $WAYLAND_CLIENT_CFLAGS"
+ac_fn_c_check_header_compile "$LINENO" "wayland-client.h" "ac_cv_header_wayland_client_h" "$ac_includes_default"
+if test "x$ac_cv_header_wayland_client_h" = xyes
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for wl_display_connect in -lwayland-client" >&5
+printf %s "checking for wl_display_connect in -lwayland-client... " >&6; }
+if test ${ac_cv_lib_wayland_client_wl_display_connect+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lOpenCL  $LIBS"
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
+LIBS="-lwayland-client $WAYLAND_CLIENT_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char clGetPlatformInfo ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char wl_display_connect (void);
 int
 main (void)
 {
-return clGetPlatformInfo ();
+return wl_display_connect ();
   ;
   return 0;
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_lib_OpenCL_clGetPlatformInfo=yes
-else $as_nop
-  ac_cv_lib_OpenCL_clGetPlatformInfo=no
+  ac_cv_lib_wayland_client_wl_display_connect=yes
+else case e in #(
+  e) ac_cv_lib_wayland_client_wl_display_connect=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_OpenCL_clGetPlatformInfo" >&5
-printf "%s\n" "$ac_cv_lib_OpenCL_clGetPlatformInfo" >&6; }
-if test "x$ac_cv_lib_OpenCL_clGetPlatformInfo" = xyes
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_wayland_client_wl_display_connect" >&5
+printf "%s\n" "$ac_cv_lib_wayland_client_wl_display_connect" >&6; }
+if test "x$ac_cv_lib_wayland_client_wl_display_connect" = xyes
 then :
-  OPENCL_LIBS="-lOpenCL"
+  # Extract the first word of "wayland-scanner", so it can be a program name with args.
+set dummy wayland-scanner; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_path_WAYLAND_SCANNER+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) case $WAYLAND_SCANNER in
+  [\\/]* | ?:[\\/]*)
+  ac_cv_path_WAYLAND_SCANNER="$WAYLAND_SCANNER" # Let the user override the test with a path.
+  ;;
+  *)
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_path_WAYLAND_SCANNER="$as_dir$ac_word$ac_exec_ext"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+  test -z "$ac_cv_path_WAYLAND_SCANNER" && ac_cv_path_WAYLAND_SCANNER="`test -n "$PKG_CONFIG" && $PKG_CONFIG --variable=wayland_scanner wayland-scanner 2>/dev/null`"
+  ;;
+esac ;;
+esac
+fi
+WAYLAND_SCANNER=$ac_cv_path_WAYLAND_SCANNER
+if test -n "$WAYLAND_SCANNER"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $WAYLAND_SCANNER" >&5
+printf "%s\n" "$WAYLAND_SCANNER" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
 
+
+else case e in #(
+  e) WAYLAND_CLIENT_LIBS="" ;;
+esac
 fi
 
 fi
-if test "x$ac_cv_lib_OpenCL_clGetPlatformInfo" != xyes
+
+CPPFLAGS=$ac_save_CPPFLAGS
+
+    rm -f conftest.err
+if ${XKBCOMMON_CFLAGS:+false} :
 then :
-  case "x$with_opencl" in
-  x)   as_fn_append wine_notices "|OpenCL ${notice_platform}development files not found, OpenCL won't be supported." ;;
-  xno) ;;
-  *)   as_fn_error $? "OpenCL ${notice_platform}development files not found, OpenCL won't be supported.
-This is an error since --with-opencl was requested." "$LINENO" 5 ;;
-esac
-enable_opencl=${enable_opencl:-no}
+  if test ${PKG_CONFIG+y}
+then :
+  XKBCOMMON_CFLAGS=`$PKG_CONFIG --cflags xkbcommon 2>conftest.err`
+fi
 fi
 
-if test "$ac_cv_header_pcap_pcap_h" = "yes"
-then
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pcap_create in -lpcap" >&5
-printf %s "checking for pcap_create in -lpcap... " >&6; }
-if test ${ac_cv_lib_pcap_pcap_create+y}
+if ${XKBCOMMON_LIBS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  XKBCOMMON_LIBS=`$PKG_CONFIG --libs xkbcommon 2>/dev/null`
+fi
+fi
+
+
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: xkbcommon cflags: $XKBCOMMON_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: xkbcommon libs: $XKBCOMMON_LIBS" >&5
+if test -s conftest.err; then
+     printf %s "$as_me:${as_lineno-$LINENO}: xkbcommon errors: " >&5
+     cat conftest.err >&5
+fi
+rm -f conftest.err
+ac_save_CPPFLAGS=$CPPFLAGS
+CPPFLAGS="$CPPFLAGS $XKBCOMMON_CFLAGS"
+ac_fn_c_check_header_compile "$LINENO" "xkbcommon/xkbcommon.h" "ac_cv_header_xkbcommon_xkbcommon_h" "$ac_includes_default"
+if test "x$ac_cv_header_xkbcommon_xkbcommon_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_XKBCOMMON_XKBCOMMON_H 1" >>confdefs.h
+
+fi
+
+         { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for xkb_context_new in -lxkbcommon" >&5
+printf %s "checking for xkb_context_new in -lxkbcommon... " >&6; }
+if test ${ac_cv_lib_xkbcommon_xkb_context_new+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpcap  $LIBS"
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
+LIBS="-lxkbcommon $XKBCOMMON_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char pcap_create ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char xkb_context_new (void);
 int
 main (void)
 {
-return pcap_create ();
+return xkb_context_new ();
   ;
   return 0;
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_lib_pcap_pcap_create=yes
-else $as_nop
-  ac_cv_lib_pcap_pcap_create=no
+  ac_cv_lib_xkbcommon_xkb_context_new=yes
+else case e in #(
+  e) ac_cv_lib_xkbcommon_xkb_context_new=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pcap_pcap_create" >&5
-printf "%s\n" "$ac_cv_lib_pcap_pcap_create" >&6; }
-if test "x$ac_cv_lib_pcap_pcap_create" = xyes
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_xkbcommon_xkb_context_new" >&5
+printf "%s\n" "$ac_cv_lib_xkbcommon_xkb_context_new" >&6; }
+if test "x$ac_cv_lib_xkbcommon_xkb_context_new" = xyes
 then :
-  PCAP_LIBS="-lpcap"
+  :
+else case e in #(
+  e) XKBCOMMON_LIBS="" ;;
+esac
+fi
+
+CPPFLAGS=$ac_save_CPPFLAGS
+
+    rm -f conftest.err
+if ${XKBREGISTRY_CFLAGS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  XKBREGISTRY_CFLAGS=`$PKG_CONFIG --cflags xkbregistry 2>conftest.err`
+fi
+fi
+
+if ${XKBREGISTRY_LIBS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  XKBREGISTRY_LIBS=`$PKG_CONFIG --libs xkbregistry 2>/dev/null`
+fi
+fi
+
 
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: xkbregistry cflags: $XKBREGISTRY_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: xkbregistry libs: $XKBREGISTRY_LIBS" >&5
+if test -s conftest.err; then
+     printf %s "$as_me:${as_lineno-$LINENO}: xkbregistry errors: " >&5
+     cat conftest.err >&5
 fi
+rm -f conftest.err
+ac_save_CPPFLAGS=$CPPFLAGS
+CPPFLAGS="$CPPFLAGS $XKBREGISTRY_CFLAGS"
+ac_fn_c_check_header_compile "$LINENO" "xkbcommon/xkbregistry.h" "ac_cv_header_xkbcommon_xkbregistry_h" "$ac_includes_default"
+if test "x$ac_cv_header_xkbcommon_xkbregistry_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_XKBCOMMON_XKBREGISTRY_H 1" >>confdefs.h
 
 fi
-if test "x$ac_cv_lib_pcap_pcap_create" != xyes
+
+         { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for rxkb_context_new in -lxkbregistry" >&5
+printf %s "checking for rxkb_context_new in -lxkbregistry... " >&6; }
+if test ${ac_cv_lib_xkbregistry_rxkb_context_new+y}
 then :
-  case "x$with_pcap" in
-  x)   as_fn_append wine_notices "|pcap ${notice_platform}development files not found, wpcap won't be supported." ;;
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
+LIBS="-lxkbregistry $XKBREGISTRY_LIBS $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char rxkb_context_new (void);
+int
+main (void)
+{
+return rxkb_context_new ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  ac_cv_lib_xkbregistry_rxkb_context_new=yes
+else case e in #(
+  e) ac_cv_lib_xkbregistry_rxkb_context_new=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_xkbregistry_rxkb_context_new" >&5
+printf "%s\n" "$ac_cv_lib_xkbregistry_rxkb_context_new" >&6; }
+if test "x$ac_cv_lib_xkbregistry_rxkb_context_new" = xyes
+then :
+  :
+else case e in #(
+  e) XKBREGISTRY_LIBS="" ;;
+esac
+fi
+
+CPPFLAGS=$ac_save_CPPFLAGS
+
+fi
+if test -z "$WAYLAND_CLIENT_LIBS" -o -z "$WAYLAND_SCANNER" -o -z "$XKBCOMMON_LIBS" -o -z "$XKBREGISTRY_LIBS" -o "$ac_cv_header_linux_input_h" = "no"
+then :
+  case "x$with_wayland" in
+  x)   as_fn_append wine_notices "|Wayland ${notice_platform}development files not found, the Wayland driver won't be supported." ;;
   xno) ;;
-  *)   as_fn_error $? "pcap ${notice_platform}development files not found, wpcap won't be supported.
-This is an error since --with-pcap was requested." "$LINENO" 5 ;;
+  *)   as_fn_error $? "Wayland ${notice_platform}development files not found, the Wayland driver won't be supported.
+This is an error since --with-wayland was requested." "$LINENO" 5 ;;
 esac
-enable_wpcap=${enable_wpcap:-no}
+enable_winewayland_drv=${enable_winewayland_drv:-no}
 fi
 
-if test "x$with_inotify" != "xno"
+if test "$ac_cv_header_CL_cl_h" = "yes"
+then
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for clGetPlatformInfo in -lOpenCL" >&5
+printf %s "checking for clGetPlatformInfo in -lOpenCL... " >&6; }
+if test ${ac_cv_lib_OpenCL_clGetPlatformInfo+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
+LIBS="-lOpenCL  $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char clGetPlatformInfo (void);
+int
+main (void)
+{
+return clGetPlatformInfo ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  ac_cv_lib_OpenCL_clGetPlatformInfo=yes
+else case e in #(
+  e) ac_cv_lib_OpenCL_clGetPlatformInfo=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_OpenCL_clGetPlatformInfo" >&5
+printf "%s\n" "$ac_cv_lib_OpenCL_clGetPlatformInfo" >&6; }
+if test "x$ac_cv_lib_OpenCL_clGetPlatformInfo" = xyes
+then :
+  OPENCL_LIBS="-lOpenCL"
+
+fi
+
+fi
+if test "x$ac_cv_lib_OpenCL_clGetPlatformInfo" != xyes
+then :
+  case "x$with_opencl" in
+  x)   as_fn_append wine_notices "|OpenCL ${notice_platform}development files not found, OpenCL won't be supported." ;;
+  xno) ;;
+  *)   as_fn_error $? "OpenCL ${notice_platform}development files not found, OpenCL won't be supported.
+This is an error since --with-opencl was requested." "$LINENO" 5 ;;
+esac
+enable_opencl=${enable_opencl:-no}
+fi
+
+if test "$ac_cv_header_pcap_pcap_h" = "yes"
+then
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pcap_init in -lpcap" >&5
+printf %s "checking for pcap_init in -lpcap... " >&6; }
+if test ${ac_cv_lib_pcap_pcap_init+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
+LIBS="-lpcap  $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char pcap_init (void);
+int
+main (void)
+{
+return pcap_init ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  ac_cv_lib_pcap_pcap_init=yes
+else case e in #(
+  e) ac_cv_lib_pcap_pcap_init=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pcap_pcap_init" >&5
+printf "%s\n" "$ac_cv_lib_pcap_pcap_init" >&6; }
+if test "x$ac_cv_lib_pcap_pcap_init" = xyes
+then :
+  PCAP_LIBS="-lpcap"
+
+fi
+
+fi
+if test "x$ac_cv_lib_pcap_pcap_init" != xyes
+then :
+  case "x$with_pcap" in
+  x)   as_fn_append wine_notices "|pcap ${notice_platform}development files not found, wpcap won't be supported." ;;
+  xno) ;;
+  *)   as_fn_error $? "pcap ${notice_platform}development files not found, wpcap won't be supported.
+This is an error since --with-pcap was requested." "$LINENO" 5 ;;
+esac
+enable_wpcap=${enable_wpcap:-no}
+fi
+
+if test "x$with_pcsclite" != "xno"
+then
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for SCardEstablishContext in -lpcsclite" >&5
+printf %s "checking for SCardEstablishContext in -lpcsclite... " >&6; }
+if test ${ac_cv_lib_pcsclite_SCardEstablishContext+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
+LIBS="-lpcsclite  $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char SCardEstablishContext (void);
+int
+main (void)
+{
+return SCardEstablishContext ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  ac_cv_lib_pcsclite_SCardEstablishContext=yes
+else case e in #(
+  e) ac_cv_lib_pcsclite_SCardEstablishContext=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pcsclite_SCardEstablishContext" >&5
+printf "%s\n" "$ac_cv_lib_pcsclite_SCardEstablishContext" >&6; }
+if test "x$ac_cv_lib_pcsclite_SCardEstablishContext" = xyes
+then :
+  PCSCLITE_LIBS="-lpcsclite"
+
+else case e in #(
+  e) case $host_os in
+                    darwin*|macosx*) PCSCLITE_LIBS="-framework PCSC"
+ ;;
+                  esac ;;
+esac
+fi
+
+fi
+if test "x$PCSCLITE_LIBS" = x
+then :
+  case "x$with_pcsclite" in
+  x)   as_fn_append wine_notices "|libpcsclite not found, smart cards won't be supported." ;;
+  xno) ;;
+  *)   as_fn_error $? "libpcsclite not found, smart cards won't be supported.
+This is an error since --with-pcsclite was requested." "$LINENO" 5 ;;
+esac
+enable_winscard=${enable_winscard:-no}
+fi
+
+if test "x$with_inotify" != "xno"
 then
     rm -f conftest.err
 if ${INOTIFY_CFLAGS:+false} :
 then :
   if test ${PKG_CONFIG+y}
 then :
-  INOTIFY_CFLAGS=`$PKG_CONFIG --cflags libinotify 2>conftest.err`
+  INOTIFY_CFLAGS=`$PKG_CONFIG --cflags libinotify 2>conftest.err`
+fi
+fi
+
+if ${INOTIFY_LIBS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  INOTIFY_LIBS=`$PKG_CONFIG --libs libinotify 2>/dev/null`
+fi
+fi
+
+
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: libinotify cflags: $INOTIFY_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: libinotify libs: $INOTIFY_LIBS" >&5
+if test -s conftest.err; then
+     printf %s "$as_me:${as_lineno-$LINENO}: libinotify errors: " >&5
+     cat conftest.err >&5
+fi
+rm -f conftest.err
+ac_save_CPPFLAGS=$CPPFLAGS
+CPPFLAGS="$CPPFLAGS $INOTIFY_CFLAGS"
+ac_fn_c_check_header_compile "$LINENO" "sys/inotify.h" "ac_cv_header_sys_inotify_h" "$ac_includes_default"
+if test "x$ac_cv_header_sys_inotify_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_SYS_INOTIFY_H 1" >>confdefs.h
+
+fi
+
+         { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for inotify_add_watch in -linotify" >&5
+printf %s "checking for inotify_add_watch in -linotify... " >&6; }
+if test ${ac_cv_lib_inotify_inotify_add_watch+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
+LIBS="-linotify $INOTIFY_LIBS $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char inotify_add_watch (void);
+int
+main (void)
+{
+return inotify_add_watch ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  ac_cv_lib_inotify_inotify_add_watch=yes
+else case e in #(
+  e) ac_cv_lib_inotify_inotify_add_watch=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_inotify_inotify_add_watch" >&5
+printf "%s\n" "$ac_cv_lib_inotify_inotify_add_watch" >&6; }
+if test "x$ac_cv_lib_inotify_inotify_add_watch" = xyes
+then :
+  :
+else case e in #(
+  e) INOTIFY_LIBS="" ;;
+esac
+fi
+
+CPPFLAGS=$ac_save_CPPFLAGS
+
+fi
+if test "$ac_cv_header_sys_inotify_h" != "yes"
+then :
+  case "x$with_inotify" in
+  x)   as_fn_append wine_notices "|libinotify ${notice_platform}development files not found (or too old), filesystem change notifications won't be supported." ;;
+  xno) ;;
+  *)   as_fn_error $? "libinotify ${notice_platform}development files not found (or too old), filesystem change notifications won't be supported.
+This is an error since --with-inotify was requested." "$LINENO" 5 ;;
+esac
+
+fi
+
+if test "x$with_dbus" != "xno"
+then
+    rm -f conftest.err
+if ${DBUS_CFLAGS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  DBUS_CFLAGS=`$PKG_CONFIG --cflags dbus-1 2>conftest.err`
+fi
+fi
+
+if ${DBUS_LIBS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  DBUS_LIBS=`$PKG_CONFIG --libs dbus-1 2>/dev/null`
+fi
+fi
+
+
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: dbus-1 cflags: $DBUS_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: dbus-1 libs: $DBUS_LIBS" >&5
+if test -s conftest.err; then
+     printf %s "$as_me:${as_lineno-$LINENO}: dbus-1 errors: " >&5
+     cat conftest.err >&5
+fi
+rm -f conftest.err
+ac_save_CPPFLAGS=$CPPFLAGS
+CPPFLAGS="$CPPFLAGS $DBUS_CFLAGS"
+ac_fn_c_check_header_compile "$LINENO" "dbus/dbus.h" "ac_cv_header_dbus_dbus_h" "$ac_includes_default"
+if test "x$ac_cv_header_dbus_dbus_h" = xyes
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -ldbus-1" >&5
+printf %s "checking for -ldbus-1... " >&6; }
+if test ${ac_cv_lib_soname_dbus_1+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
+LIBS="-ldbus-1 $DBUS_LIBS $LIBS"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char dbus_connection_close (void);
+int
+main (void)
+{
+return dbus_connection_close ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  case "$LIBEXT" in
+    dll) ac_cv_lib_soname_dbus_1=`$ac_cv_path_LDD conftest.exe | grep "dbus-1" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_dbus_1=`$OTOOL -L conftest$ac_exeext | grep "libdbus-1\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libdbus-1\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_dbus_1=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libdbus-1\\.$LIBEXT" | sed -e "s/^.*\\[\\(libdbus-1\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
+       if ${ac_cv_lib_soname_dbus_1:+false} :
+then :
+  ac_cv_lib_soname_dbus_1=`$LDD conftest$ac_exeext | grep "libdbus-1\\.$LIBEXT" | sed -e "s/^.*\(libdbus-1\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
+fi ;;
+  esac
+else case e in #(
+  e) ac_cv_lib_soname_dbus_1= ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
+fi
+if ${ac_cv_lib_soname_dbus_1:+false} :
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
+printf "%s\n" "not found" >&6; }
+       DBUS_CFLAGS=""
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_dbus_1" >&5
+printf "%s\n" "$ac_cv_lib_soname_dbus_1" >&6; }
+
+printf "%s\n" "#define SONAME_LIBDBUS_1 \"$ac_cv_lib_soname_dbus_1\"" >>confdefs.h
+
+        ;;
+esac
+fi
+else case e in #(
+  e) DBUS_CFLAGS="" ;;
+esac
+fi
+
+CPPFLAGS=$ac_save_CPPFLAGS
+
+fi
+case $host_os in
+  darwin*|macosx*) ;;
+  *) if test "x$ac_cv_lib_soname_dbus_1" = "x"
+then :
+  case "x$with_dbus" in
+  x)   as_fn_append wine_notices "|libdbus ${notice_platform}development files not found, no dynamic device support." ;;
+  xno) ;;
+  *)   as_fn_error $? "libdbus ${notice_platform}development files not found, no dynamic device support.
+This is an error since --with-dbus was requested." "$LINENO" 5 ;;
+esac
+
+fi ;;
+esac
+
+if test "x$with_gnutls" != "xno"
+then
+    rm -f conftest.err
+if ${GNUTLS_CFLAGS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  GNUTLS_CFLAGS=`$PKG_CONFIG --cflags gnutls 2>conftest.err`
+fi
+fi
+
+if ${GNUTLS_LIBS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  GNUTLS_LIBS=`$PKG_CONFIG --libs gnutls 2>/dev/null`
+fi
+fi
+
+GNUTLS_LIBS=${GNUTLS_LIBS:-"-lgnutls"}
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: gnutls cflags: $GNUTLS_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: gnutls libs: $GNUTLS_LIBS" >&5
+if test -s conftest.err; then
+     printf %s "$as_me:${as_lineno-$LINENO}: gnutls errors: " >&5
+     cat conftest.err >&5
+fi
+rm -f conftest.err
+ac_save_CPPFLAGS=$CPPFLAGS
+CPPFLAGS="$CPPFLAGS $GNUTLS_CFLAGS"
+ac_fn_c_check_header_compile "$LINENO" "gnutls/gnutls.h" "ac_cv_header_gnutls_gnutls_h" "$ac_includes_default"
+if test "x$ac_cv_header_gnutls_gnutls_h" = xyes
+then :
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <gnutls/gnutls.h>
+#include <gnutls/crypto.h>
+int
+main (void)
+{
+static typeof(gnutls_mac_get_key_size) *func; if (func) return 0;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lgnutls" >&5
+printf %s "checking for -lgnutls... " >&6; }
+if test ${ac_cv_lib_soname_gnutls+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
+LIBS="-lgnutls $GNUTLS_LIBS $LIBS"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gnutls_global_init (void);
+int
+main (void)
+{
+return gnutls_global_init ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  case "$LIBEXT" in
+    dll) ac_cv_lib_soname_gnutls=`$ac_cv_path_LDD conftest.exe | grep "gnutls" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_gnutls=`$OTOOL -L conftest$ac_exeext | grep "libgnutls\\(-deb0\\)\\{0,1\\}\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libgnutls\\(-deb0\\)\\{0,1\\}\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_gnutls=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libgnutls\\(-deb0\\)\\{0,1\\}\\.$LIBEXT" | sed -e "s/^.*\\[\\(libgnutls\\(-deb0\\)\\{0,1\\}\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
+       if ${ac_cv_lib_soname_gnutls:+false} :
+then :
+  ac_cv_lib_soname_gnutls=`$LDD conftest$ac_exeext | grep "libgnutls\\(-deb0\\)\\{0,1\\}\\.$LIBEXT" | sed -e "s/^.*\(libgnutls\\(-deb0\\)\\{0,1\\}\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
+fi ;;
+  esac
+else case e in #(
+  e) ac_cv_lib_soname_gnutls= ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
+fi
+if ${ac_cv_lib_soname_gnutls:+false} :
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
+printf "%s\n" "not found" >&6; }
+       GNUTLS_CFLAGS=""
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_gnutls" >&5
+printf "%s\n" "$ac_cv_lib_soname_gnutls" >&6; }
+
+printf "%s\n" "#define SONAME_LIBGNUTLS \"$ac_cv_lib_soname_gnutls\"" >>confdefs.h
+
+        ;;
+esac
+fi
+                 ac_wine_check_funcs_save_LIBS="$LIBS"
+LIBS="$LIBS $GNUTLS_LIBS"
+
+  for ac_func in gnutls_cipher_init
+do :
+  ac_fn_c_check_func "$LINENO" "gnutls_cipher_init" "ac_cv_func_gnutls_cipher_init"
+if test "x$ac_cv_func_gnutls_cipher_init" = xyes
+then :
+  printf "%s\n" "#define HAVE_GNUTLS_CIPHER_INIT 1" >>confdefs.h
+
+else case e in #(
+  e) as_fn_append wine_notices "|libgnutls ${notice_platform}development files too old, bcrypt encryption won't be supported." ;;
+esac
+fi
+
+done
+LIBS="$ac_wine_check_funcs_save_LIBS"
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+else case e in #(
+  e) GNUTLS_CFLAGS="" ;;
+esac
+fi
+
+CPPFLAGS=$ac_save_CPPFLAGS
+
+fi
+if test "x$ac_cv_lib_soname_gnutls" = "x"
+then :
+  case "x$with_gnutls" in
+  x)   as_fn_append wine_warnings "|libgnutls ${notice_platform}development files not found, no schannel support." ;;
+  xno) ;;
+  *)   as_fn_error $? "libgnutls ${notice_platform}development files not found, no schannel support.
+This is an error since --with-gnutls was requested." "$LINENO" 5 ;;
+esac
+
+fi
+
+rm -f conftest.err
+if ${DRM_CFLAGS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  DRM_CFLAGS=`$PKG_CONFIG --cflags libdrm 2>conftest.err`
 fi
 fi
 
-if ${INOTIFY_LIBS:+false} :
+if ${DRM_LIBS:+false} :
 then :
   if test ${PKG_CONFIG+y}
 then :
-  INOTIFY_LIBS=`$PKG_CONFIG --libs libinotify 2>/dev/null`
+  DRM_LIBS=`$PKG_CONFIG --libs libdrm 2>/dev/null`
 fi
 fi
 
 
-printf "%s\n" "$as_me:${as_lineno-$LINENO}: libinotify cflags: $INOTIFY_CFLAGS" >&5
-printf "%s\n" "$as_me:${as_lineno-$LINENO}: libinotify libs: $INOTIFY_LIBS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: libdrm cflags: $DRM_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: libdrm libs: $DRM_LIBS" >&5
 if test -s conftest.err; then
-     printf %s "$as_me:${as_lineno-$LINENO}: libinotify errors: " >&5
+     printf %s "$as_me:${as_lineno-$LINENO}: libdrm errors: " >&5
      cat conftest.err >&5
 fi
 rm -f conftest.err
 ac_save_CPPFLAGS=$CPPFLAGS
-CPPFLAGS="$CPPFLAGS $INOTIFY_CFLAGS"
-ac_fn_c_check_header_compile "$LINENO" "sys/inotify.h" "ac_cv_header_sys_inotify_h" "$ac_includes_default"
-if test "x$ac_cv_header_sys_inotify_h" = xyes
+CPPFLAGS="$CPPFLAGS $DRM_CFLAGS"
+       for ac_header in xf86drm.h
+do :
+  ac_fn_c_check_header_compile "$LINENO" "xf86drm.h" "ac_cv_header_xf86drm_h" "$ac_includes_default"
+if test "x$ac_cv_header_xf86drm_h" = xyes
 then :
-  printf "%s\n" "#define HAVE_SYS_INOTIFY_H 1" >>confdefs.h
-
-fi
-
-         { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for inotify_add_watch in -linotify" >&5
-printf %s "checking for inotify_add_watch in -linotify... " >&6; }
-if test ${ac_cv_lib_inotify_inotify_add_watch+y}
+  printf "%s\n" "#define HAVE_XF86DRM_H 1" >>confdefs.h
+ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -ldrm" >&5
+printf %s "checking for -ldrm... " >&6; }
+if test ${ac_cv_lib_soname_drm+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-linotify $INOTIFY_LIBS $LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
+LIBS="-ldrm $DRM_LIBS $LIBS"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char inotify_add_watch ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char drmOpen (void);
 int
 main (void)
 {
-return inotify_add_watch ();
+return drmOpen ();
   ;
   return 0;
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_lib_inotify_inotify_add_watch=yes
-else $as_nop
-  ac_cv_lib_inotify_inotify_add_watch=no
+  case "$LIBEXT" in
+    dll) ac_cv_lib_soname_drm=`$ac_cv_path_LDD conftest.exe | grep "drm" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_drm=`$OTOOL -L conftest$ac_exeext | grep "libdrm\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libdrm\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_drm=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libdrm\\.$LIBEXT" | sed -e "s/^.*\\[\\(libdrm\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
+       if ${ac_cv_lib_soname_drm:+false} :
+then :
+  ac_cv_lib_soname_drm=`$LDD conftest$ac_exeext | grep "libdrm\\.$LIBEXT" | sed -e "s/^.*\(libdrm\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
+fi ;;
+  esac
+else case e in #(
+  e) ac_cv_lib_soname_drm= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_inotify_inotify_add_watch" >&5
-printf "%s\n" "$ac_cv_lib_inotify_inotify_add_watch" >&6; }
-if test "x$ac_cv_lib_inotify_inotify_add_watch" = xyes
+if ${ac_cv_lib_soname_drm:+false} :
 then :
-  :
-else $as_nop
-  INOTIFY_LIBS=""
-fi
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
+printf "%s\n" "not found" >&6; }
 
-CPPFLAGS=$ac_save_CPPFLAGS
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_drm" >&5
+printf "%s\n" "$ac_cv_lib_soname_drm" >&6; }
 
-fi
-if test "$ac_cv_header_sys_inotify_h" != "yes"
-then :
-  case "x$with_inotify" in
-  x)   as_fn_append wine_notices "|libinotify ${notice_platform}development files not found (or too old), filesystem change notifications won't be supported." ;;
-  xno) ;;
-  *)   as_fn_error $? "libinotify ${notice_platform}development files not found (or too old), filesystem change notifications won't be supported.
-This is an error since --with-inotify was requested." "$LINENO" 5 ;;
-esac
+printf "%s\n" "#define SONAME_LIBDRM \"$ac_cv_lib_soname_drm\"" >>confdefs.h
 
+        ;;
+esac
+fi
 fi
 
-if test "x$with_dbus" != "xno"
-then
-    rm -f conftest.err
-if ${DBUS_CFLAGS:+false} :
+done
+CPPFLAGS=$ac_save_CPPFLAGS
+
+
+rm -f conftest.err
+if ${DRMAMDGPU_CFLAGS:+false} :
 then :
   if test ${PKG_CONFIG+y}
 then :
-  DBUS_CFLAGS=`$PKG_CONFIG --cflags dbus-1 2>conftest.err`
+  DRMAMDGPU_CFLAGS=`$PKG_CONFIG --cflags libdrm_amdgpu 2>conftest.err`
 fi
 fi
 
-if ${DBUS_LIBS:+false} :
+if ${DRMAMDGPU_LIBS:+false} :
 then :
   if test ${PKG_CONFIG+y}
 then :
-  DBUS_LIBS=`$PKG_CONFIG --libs dbus-1 2>/dev/null`
+  DRMAMDGPU_LIBS=`$PKG_CONFIG --libs libdrm_amdgpu 2>/dev/null`
 fi
 fi
 
 
-printf "%s\n" "$as_me:${as_lineno-$LINENO}: dbus-1 cflags: $DBUS_CFLAGS" >&5
-printf "%s\n" "$as_me:${as_lineno-$LINENO}: dbus-1 libs: $DBUS_LIBS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: libdrm_amdgpu cflags: $DRMAMDGPU_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: libdrm_amdgpu libs: $DRMAMDGPU_LIBS" >&5
 if test -s conftest.err; then
-     printf %s "$as_me:${as_lineno-$LINENO}: dbus-1 errors: " >&5
+     printf %s "$as_me:${as_lineno-$LINENO}: libdrm_amdgpu errors: " >&5
      cat conftest.err >&5
 fi
 rm -f conftest.err
 ac_save_CPPFLAGS=$CPPFLAGS
-CPPFLAGS="$CPPFLAGS $DBUS_CFLAGS"
-ac_fn_c_check_header_compile "$LINENO" "dbus/dbus.h" "ac_cv_header_dbus_dbus_h" "$ac_includes_default"
-if test "x$ac_cv_header_dbus_dbus_h" = xyes
+CPPFLAGS="$CPPFLAGS $DRMAMDGPU_CFLAGS"
+       for ac_header in amdgpu_drm.h
+do :
+  ac_fn_c_check_header_compile "$LINENO" "amdgpu_drm.h" "ac_cv_header_amdgpu_drm_h" "$ac_includes_default"
+if test "x$ac_cv_header_amdgpu_drm_h" = xyes
 then :
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -ldbus-1" >&5
-printf %s "checking for -ldbus-1... " >&6; }
-if test ${ac_cv_lib_soname_dbus_1+y}
+  printf "%s\n" "#define HAVE_AMDGPU_DRM_H 1" >>confdefs.h
+ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -ldrm_amdgpu" >&5
+printf %s "checking for -ldrm_amdgpu... " >&6; }
+if test ${ac_cv_lib_soname_drm_amdgpu+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
-LIBS="-ldbus-1 $DBUS_LIBS $LIBS"
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
+LIBS="-ldrm_amdgpu $DRMAMDGPU_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char dbus_connection_close ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char amdgpu_query_info (void);
 int
 main (void)
 {
-return dbus_connection_close ();
+return amdgpu_query_info ();
   ;
   return 0;
 }
@@ -15904,120 +17718,103 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   case "$LIBEXT" in
-    dll) ac_cv_lib_soname_dbus_1=`$ac_cv_path_LDD conftest.exe | grep "dbus-1" | sed -e "s/dll.*/dll/"';2,$d'` ;;
-    dylib) ac_cv_lib_soname_dbus_1=`$OTOOL -L conftest$ac_exeext | grep "libdbus-1\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libdbus-1\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
-    *) ac_cv_lib_soname_dbus_1=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libdbus-1\\.$LIBEXT" | sed -e "s/^.*\\[\\(libdbus-1\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
-       if ${ac_cv_lib_soname_dbus_1:+false} :
+    dll) ac_cv_lib_soname_drm_amdgpu=`$ac_cv_path_LDD conftest.exe | grep "drm_amdgpu" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_drm_amdgpu=`$OTOOL -L conftest$ac_exeext | grep "libdrm_amdgpu\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libdrm_amdgpu\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_drm_amdgpu=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libdrm_amdgpu\\.$LIBEXT" | sed -e "s/^.*\\[\\(libdrm_amdgpu\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
+       if ${ac_cv_lib_soname_drm_amdgpu:+false} :
 then :
-  ac_cv_lib_soname_dbus_1=`$LDD conftest$ac_exeext | grep "libdbus-1\\.$LIBEXT" | sed -e "s/^.*\(libdbus-1\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
+  ac_cv_lib_soname_drm_amdgpu=`$LDD conftest$ac_exeext | grep "libdrm_amdgpu\\.$LIBEXT" | sed -e "s/^.*\(libdrm_amdgpu\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_dbus_1=
+else case e in #(
+  e) ac_cv_lib_soname_drm_amdgpu= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
-if ${ac_cv_lib_soname_dbus_1:+false} :
+if ${ac_cv_lib_soname_drm_amdgpu:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
-       DBUS_CFLAGS=""
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_dbus_1" >&5
-printf "%s\n" "$ac_cv_lib_soname_dbus_1" >&6; }
 
-printf "%s\n" "#define SONAME_LIBDBUS_1 \"$ac_cv_lib_soname_dbus_1\"" >>confdefs.h
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_drm_amdgpu" >&5
+printf "%s\n" "$ac_cv_lib_soname_drm_amdgpu" >&6; }
 
+printf "%s\n" "#define SONAME_LIBDRM_AMDGPU \"$ac_cv_lib_soname_drm_amdgpu\"" >>confdefs.h
 
+        ;;
+esac
 fi
-else $as_nop
-  DBUS_CFLAGS=""
 fi
 
+done
 CPPFLAGS=$ac_save_CPPFLAGS
 
-fi
-case $host_os in
-  darwin*|macosx*) ;;
-  *) if test "x$ac_cv_lib_soname_dbus_1" = "x"
-then :
-  case "x$with_dbus" in
-  x)   as_fn_append wine_notices "|libdbus ${notice_platform}development files not found, no dynamic device support." ;;
-  xno) ;;
-  *)   as_fn_error $? "libdbus ${notice_platform}development files not found, no dynamic device support.
-This is an error since --with-dbus was requested." "$LINENO" 5 ;;
-esac
-
-fi ;;
-esac
 
 if test "x$with_gnutls" != "xno"
 then
     rm -f conftest.err
-if ${GNUTLS_CFLAGS:+false} :
+if ${GMP_CFLAGS:+false} :
 then :
   if test ${PKG_CONFIG+y}
 then :
-  GNUTLS_CFLAGS=`$PKG_CONFIG --cflags gnutls 2>conftest.err`
+  GMP_CFLAGS=`$PKG_CONFIG --cflags gmp 2>conftest.err`
 fi
 fi
 
-if ${GNUTLS_LIBS:+false} :
+if ${GMP_LIBS:+false} :
 then :
   if test ${PKG_CONFIG+y}
 then :
-  GNUTLS_LIBS=`$PKG_CONFIG --libs gnutls 2>/dev/null`
+  GMP_LIBS=`$PKG_CONFIG --libs gmp 2>/dev/null`
 fi
 fi
 
-GNUTLS_LIBS=${GNUTLS_LIBS:-"-lgnutls"}
-printf "%s\n" "$as_me:${as_lineno-$LINENO}: gnutls cflags: $GNUTLS_CFLAGS" >&5
-printf "%s\n" "$as_me:${as_lineno-$LINENO}: gnutls libs: $GNUTLS_LIBS" >&5
+GMP_LIBS=${GMP_LIBS:-"-lgmp"}
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: gmp cflags: $GMP_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: gmp libs: $GMP_LIBS" >&5
 if test -s conftest.err; then
-     printf %s "$as_me:${as_lineno-$LINENO}: gnutls errors: " >&5
+     printf %s "$as_me:${as_lineno-$LINENO}: gmp errors: " >&5
      cat conftest.err >&5
 fi
 rm -f conftest.err
 ac_save_CPPFLAGS=$CPPFLAGS
-CPPFLAGS="$CPPFLAGS $GNUTLS_CFLAGS"
-ac_fn_c_check_header_compile "$LINENO" "gnutls/gnutls.h" "ac_cv_header_gnutls_gnutls_h" "$ac_includes_default"
-if test "x$ac_cv_header_gnutls_gnutls_h" = xyes
-then :
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <gnutls/gnutls.h>
-#include <gnutls/crypto.h>
-int
-main (void)
-{
-static typeof(gnutls_mac_get_key_size) *func; if (func) return 0;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"
+CPPFLAGS="$CPPFLAGS $GMP_CFLAGS"
+       for ac_header in gmp.h
+do :
+  ac_fn_c_check_header_compile "$LINENO" "gmp.h" "ac_cv_header_gmp_h" "$ac_includes_default"
+if test "x$ac_cv_header_gmp_h" = xyes
 then :
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lgnutls" >&5
-printf %s "checking for -lgnutls... " >&6; }
-if test ${ac_cv_lib_soname_gnutls+y}
+  printf "%s\n" "#define HAVE_GMP_H 1" >>confdefs.h
+ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lgmp" >&5
+printf %s "checking for -lgmp... " >&6; }
+if test ${ac_cv_lib_soname_gmp+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
-LIBS="-lgnutls $GNUTLS_LIBS $LIBS"
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
+LIBS="-lgmp $GMP_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char gnutls_global_init ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char __gmpz_init (void);
 int
 main (void)
 {
-return gnutls_global_init ();
+return __gmpz_init ();
   ;
   return 0;
 }
@@ -16025,68 +17822,42 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   case "$LIBEXT" in
-    dll) ac_cv_lib_soname_gnutls=`$ac_cv_path_LDD conftest.exe | grep "gnutls" | sed -e "s/dll.*/dll/"';2,$d'` ;;
-    dylib) ac_cv_lib_soname_gnutls=`$OTOOL -L conftest$ac_exeext | grep "libgnutls\\(-deb0\\)\\{0,1\\}\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libgnutls\\(-deb0\\)\\{0,1\\}\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
-    *) ac_cv_lib_soname_gnutls=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libgnutls\\(-deb0\\)\\{0,1\\}\\.$LIBEXT" | sed -e "s/^.*\\[\\(libgnutls\\(-deb0\\)\\{0,1\\}\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
-       if ${ac_cv_lib_soname_gnutls:+false} :
+    dll) ac_cv_lib_soname_gmp=`$ac_cv_path_LDD conftest.exe | grep "gmp" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_gmp=`$OTOOL -L conftest$ac_exeext | grep "libgmp-*\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libgmp-*\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_gmp=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libgmp-*\\.$LIBEXT" | sed -e "s/^.*\\[\\(libgmp-*\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
+       if ${ac_cv_lib_soname_gmp:+false} :
 then :
-  ac_cv_lib_soname_gnutls=`$LDD conftest$ac_exeext | grep "libgnutls\\(-deb0\\)\\{0,1\\}\\.$LIBEXT" | sed -e "s/^.*\(libgnutls\\(-deb0\\)\\{0,1\\}\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
+  ac_cv_lib_soname_gmp=`$LDD conftest$ac_exeext | grep "libgmp-*\\.$LIBEXT" | sed -e "s/^.*\(libgmp-*\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_gnutls=
+else case e in #(
+  e) ac_cv_lib_soname_gmp= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
-if ${ac_cv_lib_soname_gnutls:+false} :
+if ${ac_cv_lib_soname_gmp:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
-       GNUTLS_CFLAGS=""
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_gnutls" >&5
-printf "%s\n" "$ac_cv_lib_soname_gnutls" >&6; }
-
-printf "%s\n" "#define SONAME_LIBGNUTLS \"$ac_cv_lib_soname_gnutls\"" >>confdefs.h
+       GMP_CFLAGS=""
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_gmp" >&5
+printf "%s\n" "$ac_cv_lib_soname_gmp" >&6; }
 
+printf "%s\n" "#define SONAME_LIBGMP \"$ac_cv_lib_soname_gmp\"" >>confdefs.h
 
+        ;;
+esac
 fi
-                 ac_wine_check_funcs_save_LIBS="$LIBS"
-LIBS="$LIBS $GNUTLS_LIBS"
-
-  for ac_func in gnutls_cipher_init
-do :
-  ac_fn_c_check_func "$LINENO" "gnutls_cipher_init" "ac_cv_func_gnutls_cipher_init"
-if test "x$ac_cv_func_gnutls_cipher_init" = xyes
-then :
-  printf "%s\n" "#define HAVE_GNUTLS_CIPHER_INIT 1" >>confdefs.h
-
-else $as_nop
-  as_fn_append wine_notices "|libgnutls ${notice_platform}development files too old, bcrypt encryption won't be supported."
 fi
 
 done
-LIBS="$ac_wine_check_funcs_save_LIBS"
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-else $as_nop
-  GNUTLS_CFLAGS=""
-fi
-
 CPPFLAGS=$ac_save_CPPFLAGS
 
-fi
-if test "x$ac_cv_lib_soname_gnutls" = "x"
-then :
-  case "x$with_gnutls" in
-  x)   as_fn_append wine_warnings "|libgnutls ${notice_platform}development files not found, no schannel support." ;;
-  xno) ;;
-  *)   as_fn_error $? "libgnutls ${notice_platform}development files not found, no schannel support.
-This is an error since --with-gnutls was requested." "$LINENO" 5 ;;
-esac
-
 fi
 
 if test "x$with_sane" != "xno"
@@ -16126,16 +17897,22 @@ printf %s "checking for sane_init in -lsane... " >&6; }
 if test ${ac_cv_lib_sane_sane_init+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lsane $SANE_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char sane_init ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char sane_init (void);
 int
 main (void)
 {
@@ -16147,12 +17924,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_sane_sane_init=yes
-else $as_nop
-  ac_cv_lib_sane_sane_init=no
+else case e in #(
+  e) ac_cv_lib_sane_sane_init=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_sane_sane_init" >&5
 printf "%s\n" "$ac_cv_lib_sane_sane_init" >&6; }
@@ -16214,16 +17993,22 @@ printf %s "checking for libusb_interrupt_event_handler in -lusb-1.0... " >&6; }
 if test ${ac_cv_lib_usb_1_0_libusb_interrupt_event_handler+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lusb-1.0 $USB_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char libusb_interrupt_event_handler ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char libusb_interrupt_event_handler (void);
 int
 main (void)
 {
@@ -16235,24 +18020,28 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_usb_1_0_libusb_interrupt_event_handler=yes
-else $as_nop
-  ac_cv_lib_usb_1_0_libusb_interrupt_event_handler=no
+else case e in #(
+  e) ac_cv_lib_usb_1_0_libusb_interrupt_event_handler=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_usb_1_0_libusb_interrupt_event_handler" >&5
 printf "%s\n" "$ac_cv_lib_usb_1_0_libusb_interrupt_event_handler" >&6; }
 if test "x$ac_cv_lib_usb_1_0_libusb_interrupt_event_handler" = xyes
 then :
   :
-else $as_nop
-  USB_LIBS=""
+else case e in #(
+  e) USB_LIBS="" ;;
+esac
 fi
 
-else $as_nop
-  USB_LIBS=""
+else case e in #(
+  e) USB_LIBS="" ;;
+esac
 fi
 
 CPPFLAGS=$ac_save_CPPFLAGS
@@ -16276,16 +18065,22 @@ printf %s "checking for -lv4l2... " >&6; }
 if test ${ac_cv_lib_soname_v4l2+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lv4l2  $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char v4l2_open ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char v4l2_open (void);
 int
 main (void)
 {
@@ -16305,25 +18100,28 @@ then :
   ac_cv_lib_soname_v4l2=`$LDD conftest$ac_exeext | grep "libv4l2\\.$LIBEXT" | sed -e "s/^.*\(libv4l2\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_v4l2=
+else case e in #(
+  e) ac_cv_lib_soname_v4l2= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_v4l2:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_v4l2" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_v4l2" >&5
 printf "%s\n" "$ac_cv_lib_soname_v4l2" >&6; }
 
 printf "%s\n" "#define SONAME_LIBV4L2 \"$ac_cv_lib_soname_v4l2\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
 fi
 if test "x$ac_cv_lib_soname_v4l2" = "x"
@@ -16374,16 +18172,22 @@ printf %s "checking for gp_camera_new in -lgphoto2... " >&6; }
 if test ${ac_cv_lib_gphoto2_gp_camera_new+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lgphoto2 $GPHOTO2_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char gp_camera_new ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gp_camera_new (void);
 int
 main (void)
 {
@@ -16395,12 +18199,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_gphoto2_gp_camera_new=yes
-else $as_nop
-  ac_cv_lib_gphoto2_gp_camera_new=no
+else case e in #(
+  e) ac_cv_lib_gphoto2_gp_camera_new=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_gphoto2_gp_camera_new" >&5
 printf "%s\n" "$ac_cv_lib_gphoto2_gp_camera_new" >&6; }
@@ -16448,16 +18254,22 @@ printf %s "checking for gp_port_info_list_new in -lgphoto2_port... " >&6; }
 if test ${ac_cv_lib_gphoto2_port_gp_port_info_list_new+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lgphoto2_port $GPHOTO2_PORT_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char gp_port_info_list_new ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gp_port_info_list_new (void);
 int
 main (void)
 {
@@ -16469,12 +18281,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_gphoto2_port_gp_port_info_list_new=yes
-else $as_nop
-  ac_cv_lib_gphoto2_port_gp_port_info_list_new=no
+else case e in #(
+  e) ac_cv_lib_gphoto2_port_gp_port_info_list_new=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_gphoto2_port_gp_port_info_list_new" >&5
 printf "%s\n" "$ac_cv_lib_gphoto2_port_gp_port_info_list_new" >&6; }
@@ -16483,12 +18297,14 @@ then :
 
 printf "%s\n" "#define HAVE_GPHOTO2_PORT 1" >>confdefs.h
 
-else $as_nop
-  GPHOTO2_PORT_LIBS=""; GPHOTO2_PORT_CFLAGS=""
+else case e in #(
+  e) GPHOTO2_PORT_LIBS=""; GPHOTO2_PORT_CFLAGS="" ;;
+esac
 fi
 
-else $as_nop
-  GPHOTO2_PORT_LIBS=""; GPHOTO2_PORT_CFLAGS=""
+else case e in #(
+  e) GPHOTO2_PORT_LIBS=""; GPHOTO2_PORT_CFLAGS="" ;;
+esac
 fi
 
 CPPFLAGS=$ac_save_CPPFLAGS
@@ -16523,8 +18339,8 @@ printf %s "checking for resolver library... " >&6; }
 if test ${ac_cv_have_resolv+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_save_LIBS="$LIBS"
+else case e in #(
+  e) ac_save_LIBS="$LIBS"
        for lib in '' -lresolv
        do
          LIBS="$lib $ac_save_LIBS"
@@ -16545,14 +18361,16 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_have_resolv=${lib:-"none required"}
-else $as_nop
-  ac_cv_have_resolv="not found"
+else case e in #(
+  e) ac_cv_have_resolv="not found" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
          test "x$ac_cv_have_resolv" = "xnot found" || break
        done
-       LIBS="$ac_save_LIBS"
+       LIBS="$ac_save_LIBS" ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_have_resolv" >&5
 printf "%s\n" "$ac_cv_have_resolv" >&6; }
@@ -16577,8 +18395,8 @@ printf %s "checking for res_getservers... " >&6; }
 if test ${ac_cv_have_res_getservers+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_save_LIBS="$LIBS"
+else case e in #(
+  e) ac_save_LIBS="$LIBS"
                         LIBS="$RESOLV_LIBS $LIBS"
                         cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -16594,12 +18412,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_have_res_getservers=yes
-else $as_nop
-  ac_cv_have_res_getservers=no
+else case e in #(
+  e) ac_cv_have_res_getservers=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-	                 LIBS="$ac_save_LIBS"
+	                 LIBS="$ac_save_LIBS" ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_have_res_getservers" >&5
 printf "%s\n" "$ac_cv_have_res_getservers" >&6; }
@@ -16655,16 +18475,22 @@ printf %s "checking for -lfreetype... " >&6; }
 if test ${ac_cv_lib_soname_freetype+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lfreetype $FREETYPE_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char FT_Init_FreeType ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char FT_Init_FreeType (void);
 int
 main (void)
 {
@@ -16684,20 +18510,22 @@ then :
   ac_cv_lib_soname_freetype=`$LDD conftest$ac_exeext | grep "libfreetype\\.$LIBEXT" | sed -e "s/^.*\(libfreetype\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_freetype=
+else case e in #(
+  e) ac_cv_lib_soname_freetype= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_freetype:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
        FREETYPE_LIBS=""
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_freetype" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_freetype" >&5
 printf "%s\n" "$ac_cv_lib_soname_freetype" >&6; }
 
 printf "%s\n" "#define SONAME_LIBFREETYPE \"$ac_cv_lib_soname_freetype\"" >>confdefs.h
@@ -16715,7 +18543,8 @@ printf "%s\n" "#define HAVE_FT_TRUETYPEENGINETYPE 1" >>confdefs.h
 
 
 fi
-
+ ;;
+esac
 fi
         else
             FREETYPE_CFLAGS=""
@@ -16754,16 +18583,22 @@ printf %s "checking for po_message_msgctxt in -lgettextpo... " >&6; }
 if test ${ac_cv_lib_gettextpo_po_message_msgctxt+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lgettextpo  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char po_message_msgctxt ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char po_message_msgctxt (void);
 int
 main (void)
 {
@@ -16775,12 +18610,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_gettextpo_po_message_msgctxt=yes
-else $as_nop
-  ac_cv_lib_gettextpo_po_message_msgctxt=no
+else case e in #(
+  e) ac_cv_lib_gettextpo_po_message_msgctxt=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_gettextpo_po_message_msgctxt" >&5
 printf "%s\n" "$ac_cv_lib_gettextpo_po_message_msgctxt" >&6; }
@@ -16845,27 +18682,30 @@ fi
 rm -f conftest.err
 ac_save_CPPFLAGS=$CPPFLAGS
 CPPFLAGS="$CPPFLAGS $PULSE_CFLAGS"
-       for ac_header in pulse/pulseaudio.h
-do :
-  ac_fn_c_check_header_compile "$LINENO" "pulse/pulseaudio.h" "ac_cv_header_pulse_pulseaudio_h" "$ac_includes_default"
+ac_fn_c_check_header_compile "$LINENO" "pulse/pulseaudio.h" "ac_cv_header_pulse_pulseaudio_h" "$ac_includes_default"
 if test "x$ac_cv_header_pulse_pulseaudio_h" = xyes
 then :
-  printf "%s\n" "#define HAVE_PULSE_PULSEAUDIO_H 1" >>confdefs.h
- { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pa_stream_is_corked in -lpulse" >&5
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pa_stream_is_corked in -lpulse" >&5
 printf %s "checking for pa_stream_is_corked in -lpulse... " >&6; }
 if test ${ac_cv_lib_pulse_pa_stream_is_corked+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lpulse $PULSE_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char pa_stream_is_corked ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char pa_stream_is_corked (void);
 int
 main (void)
 {
@@ -16877,27 +18717,30 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_pulse_pa_stream_is_corked=yes
-else $as_nop
-  ac_cv_lib_pulse_pa_stream_is_corked=no
+else case e in #(
+  e) ac_cv_lib_pulse_pa_stream_is_corked=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pulse_pa_stream_is_corked" >&5
 printf "%s\n" "$ac_cv_lib_pulse_pa_stream_is_corked" >&6; }
 if test "x$ac_cv_lib_pulse_pa_stream_is_corked" = xyes
 then :
   :
-else $as_nop
-  PULSE_LIBS=""
+else case e in #(
+  e) PULSE_LIBS="" ;;
+esac
 fi
 
-else $as_nop
-  PULSE_LIBS=""
+else case e in #(
+  e) PULSE_LIBS="" ;;
+esac
 fi
 
-done
 CPPFLAGS=$ac_save_CPPFLAGS
 
 fi
@@ -16919,7 +18762,7 @@ if ${GSTREAMER_CFLAGS:+false} :
 then :
   if test ${PKG_CONFIG+y}
 then :
-  GSTREAMER_CFLAGS=`$PKG_CONFIG --cflags gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 2>conftest.err`
+  GSTREAMER_CFLAGS=`$PKG_CONFIG --cflags gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 gstreamer-tag-1.0 gstreamer-gl-1.0 2>conftest.err`
 fi
 fi
 
@@ -16927,15 +18770,15 @@ if ${GSTREAMER_LIBS:+false} :
 then :
   if test ${PKG_CONFIG+y}
 then :
-  GSTREAMER_LIBS=`$PKG_CONFIG --libs gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 2>/dev/null`
+  GSTREAMER_LIBS=`$PKG_CONFIG --libs gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 gstreamer-tag-1.0 gstreamer-gl-1.0 2>/dev/null`
 fi
 fi
 
 
-printf "%s\n" "$as_me:${as_lineno-$LINENO}: gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 cflags: $GSTREAMER_CFLAGS" >&5
-printf "%s\n" "$as_me:${as_lineno-$LINENO}: gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 libs: $GSTREAMER_LIBS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 gstreamer-tag-1.0 gstreamer-gl-1.0 cflags: $GSTREAMER_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 gstreamer-tag-1.0 gstreamer-gl-1.0 libs: $GSTREAMER_LIBS" >&5
 if test -s conftest.err; then
-     printf %s "$as_me:${as_lineno-$LINENO}: gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 errors: " >&5
+     printf %s "$as_me:${as_lineno-$LINENO}: gstreamer-1.0 gstreamer-video-1.0 gstreamer-audio-1.0 gstreamer-tag-1.0 gstreamer-gl-1.0 errors: " >&5
      cat conftest.err >&5
 fi
 rm -f conftest.err
@@ -16966,16 +18809,22 @@ printf %s "checking for gst_pad_new in -lgstreamer-1.0... " >&6; }
 if test ${ac_cv_lib_gstreamer_1_0_gst_pad_new+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lgstreamer-1.0 $GSTREAMER_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char gst_pad_new ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gst_pad_new (void);
 int
 main (void)
 {
@@ -16987,12 +18836,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_gstreamer_1_0_gst_pad_new=yes
-else $as_nop
-  ac_cv_lib_gstreamer_1_0_gst_pad_new=no
+else case e in #(
+  e) ac_cv_lib_gstreamer_1_0_gst_pad_new=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_gstreamer_1_0_gst_pad_new" >&5
 printf "%s\n" "$ac_cv_lib_gstreamer_1_0_gst_pad_new" >&6; }
@@ -17001,11 +18852,13 @@ then :
   :
 fi
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
 printf "%s\n" "no" >&6; }
                  ac_glib2_broken=yes
-                 as_fn_append wine_notices "|glib-2.0 pkgconfig configuration is for the wrong architecture, winegstreamer won't be built."
+                 enable_winegstreamer=${enable_winegstreamer:-no}
+                 as_fn_append wine_notices "|glib-2.0 pkgconfig configuration is for the wrong architecture, winegstreamer won't be built." ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
 fi
@@ -17033,16 +18886,22 @@ printf %s "checking for snd_pcm_hw_params_get_access_mask in -lasound... " >&6;
 if test ${ac_cv_lib_asound_snd_pcm_hw_params_get_access_mask+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lasound  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char snd_pcm_hw_params_get_access_mask ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char snd_pcm_hw_params_get_access_mask (void);
 int
 main (void)
 {
@@ -17054,12 +18913,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_asound_snd_pcm_hw_params_get_access_mask=yes
-else $as_nop
-  ac_cv_lib_asound_snd_pcm_hw_params_get_access_mask=no
+else case e in #(
+  e) ac_cv_lib_asound_snd_pcm_hw_params_get_access_mask=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_asound_snd_pcm_hw_params_get_access_mask" >&5
 printf "%s\n" "$ac_cv_lib_asound_snd_pcm_hw_params_get_access_mask" >&6; }
@@ -17112,16 +18973,22 @@ printf %s "checking for _oss_ioctl in -lossaudio... " >&6; }
 if test ${ac_cv_lib_ossaudio__oss_ioctl+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lossaudio  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char _oss_ioctl ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char _oss_ioctl (void);
 int
 main (void)
 {
@@ -17133,12 +19000,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_ossaudio__oss_ioctl=yes
-else $as_nop
-  ac_cv_lib_ossaudio__oss_ioctl=no
+else case e in #(
+  e) ac_cv_lib_ossaudio__oss_ioctl=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_ossaudio__oss_ioctl" >&5
 printf "%s\n" "$ac_cv_lib_ossaudio__oss_ioctl" >&6; }
@@ -17205,16 +19074,22 @@ printf %s "checking for udev_new in -ludev... " >&6; }
 if test ${ac_cv_lib_udev_udev_new+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-ludev $UDEV_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char udev_new ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char udev_new (void);
 int
 main (void)
 {
@@ -17226,12 +19101,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_udev_udev_new=yes
-else $as_nop
-  ac_cv_lib_udev_udev_new=no
+else case e in #(
+  e) ac_cv_lib_udev_udev_new=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_udev_udev_new" >&5
 printf "%s\n" "$ac_cv_lib_udev_udev_new" >&6; }
@@ -17240,12 +19117,14 @@ then :
 
 printf "%s\n" "#define HAVE_UDEV 1" >>confdefs.h
 
-else $as_nop
-  UDEV_LIBS=""
+else case e in #(
+  e) UDEV_LIBS="" ;;
+esac
 fi
 
-else $as_nop
-  UDEV_LIBS=""
+else case e in #(
+  e) UDEV_LIBS="" ;;
+esac
 fi
 
 done
@@ -17297,8 +19176,8 @@ printf %s "checking for unw_step... " >&6; }
 if test ${wine_cv_have_unw_step+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #define UNW_LOCAL_ONLY
 #include <libunwind.h>
@@ -17313,11 +19192,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   wine_cv_have_unw_step="yes"
-else $as_nop
-  wine_cv_have_unw_step="no"
+else case e in #(
+  e) wine_cv_have_unw_step="no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_have_unw_step" >&5
 printf "%s\n" "$wine_cv_have_unw_step" >&6; }
@@ -17331,8 +19212,8 @@ printf %s "checking for unw_step in libunwind... " >&6; }
 if test ${wine_cv_have_libunwind_unw_step+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #define UNW_LOCAL_ONLY
 #include <libunwind.h>
@@ -17347,11 +19228,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   wine_cv_have_libunwind_unw_step="yes"
-else $as_nop
-  wine_cv_have_libunwind_unw_step="no"
+else case e in #(
+  e) wine_cv_have_libunwind_unw_step="no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_have_libunwind_unw_step" >&5
 printf "%s\n" "$wine_cv_have_libunwind_unw_step" >&6; }
@@ -17421,16 +19304,22 @@ printf %s "checking for -lSDL2... " >&6; }
 if test ${ac_cv_lib_soname_SDL2+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lSDL2 $SDL2_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char SDL_Init ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char SDL_Init (void);
 int
 main (void)
 {
@@ -17450,25 +19339,28 @@ then :
   ac_cv_lib_soname_SDL2=`$LDD conftest$ac_exeext | grep "libSDL2-2.0*\\.$LIBEXT" | sed -e "s/^.*\(libSDL2-2.0*\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_SDL2=
+else case e in #(
+  e) ac_cv_lib_soname_SDL2= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_SDL2:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_SDL2" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_SDL2" >&5
 printf "%s\n" "$ac_cv_lib_soname_SDL2" >&6; }
 
 printf "%s\n" "#define SONAME_LIBSDL2 \"$ac_cv_lib_soname_SDL2\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
 fi
 
@@ -17538,16 +19430,22 @@ printf %s "checking for capi20_register in -lcapi20... " >&6; }
 if test ${ac_cv_lib_capi20_capi20_register+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lcapi20 $CAPI20_LIBS $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char capi20_register ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char capi20_register (void);
 int
 main (void)
 {
@@ -17559,20 +19457,23 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_capi20_capi20_register=yes
-else $as_nop
-  ac_cv_lib_capi20_capi20_register=no
+else case e in #(
+  e) ac_cv_lib_capi20_capi20_register=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_capi20_capi20_register" >&5
 printf "%s\n" "$ac_cv_lib_capi20_capi20_register" >&6; }
 if test "x$ac_cv_lib_capi20_capi20_register" = xyes
 then :
   :
-else $as_nop
-  CAPI20_LIBS=""
+else case e in #(
+  e) CAPI20_LIBS="" ;;
+esac
 fi
 
     fi
@@ -17639,16 +19540,22 @@ printf %s "checking for -lcups... " >&6; }
 if test ${ac_cv_lib_soname_cups+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lcups $CUPS_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char cupsGetDefault ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char cupsGetDefault (void);
 int
 main (void)
 {
@@ -17668,25 +19575,28 @@ then :
   ac_cv_lib_soname_cups=`$LDD conftest$ac_exeext | grep "libcups\\.$LIBEXT" | sed -e "s/^.*\(libcups\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_cups=
+else case e in #(
+  e) ac_cv_lib_soname_cups= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_cups:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
        CUPS_LIBS=""
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_cups" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_cups" >&5
 printf "%s\n" "$ac_cv_lib_soname_cups" >&6; }
 
 printf "%s\n" "#define SONAME_LIBCUPS \"$ac_cv_lib_soname_cups\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
                         else
                             CUPS_CFLAGS=""
@@ -17738,27 +19648,27 @@ CPPFLAGS="$CPPFLAGS $FONTCONFIG_CFLAGS"
 ac_fn_c_check_header_compile "$LINENO" "fontconfig/fontconfig.h" "ac_cv_header_fontconfig_fontconfig_h" "$ac_includes_default"
 if test "x$ac_cv_header_fontconfig_fontconfig_h" = xyes
 then :
-  printf "%s\n" "#define HAVE_FONTCONFIG_FONTCONFIG_H 1" >>confdefs.h
-
-fi
-
-        if test "$ac_cv_header_fontconfig_fontconfig_h" = "yes"
-        then
-            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lfontconfig" >&5
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lfontconfig" >&5
 printf %s "checking for -lfontconfig... " >&6; }
 if test ${ac_cv_lib_soname_fontconfig+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lfontconfig $FONTCONFIG_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char FcInit ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char FcInit (void);
 int
 main (void)
 {
@@ -17778,29 +19688,34 @@ then :
   ac_cv_lib_soname_fontconfig=`$LDD conftest$ac_exeext | grep "libfontconfig\\.$LIBEXT" | sed -e "s/^.*\(libfontconfig\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_fontconfig=
+else case e in #(
+  e) ac_cv_lib_soname_fontconfig= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_fontconfig:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
        FONTCONFIG_CFLAGS=""
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_fontconfig" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_fontconfig" >&5
 printf "%s\n" "$ac_cv_lib_soname_fontconfig" >&6; }
 
 printf "%s\n" "#define SONAME_LIBFONTCONFIG \"$ac_cv_lib_soname_fontconfig\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
-        else
-            FONTCONFIG_CFLAGS=""
-        fi
+else case e in #(
+  e) FONTCONFIG_CFLAGS="" ;;
+esac
+fi
+
 CPPFLAGS=$ac_save_CPPFLAGS
 
 fi
@@ -17858,16 +19773,22 @@ printf %s "checking for -lkrb5... " >&6; }
 if test ${ac_cv_lib_soname_krb5+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lkrb5 $KRB5_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char krb5_is_config_principal ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char krb5_is_config_principal (void);
 int
 main (void)
 {
@@ -17887,25 +19808,28 @@ then :
   ac_cv_lib_soname_krb5=`$LDD conftest$ac_exeext | grep "libkrb5\\.$LIBEXT" | sed -e "s/^.*\(libkrb5\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_krb5=
+else case e in #(
+  e) ac_cv_lib_soname_krb5= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_krb5:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
        KRB5_CFLAGS=""
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_krb5" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_krb5" >&5
 printf "%s\n" "$ac_cv_lib_soname_krb5" >&6; }
 
 printf "%s\n" "#define SONAME_LIBKRB5 \"$ac_cv_lib_soname_krb5\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
          else
              KRB5_CFLAGS=""
@@ -17974,16 +19898,22 @@ printf %s "checking for -lgssapi_krb5... " >&6; }
 if test ${ac_cv_lib_soname_gssapi_krb5+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lgssapi_krb5 $GSSAPI_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char gss_init_sec_context ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gss_init_sec_context (void);
 int
 main (void)
 {
@@ -18003,25 +19933,28 @@ then :
   ac_cv_lib_soname_gssapi_krb5=`$LDD conftest$ac_exeext | grep "libgssapi_krb5\\.$LIBEXT" | sed -e "s/^.*\(libgssapi_krb5\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_gssapi_krb5=
+else case e in #(
+  e) ac_cv_lib_soname_gssapi_krb5= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_gssapi_krb5:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
        GSSAPI_CFLAGS=""
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_gssapi_krb5" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_gssapi_krb5" >&5
 printf "%s\n" "$ac_cv_lib_soname_gssapi_krb5" >&6; }
 
 printf "%s\n" "#define SONAME_LIBGSSAPI_KRB5 \"$ac_cv_lib_soname_gssapi_krb5\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
         else
             GSSAPI_CFLAGS=""
@@ -18047,16 +19980,22 @@ printf %s "checking for procstat_open_sysctl in -lprocstat... " >&6; }
 if test ${ac_cv_lib_procstat_procstat_open_sysctl+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_lib_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_lib_save_LIBS=$LIBS
 LIBS="-lprocstat  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char procstat_open_sysctl ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char procstat_open_sysctl (void);
 int
 main (void)
 {
@@ -18068,12 +20007,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_procstat_procstat_open_sysctl=yes
-else $as_nop
-  ac_cv_lib_procstat_procstat_open_sysctl=no
+else case e in #(
+  e) ac_cv_lib_procstat_procstat_open_sysctl=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+LIBS=$ac_check_lib_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_procstat_procstat_open_sysctl" >&5
 printf "%s\n" "$ac_cv_lib_procstat_procstat_open_sysctl" >&6; }
@@ -18093,16 +20034,22 @@ printf %s "checking for -lodbc... " >&6; }
 if test ${ac_cv_lib_soname_odbc+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lodbc  $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char SQLConnect ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char SQLConnect (void);
 int
 main (void)
 {
@@ -18122,12 +20069,14 @@ then :
   ac_cv_lib_soname_odbc=`$LDD conftest$ac_exeext | grep "libodbc\\.$LIBEXT" | sed -e "s/^.*\(libodbc\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_odbc=
+else case e in #(
+  e) ac_cv_lib_soname_odbc= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_odbc:+false} :
 then :
@@ -18135,13 +20084,14 @@ then :
 printf "%s\n" "not found" >&6; }
        printf "%s\n" "#define SONAME_LIBODBC \"libodbc.$LIBEXT\"" >>confdefs.h
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_odbc" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_odbc" >&5
 printf "%s\n" "$ac_cv_lib_soname_odbc" >&6; }
 
 printf "%s\n" "#define SONAME_LIBODBC \"$ac_cv_lib_soname_odbc\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
 
 if test "x$with_netapi" != "xno"
@@ -18178,16 +20128,22 @@ printf %s "checking for -lnetapi... " >&6; }
 if test ${ac_cv_lib_soname_netapi+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lnetapi $NETAPI_LIBS $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char libnetapi_init ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char libnetapi_init (void);
 int
 main (void)
 {
@@ -18207,12 +20163,14 @@ then :
   ac_cv_lib_soname_netapi=`$LDD conftest$ac_exeext | grep "libnetapi\\.$LIBEXT" | sed -e "s/^.*\(libnetapi\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_netapi=
+else case e in #(
+  e) ac_cv_lib_soname_netapi= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_netapi:+false} :
 then :
@@ -18220,13 +20178,14 @@ then :
 printf "%s\n" "not found" >&6; }
        printf "%s\n" "#define SONAME_LIBNETAPI \"libnetapi.$LIBEXT\"" >>confdefs.h
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_netapi" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_netapi" >&5
 printf "%s\n" "$ac_cv_lib_soname_netapi" >&6; }
 
 printf "%s\n" "#define SONAME_LIBNETAPI \"$ac_cv_lib_soname_netapi\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
 CPPFLAGS=$ac_save_CPPFLAGS
 
@@ -18249,6 +20208,83 @@ then
     as_fn_append wine_warnings "|No sound system was found. Windows applications will be silent."
 fi
 
+if test x$with_vosk != xno
+then
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lvosk" >&5
+printf %s "checking for -lvosk... " >&6; }
+if test ${ac_cv_lib_soname_vosk+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
+LIBS="-lvosk  $LIBS"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char vosk_recognizer_new (void);
+int
+main (void)
+{
+return vosk_recognizer_new ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  case "$LIBEXT" in
+    dll) ac_cv_lib_soname_vosk=`$ac_cv_path_LDD conftest.exe | grep "vosk" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_vosk=`$OTOOL -L conftest$ac_exeext | grep "libvosk\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libvosk\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_vosk=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libvosk\\.$LIBEXT" | sed -e "s/^.*\\[\\(libvosk\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
+       if ${ac_cv_lib_soname_vosk:+false} :
+then :
+  ac_cv_lib_soname_vosk=`$LDD conftest$ac_exeext | grep "libvosk\\.$LIBEXT" | sed -e "s/^.*\(libvosk\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
+fi ;;
+  esac
+else case e in #(
+  e) ac_cv_lib_soname_vosk= ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
+fi
+if ${ac_cv_lib_soname_vosk:+false} :
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
+printf "%s\n" "not found" >&6; }
+
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_vosk" >&5
+printf "%s\n" "$ac_cv_lib_soname_vosk" >&6; }
+
+printf "%s\n" "#define SONAME_LIBVOSK \"$ac_cv_lib_soname_vosk\"" >>confdefs.h
+
+        ;;
+esac
+fi
+fi
+if test x$ac_cv_lib_soname_vosk = x
+then :
+  case "x$with_vosk" in
+  x)   as_fn_append wine_notices "|libvosk ${notice_platform}development files not found, speech recognition won't be supported." ;;
+  xno) ;;
+  *)   as_fn_error $? "libvosk ${notice_platform}development files not found, speech recognition won't be supported.
+This is an error since --with-vosk was requested." "$LINENO" 5 ;;
+esac
+
+fi
+
 if test "x$with_vulkan" != "xno"
 then
     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lvulkan" >&5
@@ -18256,16 +20292,22 @@ printf %s "checking for -lvulkan... " >&6; }
 if test ${ac_cv_lib_soname_vulkan+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lvulkan  $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char vkGetInstanceProcAddr ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char vkGetInstanceProcAddr (void);
 int
 main (void)
 {
@@ -18285,25 +20327,28 @@ then :
   ac_cv_lib_soname_vulkan=`$LDD conftest$ac_exeext | grep "libvulkan\\.$LIBEXT" | sed -e "s/^.*\(libvulkan\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_vulkan=
+else case e in #(
+  e) ac_cv_lib_soname_vulkan= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
 if ${ac_cv_lib_soname_vulkan:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_vulkan" >&5
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_vulkan" >&5
 printf "%s\n" "$ac_cv_lib_soname_vulkan" >&6; }
 
 printf "%s\n" "#define SONAME_LIBVULKAN \"$ac_cv_lib_soname_vulkan\"" >>confdefs.h
 
-
+        ;;
+esac
 fi
     if test "x$ac_cv_lib_soname_vulkan" = "x"
     then
@@ -18312,20 +20357,140 @@ printf %s "checking for -lMoltenVK... " >&6; }
 if test ${ac_cv_lib_soname_MoltenVK+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_check_soname_save_LIBS=$LIBS
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
 LIBS="-lMoltenVK  $LIBS"
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char vkGetInstanceProcAddr ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char vkGetInstanceProcAddr (void);
+int
+main (void)
+{
+return vkGetInstanceProcAddr ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  case "$LIBEXT" in
+    dll) ac_cv_lib_soname_MoltenVK=`$ac_cv_path_LDD conftest.exe | grep "MoltenVK" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_MoltenVK=`$OTOOL -L conftest$ac_exeext | grep "libMoltenVK\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libMoltenVK\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_MoltenVK=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libMoltenVK\\.$LIBEXT" | sed -e "s/^.*\\[\\(libMoltenVK\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
+       if ${ac_cv_lib_soname_MoltenVK:+false} :
+then :
+  ac_cv_lib_soname_MoltenVK=`$LDD conftest$ac_exeext | grep "libMoltenVK\\.$LIBEXT" | sed -e "s/^.*\(libMoltenVK\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
+fi ;;
+  esac
+else case e in #(
+  e) ac_cv_lib_soname_MoltenVK= ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
+fi
+if ${ac_cv_lib_soname_MoltenVK:+false} :
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
+printf "%s\n" "not found" >&6; }
+
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_MoltenVK" >&5
+printf "%s\n" "$ac_cv_lib_soname_MoltenVK" >&6; }
+
+printf "%s\n" "#define SONAME_LIBMOLTENVK \"$ac_cv_lib_soname_MoltenVK\"" >>confdefs.h
+
+        ;;
+esac
+fi
+    fi
+fi
+if test "x$ac_cv_lib_soname_vulkan" = "x" -a "x$ac_cv_lib_soname_MoltenVK" = "x"
+then :
+  case "x$with_vulkan" in
+  x)   as_fn_append wine_notices "|libvulkan and libMoltenVK ${notice_platform}development files not found, Vulkan won't be supported." ;;
+  xno) ;;
+  *)   as_fn_error $? "libvulkan and libMoltenVK ${notice_platform}development files not found, Vulkan won't be supported.
+This is an error since --with-vulkan was requested." "$LINENO" 5 ;;
+esac
+
+fi
+
+if test "x$with_gcrypt" != "xno"
+then
+    rm -f conftest.err
+if ${GCRYPT_CFLAGS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  GCRYPT_CFLAGS=`$PKG_CONFIG --cflags libgcrypt 2>conftest.err`
+fi
+fi
+
+if ${GCRYPT_LIBS:+false} :
+then :
+  if test ${PKG_CONFIG+y}
+then :
+  GCRYPT_LIBS=`$PKG_CONFIG --libs libgcrypt 2>/dev/null`
+fi
+fi
+
+
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: libgcrypt cflags: $GCRYPT_CFLAGS" >&5
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: libgcrypt libs: $GCRYPT_LIBS" >&5
+if test -s conftest.err; then
+     printf %s "$as_me:${as_lineno-$LINENO}: libgcrypt errors: " >&5
+     cat conftest.err >&5
+fi
+rm -f conftest.err
+ac_save_CPPFLAGS=$CPPFLAGS
+CPPFLAGS="$CPPFLAGS $GCRYPT_CFLAGS"
+ac_fn_c_check_header_compile "$LINENO" "gcrypt.h" "ac_cv_header_gcrypt_h" "$ac_includes_default"
+if test "x$ac_cv_header_gcrypt_h" = xyes
+then :
+  printf "%s\n" "#define HAVE_GCRYPT_H 1" >>confdefs.h
+
+fi
+
+        if test "$ac_cv_header_gcrypt_h" = "yes"
+        then
+            { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for -lgcrypt" >&5
+printf %s "checking for -lgcrypt... " >&6; }
+if test ${ac_cv_lib_soname_gcrypt+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_check_soname_save_LIBS=$LIBS
+LIBS="-lgcrypt $GCRYPT_LIBS $LIBS"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gcry_sexp_build (void);
 int
 main (void)
 {
-return vkGetInstanceProcAddr ();
+return gcry_sexp_build ();
   ;
   return 0;
 }
@@ -18333,43 +20498,48 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   case "$LIBEXT" in
-    dll) ac_cv_lib_soname_MoltenVK=`$ac_cv_path_LDD conftest.exe | grep "MoltenVK" | sed -e "s/dll.*/dll/"';2,$d'` ;;
-    dylib) ac_cv_lib_soname_MoltenVK=`$OTOOL -L conftest$ac_exeext | grep "libMoltenVK\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libMoltenVK\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
-    *) ac_cv_lib_soname_MoltenVK=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libMoltenVK\\.$LIBEXT" | sed -e "s/^.*\\[\\(libMoltenVK\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
-       if ${ac_cv_lib_soname_MoltenVK:+false} :
+    dll) ac_cv_lib_soname_gcrypt=`$ac_cv_path_LDD conftest.exe | grep "gcrypt" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_gcrypt=`$OTOOL -L conftest$ac_exeext | grep "libgcrypt\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libgcrypt\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_gcrypt=`$READELF -d conftest$ac_exeext | grep "NEEDED.*libgcrypt\\.$LIBEXT" | sed -e "s/^.*\\[\\(libgcrypt\\.$LIBEXT[^	 ]*\\)\\].*$/\1/"';2,$d'`
+       if ${ac_cv_lib_soname_gcrypt:+false} :
 then :
-  ac_cv_lib_soname_MoltenVK=`$LDD conftest$ac_exeext | grep "libMoltenVK\\.$LIBEXT" | sed -e "s/^.*\(libMoltenVK\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
+  ac_cv_lib_soname_gcrypt=`$LDD conftest$ac_exeext | grep "libgcrypt\\.$LIBEXT" | sed -e "s/^.*\(libgcrypt\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'`
 fi ;;
   esac
-else $as_nop
-  ac_cv_lib_soname_MoltenVK=
+else case e in #(
+  e) ac_cv_lib_soname_gcrypt= ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-  LIBS=$ac_check_soname_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS ;;
+esac
 fi
-if ${ac_cv_lib_soname_MoltenVK:+false} :
+if ${ac_cv_lib_soname_gcrypt:+false} :
 then :
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 printf "%s\n" "not found" >&6; }
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_MoltenVK" >&5
-printf "%s\n" "$ac_cv_lib_soname_MoltenVK" >&6; }
-
-printf "%s\n" "#define SONAME_LIBMOLTENVK \"$ac_cv_lib_soname_MoltenVK\"" >>confdefs.h
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_gcrypt" >&5
+printf "%s\n" "$ac_cv_lib_soname_gcrypt" >&6; }
 
+printf "%s\n" "#define SONAME_LIBGCRYPT \"$ac_cv_lib_soname_gcrypt\"" >>confdefs.h
 
+        ;;
+esac
 fi
-    fi
+        fi
+CPPFLAGS=$ac_save_CPPFLAGS
+
 fi
-if test "x$ac_cv_lib_soname_vulkan" = "x" -a "x$ac_cv_lib_soname_MoltenVK" = "x"
+if test "x$ac_cv_lib_soname_gcrypt" = "x"
 then :
-  case "x$with_vulkan" in
-  x)   as_fn_append wine_notices "|libvulkan and libMoltenVK ${notice_platform}development files not found, Vulkan won't be supported." ;;
+  case "x$with_gcrypt" in
+  x)   as_fn_append wine_notices "|libgcrypt ${notice_platform}development files not found, GCRYPT won't be supported." ;;
   xno) ;;
-  *)   as_fn_error $? "libvulkan and libMoltenVK ${notice_platform}development files not found, Vulkan won't be supported.
-This is an error since --with-vulkan was requested." "$LINENO" 5 ;;
+  *)   as_fn_error $? "libgcrypt ${notice_platform}development files not found, GCRYPT won't be supported.
+This is an error since --with-gcrypt was requested." "$LINENO" 5 ;;
 esac
 
 fi
@@ -18385,8 +20555,8 @@ printf %s "checking whether the compiler supports -Werror=unknown-warning-option
 if test ${ac_cv_cflags__Werror_unknown_warning_option+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Werror=unknown-warning-option"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18395,12 +20565,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Werror_unknown_warning_option=yes
-else $as_nop
-  ac_cv_cflags__Werror_unknown_warning_option=no
+else case e in #(
+  e) ac_cv_cflags__Werror_unknown_warning_option=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Werror_unknown_warning_option" >&5
 printf "%s\n" "$ac_cv_cflags__Werror_unknown_warning_option" >&6; }
@@ -18413,8 +20585,8 @@ printf %s "checking whether the compiler supports -Werror=unused-command-line-ar
 if test ${ac_cv_cflags__Werror_unused_command_line_argument+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Werror=unused-command-line-argument"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18423,12 +20595,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Werror_unused_command_line_argument=yes
-else $as_nop
-  ac_cv_cflags__Werror_unused_command_line_argument=no
+else case e in #(
+  e) ac_cv_cflags__Werror_unused_command_line_argument=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Werror_unused_command_line_argument" >&5
 printf "%s\n" "$ac_cv_cflags__Werror_unused_command_line_argument" >&6; }
@@ -18441,8 +20615,8 @@ printf %s "checking whether the compiler supports -Werror=ignored-optimization-a
 if test ${ac_cv_cflags__Werror_ignored_optimization_argument+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Werror=ignored-optimization-argument"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18451,12 +20625,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Werror_ignored_optimization_argument=yes
-else $as_nop
-  ac_cv_cflags__Werror_ignored_optimization_argument=no
+else case e in #(
+  e) ac_cv_cflags__Werror_ignored_optimization_argument=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Werror_ignored_optimization_argument" >&5
 printf "%s\n" "$ac_cv_cflags__Werror_ignored_optimization_argument" >&6; }
@@ -18469,8 +20645,8 @@ printf %s "checking whether the compiler supports -fcf-protection=none... " >&6;
 if test ${ac_cv_cflags__fcf_protection_none+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -fcf-protection=none"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18479,26 +20655,58 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__fcf_protection_none=yes
-else $as_nop
-  ac_cv_cflags__fcf_protection_none=no
+else case e in #(
+  e) ac_cv_cflags__fcf_protection_none=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fcf_protection_none" >&5
 printf "%s\n" "$ac_cv_cflags__fcf_protection_none" >&6; }
 if test "x$ac_cv_cflags__fcf_protection_none" = xyes
 then :
   EXTRACFLAGS="$EXTRACFLAGS -fcf-protection=none"
+fi
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -fvisibility=hidden" >&5
+printf %s "checking whether the compiler supports -fvisibility=hidden... " >&6; }
+if test ${ac_cv_cflags__fvisibility_hidden+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
+CFLAGS="$CFLAGS -fvisibility=hidden"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+int main(int argc, char **argv) { return 0; }
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  ac_cv_cflags__fvisibility_hidden=yes
+else case e in #(
+  e) ac_cv_cflags__fvisibility_hidden=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fvisibility_hidden" >&5
+printf "%s\n" "$ac_cv_cflags__fvisibility_hidden" >&6; }
+if test "x$ac_cv_cflags__fvisibility_hidden" = xyes
+then :
+  EXTRACFLAGS="$EXTRACFLAGS -fvisibility=hidden"
 fi
   { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -fno-stack-protector" >&5
 printf %s "checking whether the compiler supports -fno-stack-protector... " >&6; }
 if test ${ac_cv_cflags__fno_stack_protector+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -fno-stack-protector"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18507,12 +20715,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__fno_stack_protector=yes
-else $as_nop
-  ac_cv_cflags__fno_stack_protector=no
+else case e in #(
+  e) ac_cv_cflags__fno_stack_protector=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fno_stack_protector" >&5
 printf "%s\n" "$ac_cv_cflags__fno_stack_protector" >&6; }
@@ -18525,8 +20735,8 @@ printf %s "checking whether the compiler supports -fno-strict-aliasing... " >&6;
 if test ${ac_cv_cflags__fno_strict_aliasing+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -fno-strict-aliasing"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18535,12 +20745,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__fno_strict_aliasing=yes
-else $as_nop
-  ac_cv_cflags__fno_strict_aliasing=no
+else case e in #(
+  e) ac_cv_cflags__fno_strict_aliasing=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fno_strict_aliasing" >&5
 printf "%s\n" "$ac_cv_cflags__fno_strict_aliasing" >&6; }
@@ -18553,8 +20765,8 @@ printf %s "checking whether the compiler supports -Wdeclaration-after-statement.
 if test ${ac_cv_cflags__Wdeclaration_after_statement+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wdeclaration-after-statement"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18563,12 +20775,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wdeclaration_after_statement=yes
-else $as_nop
-  ac_cv_cflags__Wdeclaration_after_statement=no
+else case e in #(
+  e) ac_cv_cflags__Wdeclaration_after_statement=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wdeclaration_after_statement" >&5
 printf "%s\n" "$ac_cv_cflags__Wdeclaration_after_statement" >&6; }
@@ -18581,8 +20795,8 @@ printf %s "checking whether the compiler supports -Wempty-body... " >&6; }
 if test ${ac_cv_cflags__Wempty_body+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wempty-body"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18591,12 +20805,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wempty_body=yes
-else $as_nop
-  ac_cv_cflags__Wempty_body=no
+else case e in #(
+  e) ac_cv_cflags__Wempty_body=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wempty_body" >&5
 printf "%s\n" "$ac_cv_cflags__Wempty_body" >&6; }
@@ -18609,8 +20825,8 @@ printf %s "checking whether the compiler supports -Wignored-qualifiers... " >&6;
 if test ${ac_cv_cflags__Wignored_qualifiers+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wignored-qualifiers"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18619,12 +20835,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wignored_qualifiers=yes
-else $as_nop
-  ac_cv_cflags__Wignored_qualifiers=no
+else case e in #(
+  e) ac_cv_cflags__Wignored_qualifiers=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wignored_qualifiers" >&5
 printf "%s\n" "$ac_cv_cflags__Wignored_qualifiers" >&6; }
@@ -18637,8 +20855,8 @@ printf %s "checking whether the compiler supports -Winit-self... " >&6; }
 if test ${ac_cv_cflags__Winit_self+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Winit-self"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18647,12 +20865,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Winit_self=yes
-else $as_nop
-  ac_cv_cflags__Winit_self=no
+else case e in #(
+  e) ac_cv_cflags__Winit_self=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Winit_self" >&5
 printf "%s\n" "$ac_cv_cflags__Winit_self" >&6; }
@@ -18665,8 +20885,8 @@ printf %s "checking whether the compiler supports -Wpacked-not-aligned... " >&6;
 if test ${ac_cv_cflags__Wpacked_not_aligned+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wpacked-not-aligned"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18675,12 +20895,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wpacked_not_aligned=yes
-else $as_nop
-  ac_cv_cflags__Wpacked_not_aligned=no
+else case e in #(
+  e) ac_cv_cflags__Wpacked_not_aligned=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wpacked_not_aligned" >&5
 printf "%s\n" "$ac_cv_cflags__Wpacked_not_aligned" >&6; }
@@ -18693,8 +20915,8 @@ printf %s "checking whether the compiler supports -Wpragma-pack... " >&6; }
 if test ${ac_cv_cflags__Wpragma_pack+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wpragma-pack"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18703,12 +20925,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wpragma_pack=yes
-else $as_nop
-  ac_cv_cflags__Wpragma_pack=no
+else case e in #(
+  e) ac_cv_cflags__Wpragma_pack=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wpragma_pack" >&5
 printf "%s\n" "$ac_cv_cflags__Wpragma_pack" >&6; }
@@ -18721,8 +20945,8 @@ printf %s "checking whether the compiler supports -Wshift-overflow=2... " >&6; }
 if test ${ac_cv_cflags__Wshift_overflow_2+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wshift-overflow=2"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18731,12 +20955,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wshift_overflow_2=yes
-else $as_nop
-  ac_cv_cflags__Wshift_overflow_2=no
+else case e in #(
+  e) ac_cv_cflags__Wshift_overflow_2=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wshift_overflow_2" >&5
 printf "%s\n" "$ac_cv_cflags__Wshift_overflow_2" >&6; }
@@ -18749,8 +20975,8 @@ printf %s "checking whether the compiler supports -Wstrict-prototypes... " >&6;
 if test ${ac_cv_cflags__Wstrict_prototypes+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wstrict-prototypes"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18759,12 +20985,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wstrict_prototypes=yes
-else $as_nop
-  ac_cv_cflags__Wstrict_prototypes=no
+else case e in #(
+  e) ac_cv_cflags__Wstrict_prototypes=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wstrict_prototypes" >&5
 printf "%s\n" "$ac_cv_cflags__Wstrict_prototypes" >&6; }
@@ -18777,8 +21005,8 @@ printf %s "checking whether the compiler supports -Wtype-limits... " >&6; }
 if test ${ac_cv_cflags__Wtype_limits+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wtype-limits"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18787,12 +21015,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wtype_limits=yes
-else $as_nop
-  ac_cv_cflags__Wtype_limits=no
+else case e in #(
+  e) ac_cv_cflags__Wtype_limits=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wtype_limits" >&5
 printf "%s\n" "$ac_cv_cflags__Wtype_limits" >&6; }
@@ -18805,8 +21035,8 @@ printf %s "checking whether the compiler supports -Wunused-but-set-parameter...
 if test ${ac_cv_cflags__Wunused_but_set_parameter+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wunused-but-set-parameter"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18815,12 +21045,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wunused_but_set_parameter=yes
-else $as_nop
-  ac_cv_cflags__Wunused_but_set_parameter=no
+else case e in #(
+  e) ac_cv_cflags__Wunused_but_set_parameter=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wunused_but_set_parameter" >&5
 printf "%s\n" "$ac_cv_cflags__Wunused_but_set_parameter" >&6; }
@@ -18833,8 +21065,8 @@ printf %s "checking whether the compiler supports -Wvla... " >&6; }
 if test ${ac_cv_cflags__Wvla+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wvla"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18843,12 +21075,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wvla=yes
-else $as_nop
-  ac_cv_cflags__Wvla=no
+else case e in #(
+  e) ac_cv_cflags__Wvla=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wvla" >&5
 printf "%s\n" "$ac_cv_cflags__Wvla" >&6; }
@@ -18861,8 +21095,8 @@ printf %s "checking whether the compiler supports -Wwrite-strings... " >&6; }
 if test ${ac_cv_cflags__Wwrite_strings+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wwrite-strings"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18871,12 +21105,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wwrite_strings=yes
-else $as_nop
-  ac_cv_cflags__Wwrite_strings=no
+else case e in #(
+  e) ac_cv_cflags__Wwrite_strings=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wwrite_strings" >&5
 printf "%s\n" "$ac_cv_cflags__Wwrite_strings" >&6; }
@@ -18890,8 +21126,8 @@ printf %s "checking whether the compiler supports -Wpointer-arith... " >&6; }
 if test ${ac_cv_cflags__Wpointer_arith+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wpointer-arith"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18900,12 +21136,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wpointer_arith=yes
-else $as_nop
-  ac_cv_cflags__Wpointer_arith=no
+else case e in #(
+  e) ac_cv_cflags__Wpointer_arith=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wpointer_arith" >&5
 printf "%s\n" "$ac_cv_cflags__Wpointer_arith" >&6; }
@@ -18918,8 +21156,8 @@ printf %s "checking for broken string.h that generates warnings with -Wpointer-a
 if test ${ac_cv_c_string_h_warnings+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <string.h>
 int
@@ -18933,10 +21171,12 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_c_string_h_warnings=no
-else $as_nop
-  ac_cv_c_string_h_warnings=yes
+else case e in #(
+  e) ac_cv_c_string_h_warnings=yes ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_string_h_warnings" >&5
 printf "%s\n" "$ac_cv_c_string_h_warnings" >&6; }
@@ -18949,8 +21189,8 @@ printf %s "checking whether the compiler supports -Wlogical-op... " >&6; }
 if test ${ac_cv_cflags__Wlogical_op+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wlogical-op"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -18959,12 +21199,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wlogical_op=yes
-else $as_nop
-  ac_cv_cflags__Wlogical_op=no
+else case e in #(
+  e) ac_cv_cflags__Wlogical_op=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wlogical_op" >&5
 printf "%s\n" "$ac_cv_cflags__Wlogical_op" >&6; }
@@ -18977,8 +21219,8 @@ printf %s "checking for broken string.h that generates warnings with -Wlogical-o
 if test ${ac_cv_c_logicalop_noisy+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <string.h>
 char*f(const char *h,char n) {return strchr(h,n);}
@@ -18993,10 +21235,12 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_c_logicalop_noisy=no
-else $as_nop
-  ac_cv_c_logicalop_noisy=yes
+else case e in #(
+  e) ac_cv_c_logicalop_noisy=yes ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_logicalop_noisy" >&5
 printf "%s\n" "$ac_cv_c_logicalop_noisy" >&6; }
@@ -19009,8 +21253,8 @@ printf %s "checking for flags needed for 64-bit compare-and-swap support... " >&
 if test ${wine_cv_64bit_compare_swap+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __GCC_HAVE_SYNC_COMPARE_AND_SWAP_8
 #error no
@@ -19026,11 +21270,11 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   wine_cv_64bit_compare_swap="none needed"
-else $as_nop
-  case $host_cpu in
-            *i[3456]86*) wine_cv_64bit_compare_swap="-march=i586" ;;
-            *arm*)         wine_cv_64bit_compare_swap="-march=armv7-a" ;;
-            *)             wine_cv_64bit_compare_swap="unknown" ;;
+else case e in #(
+  e) case $HOST_ARCH in
+            i386) wine_cv_64bit_compare_swap="-march=i586" ;;
+            arm)  wine_cv_64bit_compare_swap="-march=armv7-a" ;;
+            *)    wine_cv_64bit_compare_swap="unknown" ;;
            esac
            if test "x$wine_cv_64bit_compare_swap" != xunknown
            then
@@ -19051,14 +21295,17 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
 
-else $as_nop
-  wine_cv_64bit_compare_swap="unknown"
+else case e in #(
+  e) wine_cv_64bit_compare_swap="unknown" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
                CFLAGS=$saved_CFLAGS
-           fi
+           fi ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_64bit_compare_swap" >&5
 printf "%s\n" "$wine_cv_64bit_compare_swap" >&6; }
@@ -19082,8 +21329,8 @@ printf %s "checking whether the compiler supports -gdwarf-4... " >&6; }
 if test ${ac_cv_cflags__gdwarf_4+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -gdwarf-4"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19092,12 +21339,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__gdwarf_4=yes
-else $as_nop
-  ac_cv_cflags__gdwarf_4=no
+else case e in #(
+  e) ac_cv_cflags__gdwarf_4=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__gdwarf_4" >&5
 printf "%s\n" "$ac_cv_cflags__gdwarf_4" >&6; }
@@ -19115,8 +21364,8 @@ printf %s "checking whether the compiler supports -Wl,-delayload,autoconftest.dl
 if test ${ac_cv_cflags__Wl__delayload_autoconftest_dll+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wl,-delayload,autoconftest.dll"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19125,12 +21374,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wl__delayload_autoconftest_dll=yes
-else $as_nop
-  ac_cv_cflags__Wl__delayload_autoconftest_dll=no
+else case e in #(
+  e) ac_cv_cflags__Wl__delayload_autoconftest_dll=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl__delayload_autoconftest_dll" >&5
 printf "%s\n" "$ac_cv_cflags__Wl__delayload_autoconftest_dll" >&6; }
@@ -19145,8 +21396,8 @@ printf %s "checking whether the compiler supports -fno-builtin... " >&6; }
 if test ${ac_cv_cflags__fno_builtin+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -fno-builtin"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19155,12 +21406,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__fno_builtin=yes
-else $as_nop
-  ac_cv_cflags__fno_builtin=no
+else case e in #(
+  e) ac_cv_cflags__fno_builtin=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fno_builtin" >&5
 printf "%s\n" "$ac_cv_cflags__fno_builtin" >&6; }
@@ -19173,8 +21426,8 @@ printf %s "checking whether the compiler supports -fshort-wchar... " >&6; }
 if test ${ac_cv_cflags__fshort_wchar+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -fshort-wchar"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19183,12 +21436,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__fshort_wchar=yes
-else $as_nop
-  ac_cv_cflags__fshort_wchar=no
+else case e in #(
+  e) ac_cv_cflags__fshort_wchar=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fshort_wchar" >&5
 printf "%s\n" "$ac_cv_cflags__fshort_wchar" >&6; }
@@ -19201,8 +21456,8 @@ printf %s "checking whether the compiler supports -Wno-format... " >&6; }
 if test ${ac_cv_cflags__Wno_format+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wno-format"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19211,12 +21466,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wno_format=yes
-else $as_nop
-  ac_cv_cflags__Wno_format=no
+else case e in #(
+  e) ac_cv_cflags__Wno_format=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wno_format" >&5
 printf "%s\n" "$ac_cv_cflags__Wno_format" >&6; }
@@ -19226,14 +21483,14 @@ then :
 fi ;;
   esac
 
-  case $host_cpu in
-        *i[3456789]86*) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -fno-omit-frame-pointer" >&5
+  case $HOST_ARCH in
+        i386) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -fno-omit-frame-pointer" >&5
 printf %s "checking whether the compiler supports -fno-omit-frame-pointer... " >&6; }
 if test ${ac_cv_cflags__fno_omit_frame_pointer+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -fno-omit-frame-pointer"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19242,12 +21499,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__fno_omit_frame_pointer=yes
-else $as_nop
-  ac_cv_cflags__fno_omit_frame_pointer=no
+else case e in #(
+  e) ac_cv_cflags__fno_omit_frame_pointer=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__fno_omit_frame_pointer" >&5
 printf "%s\n" "$ac_cv_cflags__fno_omit_frame_pointer" >&6; }
@@ -19255,15 +21514,15 @@ if test "x$ac_cv_cflags__fno_omit_frame_pointer" = xyes
 then :
   MSVCRTFLAGS="$MSVCRTFLAGS -fno-omit-frame-pointer"
 fi ;;
-    *x86_64*)
+    x86_64)
       case $host_os in
                 cygwin*|mingw32*) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wno-format" >&5
 printf %s "checking whether the compiler supports -Wno-format... " >&6; }
 if test ${ac_cv_cflags__Wno_format+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wno-format"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19272,12 +21531,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wno_format=yes
-else $as_nop
-  ac_cv_cflags__Wno_format=no
+else case e in #(
+  e) ac_cv_cflags__Wno_format=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wno_format" >&5
 printf "%s\n" "$ac_cv_cflags__Wno_format" >&6; }
@@ -19292,8 +21553,8 @@ printf %s "checking for working -mabi=ms... " >&6; }
 if test ${ac_cv_mabi_ms+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  CFLAGS="$CFLAGS -mabi=ms"
+else case e in #(
+  e) CFLAGS="$CFLAGS -mabi=ms"
                     cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <stdarg.h>
@@ -19309,11 +21570,13 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_mabi_ms=yes
-else $as_nop
-  ac_cv_mabi_ms=no
+else case e in #(
+  e) ac_cv_mabi_ms=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
-                    CFLAGS=$saved_CFLAGS
+                    CFLAGS=$saved_CFLAGS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_mabi_ms" >&5
 printf "%s\n" "$ac_cv_mabi_ms" >&6; }
@@ -19321,14 +21584,14 @@ printf "%s\n" "$ac_cv_mabi_ms" >&6; }
            fi
            MSVCRTFLAGS="$MSVCRTFLAGS -mabi=ms" ;;
       esac ;;
-    arm*)
+    arm)
       { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports -Wincompatible-function-pointer-types" >&5
 printf %s "checking whether the compiler supports -Wincompatible-function-pointer-types... " >&6; }
 if test ${ac_cv_cflags__Wincompatible_function_pointer_types+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wincompatible-function-pointer-types"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19337,12 +21600,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wincompatible_function_pointer_types=yes
-else $as_nop
-  ac_cv_cflags__Wincompatible_function_pointer_types=no
+else case e in #(
+  e) ac_cv_cflags__Wincompatible_function_pointer_types=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wincompatible_function_pointer_types" >&5
 printf "%s\n" "$ac_cv_cflags__Wincompatible_function_pointer_types" >&6; }
@@ -19361,8 +21626,8 @@ printf %s "checking whether the compiler supports -Werror... " >&6; }
 if test ${ac_cv_cflags__Werror+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Werror"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19371,12 +21636,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Werror=yes
-else $as_nop
-  ac_cv_cflags__Werror=no
+else case e in #(
+  e) ac_cv_cflags__Werror=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Werror" >&5
 printf "%s\n" "$ac_cv_cflags__Werror" >&6; }
@@ -19392,8 +21659,8 @@ printf %s "checking whether the compiler supports -Wl,--build-id... " >&6; }
 if test ${ac_cv_cflags__Wl___build_id+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_wine_try_cflags_saved=$CFLAGS
+else case e in #(
+  e) ac_wine_try_cflags_saved=$CFLAGS
 CFLAGS="$CFLAGS -Wl,--build-id"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -19402,12 +21669,14 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_cflags__Wl___build_id=yes
-else $as_nop
-  ac_cv_cflags__Wl___build_id=no
+else case e in #(
+  e) ac_cv_cflags__Wl___build_id=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-CFLAGS=$ac_wine_try_cflags_saved
+CFLAGS=$ac_wine_try_cflags_saved ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cflags__Wl___build_id" >&5
 printf "%s\n" "$ac_cv_cflags__Wl___build_id" >&6; }
@@ -19425,8 +21694,8 @@ printf %s "checking for the need to disable Fortify... " >&6; }
 if test ${ac_cv_c_fortify_enabled+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <string.h>
 int
@@ -19442,10 +21711,12 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_c_fortify_enabled=no
-else $as_nop
-  ac_cv_c_fortify_enabled=yes
+else case e in #(
+  e) ac_cv_c_fortify_enabled=yes ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_fortify_enabled" >&5
 printf "%s\n" "$ac_cv_c_fortify_enabled" >&6; }
@@ -19460,8 +21731,8 @@ printf %s "checking whether CFI directives are supported in assembly code... " >
 if test ${ac_cv_c_cfi_support+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 asm(".text\nac_test:\t.cfi_startproc\n\t.long 0\n\t.cfi_endproc");
 int
@@ -19475,10 +21746,12 @@ _ACEOF
 if ac_fn_c_try_compile "$LINENO"
 then :
   ac_cv_c_cfi_support="yes"
-else $as_nop
-  ac_cv_c_cfi_support="no"
+else case e in #(
+  e) ac_cv_c_cfi_support="no" ;;
+esac
 fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_cfi_support" >&5
 printf "%s\n" "$ac_cv_c_cfi_support" >&6; }
@@ -19503,12 +21776,11 @@ WINELOADER_PROGRAMS="$wine_binary"
 
 case $host_os in
   linux*)
-    case $host_cpu in
-      *i[3456789]86*|x86_64*|*aarch64*|arm*)
+    if test $HOST_ARCH != unknown
+    then
         test "$wine_binary" = wine || as_fn_append CONFIGURE_TARGETS " loader/wine-preloader"
         WINELOADER_PROGRAMS="$WINELOADER_PROGRAMS $wine_binary-preloader"
-        ;;
-    esac
+    fi
     ;;
   darwin*|macosx*)
     if test "$wine_can_build_preloader" = "yes"
@@ -19525,15 +21797,21 @@ printf %s "checking for library containing dlopen... " >&6; }
 if test ${ac_cv_search_dlopen+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_func_search_save_LIBS=$LIBS
+else case e in #(
+  e) ac_func_search_save_LIBS=$LIBS
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char dlopen (void);
 int
 main (void)
 {
@@ -19564,11 +21842,13 @@ done
 if test ${ac_cv_search_dlopen+y}
 then :
 
-else $as_nop
-  ac_cv_search_dlopen=no
+else case e in #(
+  e) ac_cv_search_dlopen=no ;;
+esac
 fi
 rm conftest.$ac_ext
-LIBS=$ac_func_search_save_LIBS
+LIBS=$ac_func_search_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_dlopen" >&5
 printf "%s\n" "$ac_cv_search_dlopen" >&6; }
@@ -19585,15 +21865,21 @@ printf %s "checking for library containing gethostbyname... " >&6; }
 if test ${ac_cv_search_gethostbyname+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_func_search_save_LIBS=$LIBS
+else case e in #(
+  e) ac_func_search_save_LIBS=$LIBS
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char gethostbyname ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char gethostbyname (void);
 int
 main (void)
 {
@@ -19624,11 +21910,13 @@ done
 if test ${ac_cv_search_gethostbyname+y}
 then :
 
-else $as_nop
-  ac_cv_search_gethostbyname=no
+else case e in #(
+  e) ac_cv_search_gethostbyname=no ;;
+esac
 fi
 rm conftest.$ac_ext
-LIBS=$ac_func_search_save_LIBS
+LIBS=$ac_func_search_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_gethostbyname" >&5
 printf "%s\n" "$ac_cv_search_gethostbyname" >&6; }
@@ -19645,15 +21933,21 @@ printf %s "checking for library containing connect... " >&6; }
 if test ${ac_cv_search_connect+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_func_search_save_LIBS=$LIBS
+else case e in #(
+  e) ac_func_search_save_LIBS=$LIBS
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char connect ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char connect (void);
 int
 main (void)
 {
@@ -19684,11 +21978,13 @@ done
 if test ${ac_cv_search_connect+y}
 then :
 
-else $as_nop
-  ac_cv_search_connect=no
+else case e in #(
+  e) ac_cv_search_connect=no ;;
+esac
 fi
 rm conftest.$ac_ext
-LIBS=$ac_func_search_save_LIBS
+LIBS=$ac_func_search_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_connect" >&5
 printf "%s\n" "$ac_cv_search_connect" >&6; }
@@ -19705,15 +22001,21 @@ printf %s "checking for library containing inet_aton... " >&6; }
 if test ${ac_cv_search_inet_aton+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_func_search_save_LIBS=$LIBS
+else case e in #(
+  e) ac_func_search_save_LIBS=$LIBS
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char inet_aton ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char inet_aton (void);
 int
 main (void)
 {
@@ -19744,11 +22046,13 @@ done
 if test ${ac_cv_search_inet_aton+y}
 then :
 
-else $as_nop
-  ac_cv_search_inet_aton=no
+else case e in #(
+  e) ac_cv_search_inet_aton=no ;;
+esac
 fi
 rm conftest.$ac_ext
-LIBS=$ac_func_search_save_LIBS
+LIBS=$ac_func_search_save_LIBS ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_inet_aton" >&5
 printf "%s\n" "$ac_cv_search_inet_aton" >&6; }
@@ -19845,6 +22149,12 @@ if test "x$ac_cv_func_mach_continuous_time" = xyes
 then :
   printf "%s\n" "#define HAVE_MACH_CONTINUOUS_TIME 1" >>confdefs.h
 
+fi
+ac_fn_c_check_func "$LINENO" "memfd_create" "ac_cv_func_memfd_create"
+if test "x$ac_cv_func_memfd_create" = xyes
+then :
+  printf "%s\n" "#define HAVE_MEMFD_CREATE 1" >>confdefs.h
+
 fi
 ac_fn_c_check_func "$LINENO" "pipe2" "ac_cv_func_pipe2"
 if test "x$ac_cv_func_pipe2" = xyes
@@ -19870,16 +22180,16 @@ then :
   printf "%s\n" "#define HAVE_POSIX_FALLOCATE 1" >>confdefs.h
 
 fi
-ac_fn_c_check_func "$LINENO" "prctl" "ac_cv_func_prctl"
-if test "x$ac_cv_func_prctl" = xyes
+ac_fn_c_check_func "$LINENO" "ppoll" "ac_cv_func_ppoll"
+if test "x$ac_cv_func_ppoll" = xyes
 then :
-  printf "%s\n" "#define HAVE_PRCTL 1" >>confdefs.h
+  printf "%s\n" "#define HAVE_PPOLL 1" >>confdefs.h
 
 fi
-ac_fn_c_check_func "$LINENO" "proc_pidinfo" "ac_cv_func_proc_pidinfo"
-if test "x$ac_cv_func_proc_pidinfo" = xyes
+ac_fn_c_check_func "$LINENO" "prctl" "ac_cv_func_prctl"
+if test "x$ac_cv_func_prctl" = xyes
 then :
-  printf "%s\n" "#define HAVE_PROC_PIDINFO 1" >>confdefs.h
+  printf "%s\n" "#define HAVE_PRCTL 1" >>confdefs.h
 
 fi
 ac_fn_c_check_func "$LINENO" "sched_yield" "ac_cv_func_sched_yield"
@@ -19935,19 +22245,101 @@ printf %s "checking for library containing clock_gettime... " >&6; }
 if test ${ac_cv_search_clock_gettime+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_func_search_save_LIBS=$LIBS
+else case e in #(
+  e) ac_func_search_save_LIBS=$LIBS
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-char clock_gettime ();
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char clock_gettime (void);
+int
+main (void)
+{
+return clock_gettime ();
+  ;
+  return 0;
+}
+_ACEOF
+for ac_lib in '' rt
+do
+  if test -z "$ac_lib"; then
+    ac_res="none required"
+  else
+    ac_res=-l$ac_lib
+    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+  fi
+  if ac_fn_c_try_link "$LINENO"
+then :
+  ac_cv_search_clock_gettime=$ac_res
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext
+  if test ${ac_cv_search_clock_gettime+y}
+then :
+  break
+fi
+done
+if test ${ac_cv_search_clock_gettime+y}
+then :
+
+else case e in #(
+  e) ac_cv_search_clock_gettime=no ;;
+esac
+fi
+rm conftest.$ac_ext
+LIBS=$ac_func_search_save_LIBS ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_clock_gettime" >&5
+printf "%s\n" "$ac_cv_search_clock_gettime" >&6; }
+ac_res=$ac_cv_search_clock_gettime
+if test "$ac_res" != no
+then :
+  test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
+
+printf "%s\n" "#define HAVE_CLOCK_GETTIME 1" >>confdefs.h
+
+                test "$ac_res" = "none required" || RT_LIBS="$ac_res"
+
+fi
+
+    LIBS=$ac_save_LIBS
+    ;;
+esac
+
+ac_save_LIBS=$LIBS
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for library containing shm_open" >&5
+printf %s "checking for library containing shm_open... " >&6; }
+if test ${ac_cv_search_shm_open+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) ac_func_search_save_LIBS=$LIBS
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.
+   The 'extern "C"' is for builds by C++ compilers;
+   although this is not generally supported in C code supporting it here
+   has little cost and some practical benefit (sr 110532).  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char shm_open (void);
 int
 main (void)
 {
-return clock_gettime ();
+return shm_open ();
   ;
   return 0;
 }
@@ -19962,48 +22354,48 @@ do
   fi
   if ac_fn_c_try_link "$LINENO"
 then :
-  ac_cv_search_clock_gettime=$ac_res
+  ac_cv_search_shm_open=$ac_res
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext
-  if test ${ac_cv_search_clock_gettime+y}
+  if test ${ac_cv_search_shm_open+y}
 then :
   break
 fi
 done
-if test ${ac_cv_search_clock_gettime+y}
+if test ${ac_cv_search_shm_open+y}
 then :
 
-else $as_nop
-  ac_cv_search_clock_gettime=no
+else case e in #(
+  e) ac_cv_search_shm_open=no ;;
+esac
 fi
 rm conftest.$ac_ext
-LIBS=$ac_func_search_save_LIBS
+LIBS=$ac_func_search_save_LIBS ;;
+esac
 fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_clock_gettime" >&5
-printf "%s\n" "$ac_cv_search_clock_gettime" >&6; }
-ac_res=$ac_cv_search_clock_gettime
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_shm_open" >&5
+printf "%s\n" "$ac_cv_search_shm_open" >&6; }
+ac_res=$ac_cv_search_shm_open
 if test "$ac_res" != no
 then :
   test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
 
-printf "%s\n" "#define HAVE_CLOCK_GETTIME 1" >>confdefs.h
+printf "%s\n" "#define HAVE_SHM_OPEN 1" >>confdefs.h
 
                 test "$ac_res" = "none required" || RT_LIBS="$ac_res"
 
 fi
 
-    LIBS=$ac_save_LIBS
-    ;;
-esac
+LIBS=$ac_save_LIBS
 
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for sched_setaffinity" >&5
 printf %s "checking for sched_setaffinity... " >&6; }
 if test ${wine_cv_have_sched_setaffinity+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <sched.h>
 int
@@ -20017,11 +22409,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   wine_cv_have_sched_setaffinity=yes
-else $as_nop
-  wine_cv_have_sched_setaffinity=no
+else case e in #(
+  e) wine_cv_have_sched_setaffinity=no ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_have_sched_setaffinity" >&5
 printf "%s\n" "$wine_cv_have_sched_setaffinity" >&6; }
@@ -20032,14 +22426,53 @@ printf "%s\n" "#define HAVE_SCHED_SETAFFINITY 1" >>confdefs.h
 
 fi
 
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for setpriority" >&5
+printf %s "checking for setpriority... " >&6; }
+if test ${wine_cv_have_setpriority+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#define _GNU_SOURCE
+#include <sys/resource.h>
+#include <sys/time.h>
+int
+main (void)
+{
+setpriority(0, 0, 0);
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+  wine_cv_have_setpriority=yes
+else case e in #(
+  e) wine_cv_have_setpriority=no ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_have_setpriority" >&5
+printf "%s\n" "$wine_cv_have_setpriority" >&6; }
+if test "$wine_cv_have_setpriority" = "yes"
+then
+
+printf "%s\n" "#define HAVE_SETPRIORITY 1" >>confdefs.h
+
+fi
+
 
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for inline" >&5
 printf %s "checking for inline... " >&6; }
 if test ${ac_cv_c_inline+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  ac_cv_c_inline=no
+else case e in #(
+  e) ac_cv_c_inline=no
 for ac_kw in inline __inline__ __inline; do
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -20057,7 +22490,8 @@ fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
   test "$ac_cv_c_inline" != no && break
 done
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_inline" >&5
 printf "%s\n" "$ac_cv_c_inline" >&6; }
@@ -20077,17 +22511,6 @@ _ACEOF
     ;;
 esac
 
-ac_fn_c_check_type "$LINENO" "sigset_t" "ac_cv_type_sigset_t" "#include <sys/types.h>
-#include <signal.h>
-"
-if test "x$ac_cv_type_sigset_t" = xyes
-then :
-
-printf "%s\n" "#define HAVE_SIGSET_T 1" >>confdefs.h
-
-
-fi
-
 ac_fn_c_check_type "$LINENO" "request_sense" "ac_cv_type_request_sense" "#include <linux/cdrom.h>
 "
 if test "x$ac_cv_type_request_sense" = xyes
@@ -20099,79 +22522,13 @@ printf "%s\n" "#define HAVE_REQUEST_SENSE 1" >>confdefs.h
 fi
 
 
-ac_fn_c_check_type "$LINENO" "struct xinpgen" "ac_cv_type_struct_xinpgen" "#include <sys/types.h>
-#include <sys/socket.h>
-#ifdef HAVE_SYS_SOCKETVAR_H
-#include <sys/socketvar.h>
-#endif
-#ifdef HAVE_NET_ROUTE_H
-#include <net/route.h>
-#endif
-#ifdef HAVE_NETINET_IN_H
-#include <netinet/in.h>
-#endif
-#ifdef HAVE_NETINET_IN_SYSTM_H
-#include <netinet/in_systm.h>
-#endif
-#ifdef HAVE_NETINET_IP_H
-#include <netinet/ip.h>
-#endif
-#ifdef HAVE_NETINET_IN_PCB_H
-#include <netinet/in_pcb.h>
-#endif
-"
-if test "x$ac_cv_type_struct_xinpgen" = xyes
-then :
-
-printf "%s\n" "#define HAVE_STRUCT_XINPGEN 1" >>confdefs.h
-
-
-fi
-
-
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for sigaddset" >&5
-printf %s "checking for sigaddset... " >&6; }
-if test ${wine_cv_have_sigaddset+y}
-then :
-  printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-#include <signal.h>
-int
-main (void)
-{
-sigset_t set; sigaddset(&set,SIGTERM);
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"
-then :
-  wine_cv_have_sigaddset=yes
-else $as_nop
-  wine_cv_have_sigaddset=no
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
-fi
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_have_sigaddset" >&5
-printf "%s\n" "$wine_cv_have_sigaddset" >&6; }
-if test "$wine_cv_have_sigaddset" = "yes"
-then
-
-printf "%s\n" "#define HAVE_SIGADDSET 1" >>confdefs.h
-
-fi
-
-
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether we can use re-entrant gethostbyname_r Linux style" >&5
 printf %s "checking whether we can use re-entrant gethostbyname_r Linux style... " >&6; }
 if test ${wine_cv_linux_gethostbyname_r_6+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #include <netdb.h>
 int
@@ -20197,13 +22554,15 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   wine_cv_linux_gethostbyname_r_6=yes
-else $as_nop
-  wine_cv_linux_gethostbyname_r_6=no
-
+else case e in #(
+  e) wine_cv_linux_gethostbyname_r_6=no
+	 ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
-
+    ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $wine_cv_linux_gethostbyname_r_6" >&5
 printf "%s\n" "$wine_cv_linux_gethostbyname_r_6" >&6; }
@@ -20650,8 +23009,8 @@ printf %s "checking for __builtin_popcount... " >&6; }
 if test ${ac_cv_have___builtin_popcount+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -20665,11 +23024,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_have___builtin_popcount="yes"
-else $as_nop
-  ac_cv_have___builtin_popcount="no"
+else case e in #(
+  e) ac_cv_have___builtin_popcount="no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_have___builtin_popcount" >&5
 printf "%s\n" "$ac_cv_have___builtin_popcount" >&6; }
@@ -20685,8 +23046,8 @@ printf %s "checking for __clear_cache... " >&6; }
 if test ${ac_cv_have___clear_cache+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 int
@@ -20700,11 +23061,13 @@ _ACEOF
 if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_have___clear_cache="yes"
-else $as_nop
-  ac_cv_have___clear_cache="no"
+else case e in #(
+  e) ac_cv_have___clear_cache="no" ;;
+esac
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
-    conftest$ac_exeext conftest.$ac_ext
+    conftest$ac_exeext conftest.$ac_ext ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_have___clear_cache" >&5
 printf "%s\n" "$ac_cv_have___clear_cache" >&6; }
@@ -20722,22 +23085,158 @@ printf %s "checking whether we need to define __i386__... " >&6; }
 if test ${ac_cv_cpp_def___i386__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for egrep -e" >&5
+printf %s "checking for egrep -e... " >&6; }
+if test ${ac_cv_path_EGREP_TRADITIONAL+y}
+then :
+  printf %s "(cached) " >&6
+else case e in #(
+  e) if test -z "$EGREP_TRADITIONAL"; then
+  ac_path_EGREP_TRADITIONAL_found=false
+  # Loop through the user's path and test for each of PROGNAME-LIST
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_prog in grep ggrep
+   do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      ac_path_EGREP_TRADITIONAL="$as_dir$ac_prog$ac_exec_ext"
+      as_fn_executable_p "$ac_path_EGREP_TRADITIONAL" || continue
+# Check for GNU ac_path_EGREP_TRADITIONAL and select it if it is found.
+  # Check for GNU $ac_path_EGREP_TRADITIONAL
+case `"$ac_path_EGREP_TRADITIONAL" --version 2>&1` in #(
+*GNU*)
+  ac_cv_path_EGREP_TRADITIONAL="$ac_path_EGREP_TRADITIONAL" ac_path_EGREP_TRADITIONAL_found=:;;
+#(
+*)
+  ac_count=0
+  printf %s 0123456789 >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    printf "%s\n" 'EGREP_TRADITIONAL' >> "conftest.nl"
+    "$ac_path_EGREP_TRADITIONAL" -E 'EGR(EP|AC)_TRADITIONAL$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    as_fn_arith $ac_count + 1 && ac_count=$as_val
+    if test $ac_count -gt ${ac_path_EGREP_TRADITIONAL_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_EGREP_TRADITIONAL="$ac_path_EGREP_TRADITIONAL"
+      ac_path_EGREP_TRADITIONAL_max=$ac_count
+    fi
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
+
+      $ac_path_EGREP_TRADITIONAL_found && break 3
+    done
+  done
+  done
+IFS=$as_save_IFS
+  if test -z "$ac_cv_path_EGREP_TRADITIONAL"; then
+    :
+  fi
+else
+  ac_cv_path_EGREP_TRADITIONAL=$EGREP_TRADITIONAL
+fi
+
+    if test "$ac_cv_path_EGREP_TRADITIONAL"
+then :
+  ac_cv_path_EGREP_TRADITIONAL="$ac_cv_path_EGREP_TRADITIONAL -E"
+else case e in #(
+  e) if test -z "$EGREP_TRADITIONAL"; then
+  ac_path_EGREP_TRADITIONAL_found=false
+  # Loop through the user's path and test for each of PROGNAME-LIST
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_prog in egrep
+   do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      ac_path_EGREP_TRADITIONAL="$as_dir$ac_prog$ac_exec_ext"
+      as_fn_executable_p "$ac_path_EGREP_TRADITIONAL" || continue
+# Check for GNU ac_path_EGREP_TRADITIONAL and select it if it is found.
+  # Check for GNU $ac_path_EGREP_TRADITIONAL
+case `"$ac_path_EGREP_TRADITIONAL" --version 2>&1` in #(
+*GNU*)
+  ac_cv_path_EGREP_TRADITIONAL="$ac_path_EGREP_TRADITIONAL" ac_path_EGREP_TRADITIONAL_found=:;;
+#(
+*)
+  ac_count=0
+  printf %s 0123456789 >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    printf "%s\n" 'EGREP_TRADITIONAL' >> "conftest.nl"
+    "$ac_path_EGREP_TRADITIONAL" 'EGR(EP|AC)_TRADITIONAL$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    as_fn_arith $ac_count + 1 && ac_count=$as_val
+    if test $ac_count -gt ${ac_path_EGREP_TRADITIONAL_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_EGREP_TRADITIONAL="$ac_path_EGREP_TRADITIONAL"
+      ac_path_EGREP_TRADITIONAL_max=$ac_count
+    fi
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
+
+      $ac_path_EGREP_TRADITIONAL_found && break 3
+    done
+  done
+  done
+IFS=$as_save_IFS
+  if test -z "$ac_cv_path_EGREP_TRADITIONAL"; then
+    as_fn_error $? "no acceptable egrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+  fi
+else
+  ac_cv_path_EGREP_TRADITIONAL=$EGREP_TRADITIONAL
+fi
+ ;;
+esac
+fi ;;
+esac
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_EGREP_TRADITIONAL" >&5
+printf "%s\n" "$ac_cv_path_EGREP_TRADITIONAL" >&6; }
+ EGREP_TRADITIONAL=$ac_cv_path_EGREP_TRADITIONAL
+
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __i386__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___i386__=yes
-else $as_nop
-  ac_cv_cpp_def___i386__=no
+else case e in #(
+  e) ac_cv_cpp_def___i386__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___i386__" >&5
 printf "%s\n" "$ac_cv_cpp_def___i386__" >&6; }
@@ -20751,22 +23250,24 @@ printf %s "checking whether we need to define __x86_64__... " >&6; }
 if test ${ac_cv_cpp_def___x86_64__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __x86_64__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___x86_64__=yes
-else $as_nop
-  ac_cv_cpp_def___x86_64__=no
+else case e in #(
+  e) ac_cv_cpp_def___x86_64__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___x86_64__" >&5
 printf "%s\n" "$ac_cv_cpp_def___x86_64__" >&6; }
@@ -20780,22 +23281,24 @@ printf %s "checking whether we need to define __sparc64__... " >&6; }
 if test ${ac_cv_cpp_def___sparc64__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __sparc64__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___sparc64__=yes
-else $as_nop
-  ac_cv_cpp_def___sparc64__=no
+else case e in #(
+  e) ac_cv_cpp_def___sparc64__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___sparc64__" >&5
 printf "%s\n" "$ac_cv_cpp_def___sparc64__" >&6; }
@@ -20809,22 +23312,24 @@ printf %s "checking whether we need to define __sparc__... " >&6; }
 if test ${ac_cv_cpp_def___sparc__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __sparc__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___sparc__=yes
-else $as_nop
-  ac_cv_cpp_def___sparc__=no
+else case e in #(
+  e) ac_cv_cpp_def___sparc__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___sparc__" >&5
 printf "%s\n" "$ac_cv_cpp_def___sparc__" >&6; }
@@ -20838,22 +23343,24 @@ printf %s "checking whether we need to define __powerpc64__... " >&6; }
 if test ${ac_cv_cpp_def___powerpc64__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __powerpc64__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___powerpc64__=yes
-else $as_nop
-  ac_cv_cpp_def___powerpc64__=no
+else case e in #(
+  e) ac_cv_cpp_def___powerpc64__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___powerpc64__" >&5
 printf "%s\n" "$ac_cv_cpp_def___powerpc64__" >&6; }
@@ -20867,22 +23374,24 @@ printf %s "checking whether we need to define __powerpc__... " >&6; }
 if test ${ac_cv_cpp_def___powerpc__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __powerpc__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___powerpc__=yes
-else $as_nop
-  ac_cv_cpp_def___powerpc__=no
+else case e in #(
+  e) ac_cv_cpp_def___powerpc__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___powerpc__" >&5
 printf "%s\n" "$ac_cv_cpp_def___powerpc__" >&6; }
@@ -20896,22 +23405,24 @@ printf %s "checking whether we need to define __aarch64__... " >&6; }
 if test ${ac_cv_cpp_def___aarch64__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __aarch64__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___aarch64__=yes
-else $as_nop
-  ac_cv_cpp_def___aarch64__=no
+else case e in #(
+  e) ac_cv_cpp_def___aarch64__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___aarch64__" >&5
 printf "%s\n" "$ac_cv_cpp_def___aarch64__" >&6; }
@@ -20925,22 +23436,24 @@ printf %s "checking whether we need to define __arm__... " >&6; }
 if test ${ac_cv_cpp_def___arm__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __arm__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___arm__=yes
-else $as_nop
-  ac_cv_cpp_def___arm__=no
+else case e in #(
+  e) ac_cv_cpp_def___arm__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___arm__" >&5
 printf "%s\n" "$ac_cv_cpp_def___arm__" >&6; }
@@ -20957,22 +23470,24 @@ printf %s "checking whether we need to define __sun__... " >&6; }
 if test ${ac_cv_cpp_def___sun__+y}
 then :
   printf %s "(cached) " >&6
-else $as_nop
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+else case e in #(
+  e) cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 #ifndef __sun__
 yes
 #endif
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "yes" >/dev/null 2>&1
+  $EGREP_TRADITIONAL "yes" >/dev/null 2>&1
 then :
   ac_cv_cpp_def___sun__=yes
-else $as_nop
-  ac_cv_cpp_def___sun__=no
+else case e in #(
+  e) ac_cv_cpp_def___sun__=no ;;
+esac
 fi
 rm -rf conftest*
-
+ ;;
+esac
 fi
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cpp_def___sun__" >&5
 printf "%s\n" "$ac_cv_cpp_def___sun__" >&6; }
@@ -20999,7 +23514,7 @@ test "$srcdir" = . || wine_srcdir="$srcdir/"
 
 ac_config_links="$ac_config_links wine:tools/winewrapper"
 wine_fn_config_symlink wine
-if test "$HOST_ARCH" = x86_64 -o -n "$with_wine64"; then
+if test "$wine_binary" = wine64 -o -n "$with_wine64"; then
 ac_config_links="$ac_config_links wine64:tools/winewrapper"
 wine_fn_config_symlink wine64
 fi
@@ -21018,12 +23533,15 @@ wine_fn_config_makefile dlls/advapi32/tests enable_tests
 wine_fn_config_makefile dlls/advpack enable_advpack
 wine_fn_config_makefile dlls/advpack/tests enable_tests
 wine_fn_config_makefile dlls/amsi enable_amsi
+wine_fn_config_makefile dlls/amd_ags_x64 enable_amd_ags_x64
 wine_fn_config_makefile dlls/amstream enable_amstream
 wine_fn_config_makefile dlls/amstream/tests enable_tests
 wine_fn_config_makefile dlls/apisetschema enable_apisetschema
 wine_fn_config_makefile dlls/apphelp enable_apphelp
 wine_fn_config_makefile dlls/apphelp/tests enable_tests
 wine_fn_config_makefile dlls/appwiz.cpl enable_appwiz_cpl
+wine_fn_config_makefile dlls/appxdeploymentclient enable_appxdeploymentclient
+wine_fn_config_makefile dlls/atiadlxx enable_atiadlxx
 wine_fn_config_makefile dlls/atl enable_atl
 wine_fn_config_makefile dlls/atl/tests enable_tests
 wine_fn_config_makefile dlls/atl100 enable_atl100
@@ -21036,6 +23554,7 @@ wine_fn_config_makefile dlls/atl90 enable_atl90
 wine_fn_config_makefile dlls/atlthunk enable_atlthunk
 wine_fn_config_makefile dlls/atlthunk/tests enable_tests
 wine_fn_config_makefile dlls/atmlib enable_atmlib
+wine_fn_config_makefile dlls/audioses enable_audioses
 wine_fn_config_makefile dlls/authz enable_authz
 wine_fn_config_makefile dlls/avicap32 enable_avicap32
 wine_fn_config_makefile dlls/avifil32 enable_avifil32
@@ -21044,6 +23563,7 @@ wine_fn_config_makefile dlls/avifile.dll16 enable_win16
 wine_fn_config_makefile dlls/avrt enable_avrt
 wine_fn_config_makefile dlls/bcrypt enable_bcrypt
 wine_fn_config_makefile dlls/bcrypt/tests enable_tests
+wine_fn_config_makefile dlls/bcryptprimitives enable_bcryptprimitives
 wine_fn_config_makefile dlls/bluetoothapis enable_bluetoothapis
 wine_fn_config_makefile dlls/browseui enable_browseui
 wine_fn_config_makefile dlls/browseui/tests enable_tests
@@ -21054,6 +23574,7 @@ wine_fn_config_makefile dlls/capi2032 enable_capi2032
 wine_fn_config_makefile dlls/cards enable_cards
 wine_fn_config_makefile dlls/cdosys enable_cdosys
 wine_fn_config_makefile dlls/cfgmgr32 enable_cfgmgr32
+wine_fn_config_makefile dlls/cfgmgr32/tests enable_tests
 wine_fn_config_makefile dlls/clusapi enable_clusapi
 wine_fn_config_makefile dlls/cng.sys enable_cng_sys
 wine_fn_config_makefile dlls/combase enable_combase
@@ -21064,6 +23585,7 @@ wine_fn_config_makefile dlls/comctl32 enable_comctl32
 wine_fn_config_makefile dlls/comctl32/tests enable_tests
 wine_fn_config_makefile dlls/comdlg32 enable_comdlg32
 wine_fn_config_makefile dlls/comdlg32/tests enable_tests
+wine_fn_config_makefile dlls/coml2 enable_coml2
 wine_fn_config_makefile dlls/comm.drv16 enable_win16
 wine_fn_config_makefile dlls/commdlg.dll16 enable_win16
 wine_fn_config_makefile dlls/compobj.dll16 enable_win16
@@ -21086,6 +23608,7 @@ wine_fn_config_makefile dlls/cryptext/tests enable_tests
 wine_fn_config_makefile dlls/cryptnet enable_cryptnet
 wine_fn_config_makefile dlls/cryptnet/tests enable_tests
 wine_fn_config_makefile dlls/cryptowinrt enable_cryptowinrt
+wine_fn_config_makefile dlls/cryptowinrt/tests enable_tests
 wine_fn_config_makefile dlls/cryptsp enable_cryptsp
 wine_fn_config_makefile dlls/cryptui enable_cryptui
 wine_fn_config_makefile dlls/cryptui/tests enable_tests
@@ -21105,6 +23628,7 @@ wine_fn_config_makefile dlls/d3d11 enable_d3d11
 wine_fn_config_makefile dlls/d3d11/tests enable_tests
 wine_fn_config_makefile dlls/d3d12 enable_d3d12
 wine_fn_config_makefile dlls/d3d12/tests enable_tests
+wine_fn_config_makefile dlls/d3d12core enable_d3d12core
 wine_fn_config_makefile dlls/d3d8 enable_d3d8
 wine_fn_config_makefile dlls/d3d8/tests enable_tests
 wine_fn_config_makefile dlls/d3d8thk enable_d3d8thk
@@ -21254,10 +23778,13 @@ wine_fn_config_makefile dlls/dwmapi/tests enable_tests
 wine_fn_config_makefile dlls/dwrite enable_dwrite
 wine_fn_config_makefile dlls/dwrite/tests enable_tests
 wine_fn_config_makefile dlls/dx8vb enable_dx8vb
+wine_fn_config_makefile dlls/dxcore enable_dxcore
 wine_fn_config_makefile dlls/dxdiagn enable_dxdiagn
 wine_fn_config_makefile dlls/dxdiagn/tests enable_tests
 wine_fn_config_makefile dlls/dxgi enable_dxgi
 wine_fn_config_makefile dlls/dxgi/tests enable_tests
+wine_fn_config_makefile dlls/dxgkrnl.sys enable_dxgkrnl_sys
+wine_fn_config_makefile dlls/dxgmms1.sys enable_dxgmms1_sys
 wine_fn_config_makefile dlls/dxtrans enable_dxtrans
 wine_fn_config_makefile dlls/dxva2 enable_dxva2
 wine_fn_config_makefile dlls/dxva2/tests enable_tests
@@ -21284,9 +23811,13 @@ wine_fn_config_makefile dlls/gdi32 enable_gdi32
 wine_fn_config_makefile dlls/gdi32/tests enable_tests
 wine_fn_config_makefile dlls/gdiplus enable_gdiplus
 wine_fn_config_makefile dlls/gdiplus/tests enable_tests
+wine_fn_config_makefile dlls/geolocation enable_geolocation
+wine_fn_config_makefile dlls/geolocation/tests enable_tests
 wine_fn_config_makefile dlls/glu32 enable_glu32
 wine_fn_config_makefile dlls/gphoto2.ds enable_gphoto2_ds
 wine_fn_config_makefile dlls/gpkcsp enable_gpkcsp
+wine_fn_config_makefile dlls/graphicscapture enable_graphicscapture
+wine_fn_config_makefile dlls/graphicscapture/tests enable_tests
 wine_fn_config_makefile dlls/hal enable_hal
 wine_fn_config_makefile dlls/hhctrl.ocx enable_hhctrl_ocx
 wine_fn_config_makefile dlls/hid enable_hid
@@ -21297,9 +23828,12 @@ wine_fn_config_makefile dlls/hlink enable_hlink
 wine_fn_config_makefile dlls/hlink/tests enable_tests
 wine_fn_config_makefile dlls/hnetcfg enable_hnetcfg
 wine_fn_config_makefile dlls/hnetcfg/tests enable_tests
+wine_fn_config_makefile dlls/hrtfapo enable_hrtfapo
 wine_fn_config_makefile dlls/http.sys enable_http_sys
 wine_fn_config_makefile dlls/httpapi enable_httpapi
 wine_fn_config_makefile dlls/httpapi/tests enable_tests
+wine_fn_config_makefile dlls/hvsimanagementapi enable_hvsimanagementapi
+wine_fn_config_makefile dlls/hvsimanagementapi/tests enable_tests
 wine_fn_config_makefile dlls/ia2comproxy enable_ia2comproxy
 wine_fn_config_makefile dlls/iccvid enable_iccvid
 wine_fn_config_makefile dlls/icmp enable_icmp
@@ -21356,6 +23890,7 @@ wine_fn_config_makefile dlls/localui/tests enable_tests
 wine_fn_config_makefile dlls/lz32 enable_lz32
 wine_fn_config_makefile dlls/lz32/tests enable_tests
 wine_fn_config_makefile dlls/lzexpand.dll16 enable_win16
+wine_fn_config_makefile dlls/magnification enable_magnification
 wine_fn_config_makefile dlls/mapi32 enable_mapi32
 wine_fn_config_makefile dlls/mapi32/tests enable_tests
 wine_fn_config_makefile dlls/mapistub enable_mapistub
@@ -21405,6 +23940,7 @@ wine_fn_config_makefile dlls/msado15/tests enable_tests
 wine_fn_config_makefile dlls/msadp32.acm enable_msadp32_acm
 wine_fn_config_makefile dlls/msasn1 enable_msasn1
 wine_fn_config_makefile dlls/msasn1/tests enable_tests
+wine_fn_config_makefile dlls/msauddecmft enable_msauddecmft
 wine_fn_config_makefile dlls/mscat32 enable_mscat32
 wine_fn_config_makefile dlls/mscms enable_mscms
 wine_fn_config_makefile dlls/mscms/tests enable_tests
@@ -21438,6 +23974,7 @@ wine_fn_config_makefile dlls/msimtf enable_msimtf
 wine_fn_config_makefile dlls/msisip enable_msisip
 wine_fn_config_makefile dlls/msisys.ocx enable_msisys_ocx
 wine_fn_config_makefile dlls/msls31 enable_msls31
+wine_fn_config_makefile dlls/msmpeg2vdec enable_msmpeg2vdec
 wine_fn_config_makefile dlls/msnet32 enable_msnet32
 wine_fn_config_makefile dlls/mspatcha enable_mspatcha
 wine_fn_config_makefile dlls/mspatcha/tests enable_tests
@@ -21450,6 +23987,7 @@ wine_fn_config_makefile dlls/mssign32 enable_mssign32
 wine_fn_config_makefile dlls/mssip32 enable_mssip32
 wine_fn_config_makefile dlls/mstask enable_mstask
 wine_fn_config_makefile dlls/mstask/tests enable_tests
+wine_fn_config_makefile dlls/msttsengine enable_msttsengine
 wine_fn_config_makefile dlls/msv1_0 enable_msv1_0
 wine_fn_config_makefile dlls/msvcirt enable_msvcirt
 wine_fn_config_makefile dlls/msvcirt/tests enable_tests
@@ -21469,6 +24007,7 @@ wine_fn_config_makefile dlls/msvcp140_1/tests enable_tests
 wine_fn_config_makefile dlls/msvcp140_2 enable_msvcp140_2
 wine_fn_config_makefile dlls/msvcp140_atomic_wait enable_msvcp140_atomic_wait
 wine_fn_config_makefile dlls/msvcp140_atomic_wait/tests enable_tests
+wine_fn_config_makefile dlls/msvcp140_codecvt_ids enable_msvcp140_codecvt_ids
 wine_fn_config_makefile dlls/msvcp60 enable_msvcp60
 wine_fn_config_makefile dlls/msvcp60/tests enable_tests
 wine_fn_config_makefile dlls/msvcp70 enable_msvcp70
@@ -21508,7 +24047,9 @@ wine_fn_config_makefile dlls/msxml2 enable_msxml2
 wine_fn_config_makefile dlls/msxml3 enable_msxml3
 wine_fn_config_makefile dlls/msxml3/tests enable_tests
 wine_fn_config_makefile dlls/msxml4 enable_msxml4
+wine_fn_config_makefile dlls/msxml4/tests enable_tests
 wine_fn_config_makefile dlls/msxml6 enable_msxml6
+wine_fn_config_makefile dlls/msxml6/tests enable_tests
 wine_fn_config_makefile dlls/mtxdm enable_mtxdm
 wine_fn_config_makefile dlls/ncrypt enable_ncrypt
 wine_fn_config_makefile dlls/ncrypt/tests enable_tests
@@ -21540,6 +24081,7 @@ wine_fn_config_makefile dlls/ntoskrnl.exe enable_ntoskrnl_exe
 wine_fn_config_makefile dlls/ntoskrnl.exe/tests enable_tests
 wine_fn_config_makefile dlls/ntprint enable_ntprint
 wine_fn_config_makefile dlls/ntprint/tests enable_tests
+wine_fn_config_makefile dlls/nvcuda enable_nvcuda
 wine_fn_config_makefile dlls/objsel enable_objsel
 wine_fn_config_makefile dlls/odbc32 enable_odbc32
 wine_fn_config_makefile dlls/odbcbcp enable_odbcbcp
@@ -21631,6 +24173,7 @@ wine_fn_config_makefile dlls/sapi enable_sapi
 wine_fn_config_makefile dlls/sapi/tests enable_tests
 wine_fn_config_makefile dlls/sas enable_sas
 wine_fn_config_makefile dlls/scarddlg enable_scarddlg
+wine_fn_config_makefile dlls/scardsvr enable_scardsvr
 wine_fn_config_makefile dlls/sccbase enable_sccbase
 wine_fn_config_makefile dlls/schannel enable_schannel
 wine_fn_config_makefile dlls/schannel/tests enable_tests
@@ -21653,6 +24196,7 @@ wine_fn_config_makefile dlls/setupapi/tests enable_tests
 wine_fn_config_makefile dlls/setupx.dll16 enable_win16
 wine_fn_config_makefile dlls/sfc enable_sfc
 wine_fn_config_makefile dlls/sfc_os enable_sfc_os
+wine_fn_config_makefile dlls/sharedgpures.sys enable_sharedgpures_sys
 wine_fn_config_makefile dlls/shcore enable_shcore
 wine_fn_config_makefile dlls/shcore/tests enable_tests
 wine_fn_config_makefile dlls/shdoclc enable_shdoclc
@@ -21676,6 +24220,7 @@ wine_fn_config_makefile dlls/spoolss/tests enable_tests
 wine_fn_config_makefile dlls/sppc enable_sppc
 wine_fn_config_makefile dlls/srclient enable_srclient
 wine_fn_config_makefile dlls/srvcli enable_srvcli
+wine_fn_config_makefile dlls/srvsvc enable_srvsvc
 wine_fn_config_makefile dlls/sspicli enable_sspicli
 wine_fn_config_makefile dlls/stdole2.tlb enable_stdole2_tlb
 wine_fn_config_makefile dlls/stdole32.tlb enable_stdole32_tlb
@@ -21704,6 +24249,8 @@ wine_fn_config_makefile dlls/traffic enable_traffic
 wine_fn_config_makefile dlls/twain.dll16 enable_win16
 wine_fn_config_makefile dlls/twain_32 enable_twain_32
 wine_fn_config_makefile dlls/twain_32/tests enable_tests
+wine_fn_config_makefile dlls/twinapi.appcore enable_twinapi_appcore
+wine_fn_config_makefile dlls/twinapi.appcore/tests enable_tests
 wine_fn_config_makefile dlls/typelib.dll16 enable_win16
 wine_fn_config_makefile dlls/tzres enable_tzres
 wine_fn_config_makefile dlls/ucrtbase enable_ucrtbase
@@ -21775,14 +24322,21 @@ wine_fn_config_makefile dlls/wevtsvc enable_wevtsvc
 wine_fn_config_makefile dlls/wiaservc enable_wiaservc
 wine_fn_config_makefile dlls/wiaservc/tests enable_tests
 wine_fn_config_makefile dlls/wimgapi enable_wimgapi
+wine_fn_config_makefile dlls/win32k.sys enable_win32k_sys
 wine_fn_config_makefile dlls/win32s16.dll16 enable_win16
 wine_fn_config_makefile dlls/win32u enable_win32u
 wine_fn_config_makefile dlls/win32u/tests enable_tests
 wine_fn_config_makefile dlls/win87em.dll16 enable_win16
 wine_fn_config_makefile dlls/winaspi.dll16 enable_win16
 wine_fn_config_makefile dlls/windebug.dll16 enable_win16
+wine_fn_config_makefile dlls/windows.applicationmodel enable_windows_applicationmodel
+wine_fn_config_makefile dlls/windows.applicationmodel/tests enable_tests
+wine_fn_config_makefile dlls/windows.devices.bluetooth enable_windows_devices_bluetooth
+wine_fn_config_makefile dlls/windows.devices.bluetooth/tests enable_tests
 wine_fn_config_makefile dlls/windows.devices.enumeration enable_windows_devices_enumeration
 wine_fn_config_makefile dlls/windows.devices.enumeration/tests enable_tests
+wine_fn_config_makefile dlls/windows.devices.usb enable_windows_devices_usb
+wine_fn_config_makefile dlls/windows.devices.usb/tests enable_tests
 wine_fn_config_makefile dlls/windows.gaming.input enable_windows_gaming_input
 wine_fn_config_makefile dlls/windows.gaming.input/tests enable_tests
 wine_fn_config_makefile dlls/windows.gaming.ui.gamebar enable_windows_gaming_ui_gamebar
@@ -21791,11 +24345,26 @@ wine_fn_config_makefile dlls/windows.globalization enable_windows_globalization
 wine_fn_config_makefile dlls/windows.globalization/tests enable_tests
 wine_fn_config_makefile dlls/windows.media.devices enable_windows_media_devices
 wine_fn_config_makefile dlls/windows.media.devices/tests enable_tests
+wine_fn_config_makefile dlls/windows.media.mediacontrol enable_windows_media_mediacontrol
+wine_fn_config_makefile dlls/windows.media.mediacontrol/tests enable_tests
 wine_fn_config_makefile dlls/windows.media.speech enable_windows_media_speech
 wine_fn_config_makefile dlls/windows.media.speech/tests enable_tests
 wine_fn_config_makefile dlls/windows.media enable_windows_media
 wine_fn_config_makefile dlls/windows.media/tests enable_tests
+wine_fn_config_makefile dlls/windows.networking.hostname enable_windows_networking_hostname
+wine_fn_config_makefile dlls/windows.networking.hostname/tests enable_tests
 wine_fn_config_makefile dlls/windows.networking enable_windows_networking
+wine_fn_config_makefile dlls/windows.networking.connectivity enable_windows_networking_connectivity
+wine_fn_config_makefile dlls/windows.perception.stub enable_windows_perception_stub
+wine_fn_config_makefile dlls/windows.perception.stub/tests enable_tests
+wine_fn_config_makefile dlls/windows.security.credentials.ui.userconsentverifier enable_windows_security_credentials_ui_userconsentverifier
+wine_fn_config_makefile dlls/windows.security.credentials.ui.userconsentverifier/tests enable_tests
+wine_fn_config_makefile dlls/windows.storage.applicationdata enable_windows_storage_applicationdata
+wine_fn_config_makefile dlls/windows.storage.applicationdata/tests enable_tests
+wine_fn_config_makefile dlls/windows.system.profile.systemmanufacturers enable_windows_system_profile_systemmanufacturers
+wine_fn_config_makefile dlls/windows.system.profile.systemmanufacturers/tests enable_tests
+wine_fn_config_makefile dlls/windows.ui enable_windows_ui
+wine_fn_config_makefile dlls/windows.ui/tests enable_tests
 wine_fn_config_makefile dlls/windowscodecs enable_windowscodecs
 wine_fn_config_makefile dlls/windowscodecs/tests enable_tests
 wine_fn_config_makefile dlls/windowscodecsext enable_windowscodecsext
@@ -21816,6 +24385,7 @@ wine_fn_config_makefile dlls/wineps16.drv16 enable_win16
 wine_fn_config_makefile dlls/winepulse.drv enable_winepulse_drv
 wine_fn_config_makefile dlls/wineusb.sys enable_wineusb_sys
 wine_fn_config_makefile dlls/winevulkan enable_winevulkan
+wine_fn_config_makefile dlls/winewayland.drv enable_winewayland_drv
 wine_fn_config_makefile dlls/winex11.drv enable_winex11_drv
 wine_fn_config_makefile dlls/winexinput.sys enable_winexinput_sys
 wine_fn_config_makefile dlls/wing.dll16 enable_win16
@@ -21830,6 +24400,7 @@ wine_fn_config_makefile dlls/winnls.dll16 enable_win16
 wine_fn_config_makefile dlls/winnls32 enable_winnls32
 wine_fn_config_makefile dlls/winprint enable_winprint
 wine_fn_config_makefile dlls/winscard enable_winscard
+wine_fn_config_makefile dlls/winscard/tests enable_tests
 wine_fn_config_makefile dlls/winsock.dll16 enable_win16
 wine_fn_config_makefile dlls/winspool.drv enable_winspool_drv
 wine_fn_config_makefile dlls/winspool.drv/tests enable_tests
@@ -21847,6 +24418,8 @@ wine_fn_config_makefile dlls/wlanapi/tests enable_tests
 wine_fn_config_makefile dlls/wlanui enable_wlanui
 wine_fn_config_makefile dlls/wldap32 enable_wldap32
 wine_fn_config_makefile dlls/wldap32/tests enable_tests
+wine_fn_config_makefile dlls/wldp enable_wldp
+wine_fn_config_makefile dlls/wldp/tests enable_tests
 wine_fn_config_makefile dlls/wmasf enable_wmasf
 wine_fn_config_makefile dlls/wmi enable_wmi
 wine_fn_config_makefile dlls/wmiutils enable_wmiutils
@@ -21865,6 +24438,7 @@ wine_fn_config_makefile dlls/wow64win enable_wow64win
 wine_fn_config_makefile dlls/wpc enable_wpc
 wine_fn_config_makefile dlls/wpc/tests enable_tests
 wine_fn_config_makefile dlls/wpcap enable_wpcap
+wine_fn_config_makefile dlls/wpcap/tests enable_tests
 wine_fn_config_makefile dlls/ws2_32 enable_ws2_32
 wine_fn_config_makefile dlls/ws2_32/tests enable_tests
 wine_fn_config_makefile dlls/wsdapi enable_wsdapi
@@ -21914,6 +24488,7 @@ wine_fn_config_makefile dlls/xaudio2_6 enable_xaudio2_6
 wine_fn_config_makefile dlls/xaudio2_7 enable_xaudio2_7
 wine_fn_config_makefile dlls/xaudio2_7/tests enable_tests
 wine_fn_config_makefile dlls/xaudio2_8 enable_xaudio2_8
+wine_fn_config_makefile dlls/xaudio2_8/tests enable_tests
 wine_fn_config_makefile dlls/xaudio2_9 enable_xaudio2_9
 wine_fn_config_makefile dlls/xinput1_1 enable_xinput1_1
 wine_fn_config_makefile dlls/xinput1_2 enable_xinput1_2
@@ -21935,6 +24510,7 @@ wine_fn_config_makefile libs/dxerr8 enable_dxerr8
 wine_fn_config_makefile libs/dxerr9 enable_dxerr9
 wine_fn_config_makefile libs/dxguid enable_dxguid
 wine_fn_config_makefile libs/faudio enable_faudio
+wine_fn_config_makefile libs/fluidsynth enable_fluidsynth
 wine_fn_config_makefile libs/gsm enable_gsm
 wine_fn_config_makefile libs/jpeg enable_jpeg
 wine_fn_config_makefile libs/jxr enable_jxr
@@ -21942,6 +24518,7 @@ wine_fn_config_makefile libs/lcms2 enable_lcms2
 wine_fn_config_makefile libs/ldap enable_ldap
 wine_fn_config_makefile libs/mfuuid enable_mfuuid
 wine_fn_config_makefile libs/mpg123 enable_mpg123
+wine_fn_config_makefile libs/musl enable_musl
 wine_fn_config_makefile libs/png enable_png
 wine_fn_config_makefile libs/strmbase enable_strmbase
 wine_fn_config_makefile libs/strmiids enable_strmiids
@@ -21949,17 +24526,18 @@ wine_fn_config_makefile libs/tiff enable_tiff
 wine_fn_config_makefile libs/uuid enable_uuid
 wine_fn_config_makefile libs/vkd3d enable_vkd3d
 wine_fn_config_makefile libs/wbemuuid enable_wbemuuid
-wine_fn_config_makefile libs/wine enable_wine
 wine_fn_config_makefile libs/wmcodecdspuuid enable_wmcodecdspuuid
 wine_fn_config_makefile libs/xml2 enable_xml2
 wine_fn_config_makefile libs/xslt enable_xslt
 wine_fn_config_makefile libs/zlib enable_zlib
+wine_fn_config_makefile libs/zydis enable_zydis
 wine_fn_config_makefile loader enable_loader
 wine_fn_config_makefile nls enable_nls
 wine_fn_config_makefile po enable_po
 wine_fn_config_makefile programs/arp enable_arp
 wine_fn_config_makefile programs/aspnet_regiis enable_aspnet_regiis
 wine_fn_config_makefile programs/attrib enable_attrib
+wine_fn_config_makefile programs/belauncher enable_belauncher
 wine_fn_config_makefile programs/cabarc enable_cabarc
 wine_fn_config_makefile programs/cacls enable_cacls
 wine_fn_config_makefile programs/certutil enable_certutil
@@ -21974,6 +24552,7 @@ wine_fn_config_makefile programs/cscript enable_cscript
 wine_fn_config_makefile programs/dism enable_dism
 wine_fn_config_makefile programs/dllhost enable_dllhost
 wine_fn_config_makefile programs/dplaysvr enable_dplaysvr
+wine_fn_config_makefile programs/dotnetfx35 enable_dotnetfx35
 wine_fn_config_makefile programs/dpnsvr enable_dpnsvr
 wine_fn_config_makefile programs/dpvsetup enable_dpvsetup
 wine_fn_config_makefile programs/dxdiag enable_dxdiag
@@ -21986,14 +24565,17 @@ wine_fn_config_makefile programs/fc enable_fc
 wine_fn_config_makefile programs/find enable_find
 wine_fn_config_makefile programs/find/tests enable_tests
 wine_fn_config_makefile programs/findstr enable_findstr
+wine_fn_config_makefile programs/findstr/tests enable_tests
 wine_fn_config_makefile programs/fsutil enable_fsutil
 wine_fn_config_makefile programs/fsutil/tests enable_tests
+wine_fn_config_makefile programs/getminidump enable_getminidump
 wine_fn_config_makefile programs/hh enable_hh
 wine_fn_config_makefile programs/hostname enable_hostname
 wine_fn_config_makefile programs/icacls enable_icacls
 wine_fn_config_makefile programs/icinfo enable_icinfo
 wine_fn_config_makefile programs/iexplore enable_iexplore
 wine_fn_config_makefile programs/ipconfig enable_ipconfig
+wine_fn_config_makefile programs/klist enable_klist
 wine_fn_config_makefile programs/lodctr enable_lodctr
 wine_fn_config_makefile programs/mofcomp enable_mofcomp
 wine_fn_config_makefile programs/mshta enable_mshta
@@ -22008,6 +24590,7 @@ wine_fn_config_makefile programs/notepad enable_notepad
 wine_fn_config_makefile programs/oleview enable_oleview
 wine_fn_config_makefile programs/ping enable_ping
 wine_fn_config_makefile programs/plugplay enable_plugplay
+wine_fn_config_makefile programs/pnputil enable_pnputil
 wine_fn_config_makefile programs/powershell enable_powershell
 wine_fn_config_makefile programs/presentationfontcache enable_presentationfontcache
 wine_fn_config_makefile programs/progman enable_progman
@@ -22039,8 +24622,10 @@ wine_fn_config_makefile programs/start enable_start
 wine_fn_config_makefile programs/subst enable_subst
 wine_fn_config_makefile programs/svchost enable_svchost
 wine_fn_config_makefile programs/systeminfo enable_systeminfo
+wine_fn_config_makefile programs/tabtip enable_tabtip
 wine_fn_config_makefile programs/taskkill enable_taskkill
 wine_fn_config_makefile programs/tasklist enable_tasklist
+wine_fn_config_makefile programs/tasklist/tests enable_tests
 wine_fn_config_makefile programs/taskmgr enable_taskmgr
 wine_fn_config_makefile programs/termsv enable_termsv
 wine_fn_config_makefile programs/uninstaller enable_uninstaller
@@ -22208,7 +24793,7 @@ maintainer-clean::
 
 as_fn_append wine_rules "
 dlls/ntdll/unix/version.c: dummy
-	@version=\`(GIT_DIR=${wine_srcdir}.git git describe HEAD 2>/dev/null || echo \"wine-\$(PACKAGE_VERSION)\") | sed -n -e '\$\$s/\(.*\)/const char wine_build[] = \"\\1\";/p'\` && (echo \$\$version | cmp -s - \$@) || echo \$\$version >\$@ || (rm -f \$@ && exit 1)
+	@version=\`(GIT_DIR=${wine_srcdir}.git git describe HEAD 2>/dev/null || echo \"wine-\$(PACKAGE_VERSION)\") | sed -n -e '\$\$s/\(.*\)/const char wine_build[] = \"\\1 (Staging)\";/p'\` && (echo \$\$version | cmp -s - \$@) || echo \$\$version >\$@ || (rm -f \$@ && exit 1)
 programs/winetest/build.rc: dummy
 	@build=\"STRINGTABLE { 1 \\\"\`GIT_DIR=${wine_srcdir}.git git rev-parse HEAD 2>/dev/null\`\\\" }\" && (echo \$\$build | cmp -s - \$@) || echo \$\$build >\$@ || (rm -f \$@ && exit 1)
 programs/winetest/build.nfo:
@@ -22241,8 +24826,8 @@ cat >confcache <<\_ACEOF
 # config.status only pays attention to the cache file if you give it
 # the --recheck option to rerun configure.
 #
-# `ac_cv_env_foo' variables (set or unset) will be overridden when
-# loading this file, other *unset* `ac_cv_foo' will be assigned the
+# 'ac_cv_env_foo' variables (set or unset) will be overridden when
+# loading this file, other *unset* 'ac_cv_foo' will be assigned the
 # following values.
 
 _ACEOF
@@ -22272,14 +24857,14 @@ printf "%s\n" "$as_me: WARNING: cache variable $ac_var contains a newline" >&2;}
   (set) 2>&1 |
     case $as_nl`(ac_space=' '; set) 2>&1` in #(
     *${as_nl}ac_space=\ *)
-      # `set' does not quote correctly, so add quotes: double-quote
+      # 'set' does not quote correctly, so add quotes: double-quote
       # substitution turns \\\\ into \\, and sed turns \\ into \.
       sed -n \
 	"s/'/'\\\\''/g;
 	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
       ;; #(
     *)
-      # `set' quotes correctly as required by POSIX, so do not add quotes.
+      # 'set' quotes correctly as required by POSIX, so do not add quotes.
       sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
       ;;
     esac |
@@ -22340,6 +24925,12 @@ LIBOBJS=$ac_libobjs
 LTLIBOBJS=$ac_ltlibobjs
 
 
+# Check whether --enable-year2038 was given.
+if test ${enable_year2038+y}
+then :
+  enableval=$enable_year2038;
+fi
+
 
 : "${CONFIG_STATUS=./config.status}"
 ac_write_fail=0
@@ -22369,7 +24960,6 @@ cat >>$CONFIG_STATUS <<\_ASEOF || as_write_fail=1
 
 # Be more Bourne compatible
 DUALCASE=1; export DUALCASE # for MKS sh
-as_nop=:
 if test ${ZSH_VERSION+y} && (emulate sh) >/dev/null 2>&1
 then :
   emulate sh
@@ -22378,12 +24968,13 @@ then :
   # is contrary to our usage.  Disable this feature.
   alias -g '${1+"$@"}'='"$@"'
   setopt NO_GLOB_SUBST
-else $as_nop
-  case `(set -o) 2>/dev/null` in #(
+else case e in #(
+  e) case `(set -o) 2>/dev/null` in #(
   *posix*) :
     set -o posix ;; #(
   *) :
      ;;
+esac ;;
 esac
 fi
 
@@ -22455,7 +25046,7 @@ IFS=$as_save_IFS
 
      ;;
 esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
+# We did not find ourselves, most probably we were run as 'sh COMMAND'
 # in which case we are not to be found in the path.
 if test "x$as_myself" = x; then
   as_myself=$0
@@ -22484,7 +25075,6 @@ as_fn_error ()
 } # as_fn_error
 
 
-
 # as_fn_set_status STATUS
 # -----------------------
 # Set $? to STATUS, without forking.
@@ -22524,11 +25114,12 @@ then :
   {
     eval $1+=\$2
   }'
-else $as_nop
-  as_fn_append ()
+else case e in #(
+  e) as_fn_append ()
   {
     eval $1=\$$1\$2
-  }
+  } ;;
+esac
 fi # as_fn_append
 
 # as_fn_arith ARG...
@@ -22542,11 +25133,12 @@ then :
   {
     as_val=$(( $* ))
   }'
-else $as_nop
-  as_fn_arith ()
+else case e in #(
+  e) as_fn_arith ()
   {
     as_val=`expr "$@" || test $? -eq 1`
-  }
+  } ;;
+esac
 fi # as_fn_arith
 
 
@@ -22629,9 +25221,9 @@ if (echo >conf$$.file) 2>/dev/null; then
   if ln -s conf$$.file conf$$ 2>/dev/null; then
     as_ln_s='ln -s'
     # ... but there are two gotchas:
-    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-    # In both cases, we have to default to `cp -pR'.
+    # 1) On MSYS, both 'ln -s file dir' and 'ln file dir' fail.
+    # 2) DJGPP < 2.04 has no symlinks; 'ln -s' creates a wrapper executable.
+    # In both cases, we have to default to 'cp -pR'.
     ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
       as_ln_s='cp -pR'
   elif ln conf$$.file conf$$ 2>/dev/null; then
@@ -22712,10 +25304,12 @@ as_test_x='test -x'
 as_executable_p=as_fn_executable_p
 
 # Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
+as_sed_cpp="y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g"
+as_tr_cpp="eval sed '$as_sed_cpp'" # deprecated
 
 # Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
+as_sed_sh="y%*+%pp%;s%[^_$as_cr_alnum]%_%g"
+as_tr_sh="eval sed '$as_sed_sh'" # deprecated
 
 
 exec 6>&1
@@ -22730,8 +25324,8 @@ cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by Wine $as_me 8.0, which was
-generated by GNU Autoconf 2.71.  Invocation command line was
+This file was extended by Wine $as_me 9.0, which was
+generated by GNU Autoconf 2.72.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
@@ -22760,7 +25354,7 @@ _ACEOF
 
 cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
 ac_cs_usage="\
-\`$as_me' instantiates files and other configuration actions
+'$as_me' instantiates files and other configuration actions
 from templates according to the current configuration.  Unless the files
 and actions are specified as TAGs, all are instantiated by default.
 
@@ -22794,11 +25388,11 @@ ac_cs_config_escaped=`printf "%s\n" "$ac_cs_config" | sed "s/^ //; s/'/'\\\\\\\\
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config='$ac_cs_config_escaped'
 ac_cs_version="\\
-Wine config.status 8.0
-configured by $0, generated by GNU Autoconf 2.71,
+Wine config.status 9.0
+configured by $0, generated by GNU Autoconf 2.72,
   with options \\"\$ac_cs_config\\"
 
-Copyright (C) 2021 Free Software Foundation, Inc.
+Copyright (C) 2023 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
 
@@ -22849,8 +25443,8 @@ do
     ac_need_defaults=false;;
   --he | --h)
     # Conflict between --help and --header
-    as_fn_error $? "ambiguous option: \`$1'
-Try \`$0 --help' for more information.";;
+    as_fn_error $? "ambiguous option: '$1'
+Try '$0 --help' for more information.";;
   --help | --hel | -h )
     printf "%s\n" "$ac_cs_usage"; exit ;;
   -q | -quiet | --quiet | --quie | --qui | --qu | --q \
@@ -22858,8 +25452,8 @@ Try \`$0 --help' for more information.";;
     ac_cs_silent=: ;;
 
   # This is an error.
-  -*) as_fn_error $? "unrecognized option: \`$1'
-Try \`$0 --help' for more information." ;;
+  -*) as_fn_error $? "unrecognized option: '$1'
+Try '$0 --help' for more information." ;;
 
   *) as_fn_append ac_config_targets " $1"
      ac_need_defaults=false ;;
@@ -22905,7 +25499,7 @@ cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 wine_fn_output_makedep ()
 {
     as_dir=tools; as_fn_mkdir_p
-    $CC -I${wine_srcdir}tools -Iinclude -I${wine_srcdir}include -D__WINESRC__ $EXTRACFLAGS $CPPFLAGS $CFLAGS -o tools/makedep$ac_exeext ${wine_srcdir}tools/makedep.c $LDFLAGS
+    $CC -I${wine_srcdir}tools -Iinclude -I${wine_srcdir}include -D__WINESRC__ -DWINE_UNIX_LIB $EXTRACFLAGS $CPPFLAGS $CFLAGS -o tools/makedep$ac_exeext ${wine_srcdir}tools/makedep.c $LDFLAGS
 }
 wine_fn_output_makefile ()
 {
@@ -23008,6 +25602,14 @@ arm_DEBUG = $arm_DEBUG
 arm_TARGET = $arm_TARGET
 arm_DELAYLOADFLAG = $arm_DELAYLOADFLAG
 arm_DISABLED_SUBDIRS = $arm_DISABLED_SUBDIRS
+arm64ec_CC = $arm64ec_CC
+arm64ec_CFLAGS = $arm64ec_CFLAGS
+arm64ec_EXTRACFLAGS = $arm64ec_EXTRACFLAGS
+arm64ec_LDFLAGS = $arm64ec_LDFLAGS
+arm64ec_DEBUG = $arm64ec_DEBUG
+arm64ec_TARGET = $arm64ec_TARGET
+arm64ec_DELAYLOADFLAG = $arm64ec_DELAYLOADFLAG
+arm64ec_DISABLED_SUBDIRS = $arm64ec_DISABLED_SUBDIRS
 i386_CC = $i386_CC
 i386_CFLAGS = $i386_CFLAGS
 i386_EXTRACFLAGS = $i386_EXTRACFLAGS
@@ -23056,6 +25658,7 @@ TOP_INSTALL_LIB = $TOP_INSTALL_LIB
 TOP_INSTALL_DEV = $TOP_INSTALL_DEV
 WINELOADER_LDFLAGS = $WINELOADER_LDFLAGS
 WINEPRELOADER_LDFLAGS = $WINEPRELOADER_LDFLAGS
+DLLEXT = $DLLEXT
 LDD = $LDD
 OTOOL = $OTOOL
 READELF = $READELF
@@ -23077,15 +25680,14 @@ OPENCL_LIBS = $OPENCL_LIBS
 OBJC = $OBJC
 OBJCFLAGS = $OBJCFLAGS
 ac_ct_OBJC = $ac_ct_OBJC
-LIBWINE_SHAREDLIB = $LIBWINE_SHAREDLIB
-LIBWINE_LDFLAGS = $LIBWINE_LDFLAGS
 WINELOADER_DEPENDS = $WINELOADER_DEPENDS
-PRELINK = $PRELINK
-LIBWINE_DEPENDS = $LIBWINE_DEPENDS
 PE_ARCHS = $PE_ARCHS
+MSHTML_CFLAGS = $MSHTML_CFLAGS
 MINGW_PKG_CONFIG = $MINGW_PKG_CONFIG
 FAUDIO_PE_CFLAGS = $FAUDIO_PE_CFLAGS
 FAUDIO_PE_LIBS = $FAUDIO_PE_LIBS
+FLUIDSYNTH_PE_CFLAGS = $FLUIDSYNTH_PE_CFLAGS
+FLUIDSYNTH_PE_LIBS = $FLUIDSYNTH_PE_LIBS
 GSM_PE_CFLAGS = $GSM_PE_CFLAGS
 GSM_PE_LIBS = $GSM_PE_LIBS
 JPEG_PE_CFLAGS = $JPEG_PE_CFLAGS
@@ -23098,6 +25700,8 @@ LDAP_PE_CFLAGS = $LDAP_PE_CFLAGS
 LDAP_PE_LIBS = $LDAP_PE_LIBS
 MPG123_PE_CFLAGS = $MPG123_PE_CFLAGS
 MPG123_PE_LIBS = $MPG123_PE_LIBS
+MUSL_PE_CFLAGS = $MUSL_PE_CFLAGS
+MUSL_PE_LIBS = $MUSL_PE_LIBS
 PNG_PE_CFLAGS = $PNG_PE_CFLAGS
 PNG_PE_LIBS = $PNG_PE_LIBS
 TIFF_PE_CFLAGS = $TIFF_PE_CFLAGS
@@ -23110,6 +25714,8 @@ XSLT_PE_CFLAGS = $XSLT_PE_CFLAGS
 XSLT_PE_LIBS = $XSLT_PE_LIBS
 ZLIB_PE_CFLAGS = $ZLIB_PE_CFLAGS
 ZLIB_PE_LIBS = $ZLIB_PE_LIBS
+ZYDIS_PE_CFLAGS = $ZYDIS_PE_CFLAGS
+ZYDIS_PE_LIBS = $ZYDIS_PE_LIBS
 PTHREAD_LIBS = $PTHREAD_LIBS
 XMKMF = $XMKMF
 CPP = $CPP
@@ -23117,13 +25723,27 @@ X_CFLAGS = $X_CFLAGS
 X_PRE_LIBS = $X_PRE_LIBS
 X_LIBS = $X_LIBS
 X_EXTRA_LIBS = $X_EXTRA_LIBS
+WAYLAND_CLIENT_CFLAGS = $WAYLAND_CLIENT_CFLAGS
+WAYLAND_CLIENT_LIBS = $WAYLAND_CLIENT_LIBS
+WAYLAND_SCANNER = $WAYLAND_SCANNER
+XKBCOMMON_CFLAGS = $XKBCOMMON_CFLAGS
+XKBCOMMON_LIBS = $XKBCOMMON_LIBS
+XKBREGISTRY_CFLAGS = $XKBREGISTRY_CFLAGS
+XKBREGISTRY_LIBS = $XKBREGISTRY_LIBS
 PCAP_LIBS = $PCAP_LIBS
+PCSCLITE_LIBS = $PCSCLITE_LIBS
 INOTIFY_CFLAGS = $INOTIFY_CFLAGS
 INOTIFY_LIBS = $INOTIFY_LIBS
 DBUS_CFLAGS = $DBUS_CFLAGS
 DBUS_LIBS = $DBUS_LIBS
 GNUTLS_CFLAGS = $GNUTLS_CFLAGS
 GNUTLS_LIBS = $GNUTLS_LIBS
+DRM_CFLAGS = $DRM_CFLAGS
+DRM_LIBS = $DRM_LIBS
+DRMAMDGPU_CFLAGS = $DRMAMDGPU_CFLAGS
+DRMAMDGPU_LIBS = $DRMAMDGPU_LIBS
+GMP_CFLAGS = $GMP_CFLAGS
+GMP_LIBS = $GMP_LIBS
 SANE_CFLAGS = $SANE_CFLAGS
 SANE_LIBS = $SANE_LIBS
 USB_CFLAGS = $USB_CFLAGS
@@ -23162,6 +25782,8 @@ GSSAPI_LIBS = $GSSAPI_LIBS
 PROCSTAT_LIBS = $PROCSTAT_LIBS
 NETAPI_CFLAGS = $NETAPI_CFLAGS
 NETAPI_LIBS = $NETAPI_LIBS
+GCRYPT_CFLAGS = $GCRYPT_CFLAGS
+GCRYPT_LIBS = $GCRYPT_LIBS
 MSVCRTFLAGS = $MSVCRTFLAGS
 DELAYLOADFLAG = $DELAYLOADFLAG
 WINELOADER_PROGRAMS = $WINELOADER_PROGRAMS
@@ -23190,7 +25812,7 @@ do
     "tools/makedep") CONFIG_COMMANDS="$CONFIG_COMMANDS tools/makedep" ;;
     "Makefile") CONFIG_COMMANDS="$CONFIG_COMMANDS Makefile" ;;
 
-  *) as_fn_error $? "invalid argument: \`$ac_config_target'" "$LINENO" 5;;
+  *) as_fn_error $? "invalid argument: '$ac_config_target'" "$LINENO" 5;;
   esac
 done
 
@@ -23210,7 +25832,7 @@ fi
 # creating and moving files from /tmp can sometimes cause problems.
 # Hook for its removal unless debugging.
 # Note that there is a small window in which the directory will not be cleaned:
-# after its creation but before its name has been assigned to `$tmp'.
+# after its creation but before its name has been assigned to '$tmp'.
 $debug ||
 {
   tmp= ac_tmp=
@@ -23234,13 +25856,13 @@ ac_tmp=$tmp
 
 # Set up the scripts for CONFIG_HEADERS section.
 # No need to generate them if there are no CONFIG_HEADERS.
-# This happens for instance with `./config.status Makefile'.
+# This happens for instance with './config.status Makefile'.
 if test -n "$CONFIG_HEADERS"; then
 cat >"$ac_tmp/defines.awk" <<\_ACAWK ||
 BEGIN {
 _ACEOF
 
-# Transform confdefs.h into an awk script `defines.awk', embedded as
+# Transform confdefs.h into an awk script 'defines.awk', embedded as
 # here-document in config.status, that substitutes the proper values into
 # config.h.in to produce config.h.
 
@@ -23350,7 +25972,7 @@ do
   esac
   case $ac_mode$ac_tag in
   :[FHL]*:*);;
-  :L* | :C*:*) as_fn_error $? "invalid tag \`$ac_tag'" "$LINENO" 5;;
+  :L* | :C*:*) as_fn_error $? "invalid tag '$ac_tag'" "$LINENO" 5;;
   :[FH]-) ac_tag=-:-;;
   :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
   esac
@@ -23372,19 +25994,19 @@ do
       -) ac_f="$ac_tmp/stdin";;
       *) # Look for the file first in the build tree, then in the source tree
 	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
-	 # because $ac_f cannot contain `:'.
+	 # because $ac_f cannot contain ':'.
 	 test -f "$ac_f" ||
 	   case $ac_f in
 	   [\\/$]*) false;;
 	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
 	   esac ||
-	   as_fn_error 1 "cannot find input file: \`$ac_f'" "$LINENO" 5;;
+	   as_fn_error 1 "cannot find input file: '$ac_f'" "$LINENO" 5;;
       esac
       case $ac_f in *\'*) ac_f=`printf "%s\n" "$ac_f" | sed "s/'/'\\\\\\\\''/g"`;; esac
       as_fn_append ac_file_inputs " '$ac_f'"
     done
 
-    # Let's still pretend it is `configure' which instantiates (i.e., don't
+    # Let's still pretend it is 'configure' which instantiates (i.e., don't
     # use $as_me), people would be surprised to read:
     #    /* config.h.  Generated by config.status.  */
     configure_input='Generated from '`
@@ -23590,9 +26212,10 @@ if test "x$wine_notices" != x; then
         if ${msg:+false} :
 then :
 
-else $as_nop
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: $msg" >&5
-printf "%s\n" "$as_me: $msg" >&6;}
+else case e in #(
+  e) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: $msg" >&5
+printf "%s\n" "$as_me: $msg" >&6;} ;;
+esac
 fi
     done
 fi
@@ -23602,10 +26225,11 @@ for msg in $wine_warnings; do
     if ${msg:+false} :
 then :
 
-else $as_nop
-  echo >&2
+else case e in #(
+  e) echo >&2
         { printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: $msg" >&5
-printf "%s\n" "$as_me: WARNING: $msg" >&2;}
+printf "%s\n" "$as_me: WARNING: $msg" >&2;} ;;
+esac
 fi
 done
 IFS="$ac_save_IFS"
diff --git a/dlls/vcomp100/vcomp100.spec b/dlls/vcomp100/vcomp100.spec
index fb67146e058..9aa43e3ba4b 100644
--- a/dlls/vcomp100/vcomp100.spec
+++ b/dlls/vcomp100/vcomp100.spec
@@ -56,9 +56,9 @@
 @ cdecl _vcomp_enter_critsect(ptr)
 @ cdecl _vcomp_flush()
 @ cdecl _vcomp_for_dynamic_init(long long long long long)
-@ stub _vcomp_for_dynamic_init_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_init_i8(int64 int64 int64 int64 int64) vcomp._vcomp_for_dynamic_init_i8
 @ cdecl _vcomp_for_dynamic_next(ptr ptr)
-@ stub _vcomp_for_dynamic_next_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_next_i8(ptr ptr) vcomp._vcomp_for_dynamic_next_i8
 @ cdecl _vcomp_for_static_end()
 @ cdecl _vcomp_for_static_init(long long long long ptr ptr ptr ptr ptr)
 @ cdecl _vcomp_for_static_init_i8(int64 int64 int64 int64 ptr ptr ptr ptr ptr)
@@ -96,7 +96,7 @@
 @ cdecl omp_get_num_procs()
 @ cdecl omp_get_num_threads()
 @ cdecl omp_get_thread_num()
-@ stub omp_get_wtick
+@ cdecl omp_get_wtick() vcomp.omp_get_wtick
 @ cdecl omp_get_wtime()
 @ cdecl omp_in_parallel()
 @ cdecl omp_init_lock(ptr)
diff --git a/dlls/vcomp110/vcomp110.spec b/dlls/vcomp110/vcomp110.spec
index e1cb8ab9931..d8b4d3e3f16 100644
--- a/dlls/vcomp110/vcomp110.spec
+++ b/dlls/vcomp110/vcomp110.spec
@@ -57,9 +57,9 @@
 @ cdecl _vcomp_enter_critsect(ptr)
 @ cdecl _vcomp_flush()
 @ cdecl _vcomp_for_dynamic_init(long long long long long)
-@ stub _vcomp_for_dynamic_init_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_init_i8(int64 int64 int64 int64 int64) vcomp._vcomp_for_dynamic_init_i8
 @ cdecl _vcomp_for_dynamic_next(ptr ptr)
-@ stub _vcomp_for_dynamic_next_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_next_i8(ptr ptr) vcomp._vcomp_for_dynamic_next_i8
 @ cdecl _vcomp_for_static_end()
 @ cdecl _vcomp_for_static_init(long long long long ptr ptr ptr ptr ptr)
 @ cdecl _vcomp_for_static_init_i8(int64 int64 int64 int64 ptr ptr ptr ptr ptr)
@@ -97,7 +97,7 @@
 @ cdecl omp_get_num_procs()
 @ cdecl omp_get_num_threads()
 @ cdecl omp_get_thread_num()
-@ stub omp_get_wtick
+@ cdecl omp_get_wtick() vcomp.omp_get_wtick
 @ cdecl omp_get_wtime()
 @ cdecl omp_in_parallel()
 @ cdecl omp_init_lock(ptr)
diff --git a/dlls/vcomp120/vcomp120.spec b/dlls/vcomp120/vcomp120.spec
index e1cb8ab9931..d8b4d3e3f16 100644
--- a/dlls/vcomp120/vcomp120.spec
+++ b/dlls/vcomp120/vcomp120.spec
@@ -57,9 +57,9 @@
 @ cdecl _vcomp_enter_critsect(ptr)
 @ cdecl _vcomp_flush()
 @ cdecl _vcomp_for_dynamic_init(long long long long long)
-@ stub _vcomp_for_dynamic_init_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_init_i8(int64 int64 int64 int64 int64) vcomp._vcomp_for_dynamic_init_i8
 @ cdecl _vcomp_for_dynamic_next(ptr ptr)
-@ stub _vcomp_for_dynamic_next_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_next_i8(ptr ptr) vcomp._vcomp_for_dynamic_next_i8
 @ cdecl _vcomp_for_static_end()
 @ cdecl _vcomp_for_static_init(long long long long ptr ptr ptr ptr ptr)
 @ cdecl _vcomp_for_static_init_i8(int64 int64 int64 int64 ptr ptr ptr ptr ptr)
@@ -97,7 +97,7 @@
 @ cdecl omp_get_num_procs()
 @ cdecl omp_get_num_threads()
 @ cdecl omp_get_thread_num()
-@ stub omp_get_wtick
+@ cdecl omp_get_wtick() vcomp.omp_get_wtick
 @ cdecl omp_get_wtime()
 @ cdecl omp_in_parallel()
 @ cdecl omp_init_lock(ptr)
diff --git a/dlls/vcomp140/vcomp140.spec b/dlls/vcomp140/vcomp140.spec
index e1cb8ab9931..d8b4d3e3f16 100644
--- a/dlls/vcomp140/vcomp140.spec
+++ b/dlls/vcomp140/vcomp140.spec
@@ -57,9 +57,9 @@
 @ cdecl _vcomp_enter_critsect(ptr)
 @ cdecl _vcomp_flush()
 @ cdecl _vcomp_for_dynamic_init(long long long long long)
-@ stub _vcomp_for_dynamic_init_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_init_i8(int64 int64 int64 int64 int64) vcomp._vcomp_for_dynamic_init_i8
 @ cdecl _vcomp_for_dynamic_next(ptr ptr)
-@ stub _vcomp_for_dynamic_next_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_next_i8(ptr ptr) vcomp._vcomp_for_dynamic_next_i8
 @ cdecl _vcomp_for_static_end()
 @ cdecl _vcomp_for_static_init(long long long long ptr ptr ptr ptr ptr)
 @ cdecl _vcomp_for_static_init_i8(int64 int64 int64 int64 ptr ptr ptr ptr ptr)
@@ -97,7 +97,7 @@
 @ cdecl omp_get_num_procs()
 @ cdecl omp_get_num_threads()
 @ cdecl omp_get_thread_num()
-@ stub omp_get_wtick
+@ cdecl omp_get_wtick() vcomp.omp_get_wtick
 @ cdecl omp_get_wtime()
 @ cdecl omp_in_parallel()
 @ cdecl omp_init_lock(ptr)
diff --git a/dlls/vcomp90/vcomp90.spec b/dlls/vcomp90/vcomp90.spec
index 9fac400ea0e..563f5391ed9 100644
--- a/dlls/vcomp90/vcomp90.spec
+++ b/dlls/vcomp90/vcomp90.spec
@@ -56,9 +56,9 @@
 @ cdecl _vcomp_enter_critsect(ptr) vcomp._vcomp_enter_critsect
 @ cdecl _vcomp_flush() vcomp._vcomp_flush
 @ cdecl _vcomp_for_dynamic_init(long long long long long) vcomp._vcomp_for_dynamic_init
-@ stub _vcomp_for_dynamic_init_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_init_i8(int64 int64 int64 int64 int64) vcomp._vcomp_for_dynamic_init_i8
 @ cdecl _vcomp_for_dynamic_next(ptr ptr) vcomp._vcomp_for_dynamic_next
-@ stub _vcomp_for_dynamic_next_i8
+@ cdecl -arch=win64 _vcomp_for_dynamic_next_i8(ptr ptr) vcomp._vcomp_for_dynamic_next_i8
 @ cdecl _vcomp_for_static_end() vcomp._vcomp_for_static_end
 @ cdecl _vcomp_for_static_init(long long long long ptr ptr ptr ptr ptr) vcomp._vcomp_for_static_init
 @ cdecl _vcomp_for_static_init_i8(int64 int64 int64 int64 ptr ptr ptr ptr ptr) vcomp._vcomp_for_static_init_i8
@@ -96,7 +96,7 @@
 @ cdecl omp_get_num_procs() vcomp.omp_get_num_procs
 @ cdecl omp_get_num_threads() vcomp.omp_get_num_threads
 @ cdecl omp_get_thread_num() vcomp.omp_get_thread_num
-@ stub omp_get_wtick
+@ cdecl omp_get_wtick() vcomp.omp_get_wtick
 @ cdecl omp_get_wtime() vcomp.omp_get_wtime
 @ cdecl omp_in_parallel() vcomp.omp_in_parallel
 @ cdecl omp_init_lock(ptr) vcomp.omp_init_lock
diff --git a/dlls/win32k.sys/win32k.sys.spec b/dlls/win32k.sys/win32k.sys.spec
index c79439151e4..c36733b5932 100644
--- a/dlls/win32k.sys/win32k.sys.spec
+++ b/dlls/win32k.sys/win32k.sys.spec
@@ -194,22 +194,22 @@
 @ stub PATHOBJ_vGetBounds
 @ stdcall RtlAnsiCharToUnicodeChar(ptr) ntoskrnl.exe.RtlAnsiCharToUnicodeChar
 @ stdcall -norelay RtlCaptureContext(ptr) ntoskrnl.exe.RtlCaptureContext
-@ stdcall -arch=x86_64 RtlCopyMemory(ptr ptr long) ntoskrnl.exe.RtlCopyMemory
-@ stub RtlCopyMemoryNonTemporal
+@ stdcall -arch=!i386 RtlCopyMemory(ptr ptr long) ntoskrnl.exe.RtlCopyMemory
+@ stdcall -arch=x86_64 RtlCopyMemoryNonTemporal(ptr ptr long) ntoskrnl.exe.RtlCopyMemoryNonTemporal
 @ stdcall RtlFillMemory(ptr long long) ntoskrnl.exe.RtlFillMemory
-@ stub RtlLookupFunctionEntry
+@ stdcall -arch=!i386 RtlLookupFunctionEntry(long ptr ptr) ntoskrnl.exe.RtlLookupFunctionEntry
 @ stdcall RtlMoveMemory(ptr ptr long) ntoskrnl.exe.RtlMoveMemory
 @ stdcall RtlMultiByteToUnicodeN(ptr long ptr ptr long) ntoskrnl.exe.RtlMultiByteToUnicodeN
-@ stub RtlPcToFileHeader
+@ stdcall RtlPcToFileHeader(ptr ptr) ntoskrnl.exe.RtlPcToFileHeader
 @ stdcall -norelay RtlRaiseException(ptr) ntoskrnl.exe.RtlRaiseException
-@ stub RtlRestoreContext
+@ cdecl -arch=!i386 RtlRestoreContext(ptr ptr) ntoskrnl.exe.RtlRestoreContext
 @ stdcall RtlUnicodeToMultiByteN(ptr long ptr ptr long) ntoskrnl.exe.RtlUnicodeToMultiByteN
 @ stdcall RtlUnicodeToMultiByteSize(ptr ptr long) ntoskrnl.exe.RtlUnicodeToMultiByteSize
 @ stdcall -norelay RtlUnwind(ptr ptr ptr ptr) ntoskrnl.exe.RtlUnwind
-@ stdcall -arch=x86_64 RtlUnwindEx(ptr ptr ptr ptr ptr ptr) ntoskrnl.exe.RtlUnwindEx
+@ stdcall -arch=!i386 RtlUnwindEx(ptr ptr ptr ptr ptr ptr) ntoskrnl.exe.RtlUnwindEx
 @ stdcall RtlUpcaseUnicodeChar(long) ntoskrnl.exe.RtlUpcaseUnicodeChar
 @ stdcall RtlUpcaseUnicodeToMultiByteN(ptr long ptr ptr long) ntoskrnl.exe.RtlUpcaseUnicodeToMultiByteN
-@ stub RtlVirtualUnwind
+@ stdcall -arch=!i386 RtlVirtualUnwind(long long long ptr ptr ptr ptr ptr) ntoskrnl.exe.RtlVirtualUnwind
 @ stdcall RtlZeroMemory(ptr long) ntoskrnl.exe.RtlZeroMemory
 @ stub STROBJ_bEnum
 @ stub STROBJ_bEnumPositionsOnly
@@ -232,15 +232,15 @@
 @ stub XLATEOBJ_hGetColorTransform
 @ stub XLATEOBJ_iXlate
 @ stub XLATEOBJ_piVector
-@ stub __C_specific_handler
-@ stub __chkstk
+@ stdcall -arch=!i386 __C_specific_handler(ptr long ptr ptr) ntoskrnl.exe.__C_specific_handler
+@ cdecl -arch=!i386 -norelay __chkstk() ntoskrnl.exe.__chkstk
 @ cdecl -private _itoa(long ptr long) ntoskrnl.exe._itoa
 @ cdecl -private _itow(long ptr long) ntoskrnl.exe._itow
-@ cdecl -private -arch=x86_64 _local_unwind(ptr ptr) ntoskrnl.exe._local_unwind
-@ stub _setjmp
-@ stub _setjmpex
-@ stub longjmp
-@ stub memcmp
+@ cdecl -private -arch=win64 _local_unwind(ptr ptr) ntoskrnl.exe._local_unwind
+@ cdecl -norelay _setjmp(ptr) ntoskrnl.exe._setjmp
+@ cdecl -arch=!i386 -norelay _setjmpex(ptr ptr) ntoskrnl.exe._setjmpex
+@ cdecl longjmp(ptr long) ntoskrnl.exe.longjmp
+@ cdecl memcmp(ptr ptr long) ntoskrnl.exe.memcmp
 @ cdecl -private memcpy(ptr ptr long) ntoskrnl.exe.memcpy
 @ cdecl -private memmove(ptr ptr long) ntoskrnl.exe.memmove
 @ cdecl -private memset(ptr long long) ntoskrnl.exe.memset
diff --git a/include/config.h.in b/include/config.h.in
index 0e43013a8ab..b488966bff1 100644
--- a/include/config.h.in
+++ b/include/config.h.in
@@ -6,6 +6,9 @@
 /* Define to the file extension for executables. */
 #undef EXEEXT
 
+/* Define to 1 if you have the <amdgpu_drm.h> header file. */
+#undef HAVE_AMDGPU_DRM_H
+
 /* Define to 1 if you have the <arpa/inet.h> header file. */
 #undef HAVE_ARPA_INET_H
 
@@ -33,10 +36,10 @@
 /* Define to 1 if you have the <cups/ppd.h> header file. */
 #undef HAVE_CUPS_PPD_H
 
-/* Define to 1 if you have the `dladdr1' function. */
+/* Define to 1 if you have the 'dladdr1' function. */
 #undef HAVE_DLADDR1
 
-/* Define to 1 if you have the `dlinfo' function. */
+/* Define to 1 if you have the 'dlinfo' function. */
 #undef HAVE_DLINFO
 
 /* Define to 1 if you have the <EGL/egl.h> header file. */
@@ -45,55 +48,58 @@
 /* Define to 1 if you have the <elf.h> header file. */
 #undef HAVE_ELF_H
 
-/* Define to 1 if you have the `epoll_create' function. */
+/* Define to 1 if you have the 'epoll_create' function. */
 #undef HAVE_EPOLL_CREATE
 
 /* Define to 1 if you have the <float.h> header file. */
 #undef HAVE_FLOAT_H
 
-/* Define to 1 if you have the <fontconfig/fontconfig.h> header file. */
-#undef HAVE_FONTCONFIG_FONTCONFIG_H
-
 /* Define if FreeType 2 is installed */
 #undef HAVE_FREETYPE
 
-/* Define to 1 if you have the `fstatfs' function. */
+/* Define to 1 if you have the 'fstatfs' function. */
 #undef HAVE_FSTATFS
 
 /* Define to 1 if you have the <ft2build.h> header file. */
 #undef HAVE_FT2BUILD_H
 
-/* Define to 1 if the system has the type `FT_TrueTypeEngineType'. */
+/* Define to 1 if the system has the type 'FT_TrueTypeEngineType'. */
 #undef HAVE_FT_TRUETYPEENGINETYPE
 
-/* Define to 1 if you have the `futimens' function. */
+/* Define to 1 if you have the 'futimens' function. */
 #undef HAVE_FUTIMENS
 
-/* Define to 1 if you have the `futimes' function. */
+/* Define to 1 if you have the 'futimes' function. */
 #undef HAVE_FUTIMES
 
-/* Define to 1 if you have the `futimesat' function. */
+/* Define to 1 if you have the 'futimesat' function. */
 #undef HAVE_FUTIMESAT
 
-/* Define to 1 if you have the `getaddrinfo' function. */
+/* Define to 1 if you have the <gcrypt.h> header file. */
+#undef HAVE_GCRYPT_H
+
+/* Define to 1 if you have the 'getaddrinfo' function. */
 #undef HAVE_GETADDRINFO
 
-/* Define to 1 if you have the `getattrlist' function. */
+/* Define to 1 if you have the 'getattrlist' function. */
 #undef HAVE_GETATTRLIST
 
-/* Define to 1 if you have the `getauxval' function. */
+/* Define to 1 if you have the 'getauxval' function. */
 #undef HAVE_GETAUXVAL
 
-/* Define to 1 if you have the `getifaddrs' function. */
+/* Define to 1 if you have the 'getifaddrs' function. */
 #undef HAVE_GETIFADDRS
 
-/* Define to 1 if you have the `getrandom' function. */
+/* Define to 1 if you have the 'getrandom' function. */
 #undef HAVE_GETRANDOM
 
 /* Define to 1 if you have the <gettext-po.h> header file. */
 #undef HAVE_GETTEXT_PO_H
 
-/* Define to 1 if you have the `gnutls_cipher_init' function. */
+/* Define to 1 if you have the <gmp.h> header file. */
+#undef HAVE_GMP_H
+
+/* Define to 1 if you have the 'gnutls_cipher_init' function. */
 #undef HAVE_GNUTLS_CIPHER_INIT
 
 /* Define if we have the libgphoto2_port development environment */
@@ -111,7 +117,7 @@
 /* Define to 1 if you have the <inttypes.h> header file. */
 #undef HAVE_INTTYPES_H
 
-/* Define to 1 if you have the `kqueue' function. */
+/* Define to 1 if you have the 'kqueue' function. */
 #undef HAVE_KQUEUE
 
 /* Define to 1 if you have the <krb5/krb5.h> header file. */
@@ -126,9 +132,6 @@
 /* Define to 1 if you have the <libprocstat.h> header file. */
 #undef HAVE_LIBPROCSTAT_H
 
-/* Define to 1 if you have the <libproc.h> header file. */
-#undef HAVE_LIBPROC_H
-
 /* Define to 1 if you have the <libudev.h> header file. */
 #undef HAVE_LIBUDEV_H
 
@@ -153,6 +156,9 @@
 /* Define to 1 if you have the <linux/filter.h> header file. */
 #undef HAVE_LINUX_FILTER_H
 
+/* Define to 1 if you have the <linux/futex.h> header file. */
+#undef HAVE_LINUX_FUTEX_H
+
 /* Define if Linux-style gethostbyname_r and gethostbyaddr_r are available */
 #undef HAVE_LINUX_GETHOSTBYNAME_R_6
 
@@ -183,6 +189,9 @@
 /* Define to 1 if you have the <linux/rtnetlink.h> header file. */
 #undef HAVE_LINUX_RTNETLINK_H
 
+/* Define to 1 if you have the <linux/seccomp.h> header file. */
+#undef HAVE_LINUX_SECCOMP_H
+
 /* Define to 1 if you have the <linux/serial.h> header file. */
 #undef HAVE_LINUX_SERIAL_H
 
@@ -195,6 +204,9 @@
 /* Define to 1 if you have the <linux/videodev2.h> header file. */
 #undef HAVE_LINUX_VIDEODEV2_H
 
+/* Define to 1 if you have the <linux/wireless.h> header file. */
+#undef HAVE_LINUX_WIRELESS_H
+
 /* Define to 1 if you have the <lwp.h> header file. */
 #undef HAVE_LWP_H
 
@@ -204,7 +216,7 @@
 /* Define to 1 if you have the <machine/sysarch.h> header file. */
 #undef HAVE_MACHINE_SYSARCH_H
 
-/* Define to 1 if you have the `mach_continuous_time' function. */
+/* Define to 1 if you have the 'mach_continuous_time' function. */
 #undef HAVE_MACH_CONTINUOUS_TIME
 
 /* Define to 1 if you have the <mach/mach.h> header file. */
@@ -213,6 +225,9 @@
 /* Define to 1 if you have the <mach-o/loader.h> header file. */
 #undef HAVE_MACH_O_LOADER_H
 
+/* Define to 1 if you have the 'memfd_create' function. */
+#undef HAVE_MEMFD_CREATE
+
 /* Define to 1 if you have the <mntent.h> header file. */
 #undef HAVE_MNTENT_H
 
@@ -288,49 +303,43 @@
 /* Define to 1 if you have the <OpenCL/opencl.h> header file. */
 #undef HAVE_OPENCL_OPENCL_H
 
-/* Define to 1 if `numaudioengines' is a member of `oss_sysinfo'. */
+/* Define to 1 if 'numaudioengines' is a member of 'oss_sysinfo'. */
 #undef HAVE_OSS_SYSINFO_NUMAUDIOENGINES
 
 /* Define to 1 if you have the <pcap/pcap.h> header file. */
 #undef HAVE_PCAP_PCAP_H
 
-/* Define to 1 if you have the `pipe2' function. */
+/* Define to 1 if you have the 'pipe2' function. */
 #undef HAVE_PIPE2
 
-/* Define to 1 if you have the `port_create' function. */
+/* Define to 1 if you have the 'port_create' function. */
 #undef HAVE_PORT_CREATE
 
 /* Define to 1 if you have the <port.h> header file. */
 #undef HAVE_PORT_H
 
-/* Define to 1 if you have the `posix_fadvise' function. */
+/* Define to 1 if you have the 'posix_fadvise' function. */
 #undef HAVE_POSIX_FADVISE
 
-/* Define to 1 if you have the `posix_fallocate' function. */
+/* Define to 1 if you have the 'posix_fallocate' function. */
 #undef HAVE_POSIX_FALLOCATE
 
-/* Define to 1 if you have the `prctl' function. */
-#undef HAVE_PRCTL
+/* Define to 1 if you have the 'ppoll' function. */
+#undef HAVE_PPOLL
 
-/* Define to 1 if you have the `proc_pidinfo' function. */
-#undef HAVE_PROC_PIDINFO
+/* Define to 1 if you have the 'prctl' function. */
+#undef HAVE_PRCTL
 
-/* Define to 1 if you have the `pthread_getthreadid_np' function. */
+/* Define to 1 if you have the 'pthread_getthreadid_np' function. */
 #undef HAVE_PTHREAD_GETTHREADID_NP
 
-/* Define to 1 if you have the <pthread.h> header file. */
-#undef HAVE_PTHREAD_H
-
 /* Define to 1 if you have the <pthread_np.h> header file. */
 #undef HAVE_PTHREAD_NP_H
 
-/* Define to 1 if you have the <pulse/pulseaudio.h> header file. */
-#undef HAVE_PULSE_PULSEAUDIO_H
-
 /* Define to 1 if you have the <pwd.h> header file. */
 #undef HAVE_PWD_H
 
-/* Define to 1 if the system has the type `request_sense'. */
+/* Define to 1 if the system has the type 'request_sense'. */
 #undef HAVE_REQUEST_SENSE
 
 /* Define if you have the resolver library and header */
@@ -348,10 +357,10 @@
 /* Define to 1 if you have the `sched_setaffinity' function. */
 #undef HAVE_SCHED_SETAFFINITY
 
-/* Define to 1 if you have the `sched_yield' function. */
+/* Define to 1 if you have the 'sched_yield' function. */
 #undef HAVE_SCHED_YIELD
 
-/* Define to 1 if `cmd' is a member of `scsireq_t'. */
+/* Define to 1 if 'cmd' is a member of 'scsireq_t'. */
 #undef HAVE_SCSIREQ_T_CMD
 
 /* Define to 1 if you have the <scsi/scsi.h> header file. */
@@ -366,27 +375,27 @@
 /* Define to 1 if you have the <SDL.h> header file. */
 #undef HAVE_SDL_H
 
-/* Define to 1 if you have the `setproctitle' function. */
+/* Define to 1 if you have the `setpriority' function. */
+#undef HAVE_SETPRIORITY
+
+/* Define to 1 if you have the 'setproctitle' function. */
 #undef HAVE_SETPROCTITLE
 
-/* Define to 1 if you have the `setprogname' function. */
+/* Define to 1 if you have the 'setprogname' function. */
 #undef HAVE_SETPROGNAME
 
-/* Define to 1 if `interface_id' is a member of `sg_io_hdr_t'. */
+/* Define to 1 if 'interface_id' is a member of 'sg_io_hdr_t'. */
 #undef HAVE_SG_IO_HDR_T_INTERFACE_ID
 
-/* Define if sigaddset is supported */
-#undef HAVE_SIGADDSET
+/* Define to 1 if you have the `shm_open' function. */
+#undef HAVE_SHM_OPEN
 
-/* Define to 1 if `si_fd' is a member of `siginfo_t'. */
+/* Define to 1 if 'si_fd' is a member of 'siginfo_t'. */
 #undef HAVE_SIGINFO_T_SI_FD
 
-/* Define to 1 if you have the `sigprocmask' function. */
+/* Define to 1 if you have the 'sigprocmask' function. */
 #undef HAVE_SIGPROCMASK
 
-/* Define to 1 if the system has the type `sigset_t'. */
-#undef HAVE_SIGSET_T
-
 /* Define to 1 if you have the <stdint.h> header file. */
 #undef HAVE_STDINT_H
 
@@ -402,103 +411,100 @@
 /* Define to 1 if you have the <string.h> header file. */
 #undef HAVE_STRING_H
 
-/* Define to 1 if `icp6s_error' is a member of `struct icmp6stat'. */
+/* Define to 1 if 'icp6s_error' is a member of 'struct icmp6stat'. */
 #undef HAVE_STRUCT_ICMP6STAT_ICP6S_ERROR
 
-/* Define to 1 if `icps_error' is a member of `struct icmpstat'. */
+/* Define to 1 if 'icps_error' is a member of 'struct icmpstat'. */
 #undef HAVE_STRUCT_ICMPSTAT_ICPS_ERROR
 
-/* Define to 1 if `ifr_hwaddr' is a member of `struct ifreq'. */
+/* Define to 1 if 'ifr_hwaddr' is a member of 'struct ifreq'. */
 #undef HAVE_STRUCT_IFREQ_IFR_HWADDR
 
-/* Define to 1 if `ipi6_addr' is a member of `struct in6_pktinfo'. */
+/* Define to 1 if 'ipi6_addr' is a member of 'struct in6_pktinfo'. */
 #undef HAVE_STRUCT_IN6_PKTINFO_IPI6_ADDR
 
-/* Define to 1 if `ip6s_total' is a member of `struct ip6stat'. */
+/* Define to 1 if 'ip6s_total' is a member of 'struct ip6stat'. */
 #undef HAVE_STRUCT_IP6STAT_IP6S_TOTAL
 
-/* Define to 1 if `ips_total' is a member of `struct ipstat'. */
+/* Define to 1 if 'ips_total' is a member of 'struct ipstat'. */
 #undef HAVE_STRUCT_IPSTAT_IPS_TOTAL
 
-/* Define to 1 if `ips_total' is a member of `struct ip_stats'. */
+/* Define to 1 if 'ips_total' is a member of 'struct ip_stats'. */
 #undef HAVE_STRUCT_IP_STATS_IPS_TOTAL
 
-/* Define to 1 if `msg_accrights' is a member of `struct msghdr'. */
+/* Define to 1 if 'msg_accrights' is a member of 'struct msghdr'. */
 #undef HAVE_STRUCT_MSGHDR_MSG_ACCRIGHTS
 
-/* Define to 1 if `mt_blkno' is a member of `struct mtget'. */
+/* Define to 1 if 'mt_blkno' is a member of 'struct mtget'. */
 #undef HAVE_STRUCT_MTGET_MT_BLKNO
 
-/* Define to 1 if `mt_blksiz' is a member of `struct mtget'. */
+/* Define to 1 if 'mt_blksiz' is a member of 'struct mtget'. */
 #undef HAVE_STRUCT_MTGET_MT_BLKSIZ
 
-/* Define to 1 if `mt_gstat' is a member of `struct mtget'. */
+/* Define to 1 if 'mt_gstat' is a member of 'struct mtget'. */
 #undef HAVE_STRUCT_MTGET_MT_GSTAT
 
-/* Define to 1 if `sin6_scope_id' is a member of `struct sockaddr_in6'. */
+/* Define to 1 if 'sin6_scope_id' is a member of 'struct sockaddr_in6'. */
 #undef HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID
 
-/* Define to 1 if `sun_len' is a member of `struct sockaddr_un'. */
+/* Define to 1 if 'sun_len' is a member of 'struct sockaddr_un'. */
 #undef HAVE_STRUCT_SOCKADDR_UN_SUN_LEN
 
-/* Define to 1 if `st_atim' is a member of `struct stat'. */
+/* Define to 1 if 'st_atim' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_ATIM
 
-/* Define to 1 if `st_atimespec' is a member of `struct stat'. */
+/* Define to 1 if 'st_atimespec' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_ATIMESPEC
 
-/* Define to 1 if `st_birthtim' is a member of `struct stat'. */
+/* Define to 1 if 'st_birthtim' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_BIRTHTIM
 
-/* Define to 1 if `st_birthtime' is a member of `struct stat'. */
+/* Define to 1 if 'st_birthtime' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_BIRTHTIME
 
-/* Define to 1 if `st_birthtimespec' is a member of `struct stat'. */
+/* Define to 1 if 'st_birthtimespec' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_BIRTHTIMESPEC
 
-/* Define to 1 if `st_ctim' is a member of `struct stat'. */
+/* Define to 1 if 'st_ctim' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_CTIM
 
-/* Define to 1 if `st_ctimespec' is a member of `struct stat'. */
+/* Define to 1 if 'st_ctimespec' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_CTIMESPEC
 
-/* Define to 1 if `st_mtim' is a member of `struct stat'. */
+/* Define to 1 if 'st_mtim' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_MTIM
 
-/* Define to 1 if `st_mtimespec' is a member of `struct stat'. */
+/* Define to 1 if 'st_mtimespec' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT_ST_MTIMESPEC
 
-/* Define to 1 if `__st_birthtim' is a member of `struct stat'. */
+/* Define to 1 if '__st_birthtim' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT___ST_BIRTHTIM
 
-/* Define to 1 if `__st_birthtime' is a member of `struct stat'. */
+/* Define to 1 if '__st_birthtime' is a member of 'struct stat'. */
 #undef HAVE_STRUCT_STAT___ST_BIRTHTIME
 
-/* Define to 1 if `mem_unit' is a member of `struct sysinfo'. */
+/* Define to 1 if 'mem_unit' is a member of 'struct sysinfo'. */
 #undef HAVE_STRUCT_SYSINFO_MEM_UNIT
 
-/* Define to 1 if `totalram' is a member of `struct sysinfo'. */
+/* Define to 1 if 'totalram' is a member of 'struct sysinfo'. */
 #undef HAVE_STRUCT_SYSINFO_TOTALRAM
 
-/* Define to 1 if `tcps_connattempt' is a member of `struct tcpstat'. */
+/* Define to 1 if 'tcps_connattempt' is a member of 'struct tcpstat'. */
 #undef HAVE_STRUCT_TCPSTAT_TCPS_CONNATTEMPT
 
-/* Define to 1 if `tcps_connattempt' is a member of `struct tcp_stats'. */
+/* Define to 1 if 'tcps_connattempt' is a member of 'struct tcp_stats'. */
 #undef HAVE_STRUCT_TCP_STATS_TCPS_CONNATTEMPT
 
-/* Define to 1 if `udps_ipackets' is a member of `struct udpstat'. */
+/* Define to 1 if 'udps_ipackets' is a member of 'struct udpstat'. */
 #undef HAVE_STRUCT_UDPSTAT_UDPS_IPACKETS
 
-/* Define to 1 if the system has the type `struct xinpgen'. */
-#undef HAVE_STRUCT_XINPGEN
-
-/* Define to 1 if `_u._ext.nscount6' is a member of `struct __res_state'. */
+/* Define to 1 if '_u._ext.nscount6' is a member of 'struct __res_state'. */
 #undef HAVE_STRUCT___RES_STATE__U__EXT_NSCOUNT6
 
 /* Define to 1 if you have the <syscall.h> header file. */
 #undef HAVE_SYSCALL_H
 
-/* Define to 1 if you have the `sysinfo' function. */
+/* Define to 1 if you have the 'sysinfo' function. */
 #undef HAVE_SYSINFO
 
 /* Define to 1 if you have the <sys/attr.h> header file. */
@@ -516,6 +522,9 @@
 /* Define to 1 if you have the <sys/epoll.h> header file. */
 #undef HAVE_SYS_EPOLL_H
 
+/* Define to 1 if you have the <sys/eventfd.h> header file. */
+#undef HAVE_SYS_EVENTFD_H
+
 /* Define to 1 if you have the <sys/event.h> header file. */
 #undef HAVE_SYS_EVENT_H
 
@@ -630,10 +639,10 @@
 /* Define to 1 if you have the <sys/xattr.h> header file. */
 #undef HAVE_SYS_XATTR_H
 
-/* Define to 1 if you have the `tcdrain' function. */
+/* Define to 1 if you have the 'tcdrain' function. */
 #undef HAVE_TCDRAIN
 
-/* Define to 1 if you have the `thr_kill2' function. */
+/* Define to 1 if you have the 'thr_kill2' function. */
 #undef HAVE_THR_KILL2
 
 /* Define to 1 if you have the `udev' library (-ludev). */
@@ -651,12 +660,12 @@
 /* Define to 1 if you have the <valgrind/valgrind.h> header file. */
 #undef HAVE_VALGRIND_VALGRIND_H
 
+/* Define to 1 if you have the <vosk_api.h> header file. */
+#undef HAVE_VOSK_API_H
+
 /* Define to 1 if you have the <X11/extensions/shape.h> header file. */
 #undef HAVE_X11_EXTENSIONS_SHAPE_H
 
-/* Define to 1 if you have the <X11/extensions/Xcomposite.h> header file. */
-#undef HAVE_X11_EXTENSIONS_XCOMPOSITE_H
-
 /* Define to 1 if you have the <X11/extensions/xf86vmode.h> header file. */
 #undef HAVE_X11_EXTENSIONS_XF86VMODE_H
 
@@ -684,26 +693,20 @@
 /* Define to 1 if you have the <X11/extensions/XShm.h> header file. */
 #undef HAVE_X11_EXTENSIONS_XSHM_H
 
-/* Define to 1 if you have the <X11/Xcursor/Xcursor.h> header file. */
-#undef HAVE_X11_XCURSOR_XCURSOR_H
-
-/* Define to 1 if you have the <X11/XKBlib.h> header file. */
-#undef HAVE_X11_XKBLIB_H
-
-/* Define to 1 if you have the <X11/Xlib.h> header file. */
-#undef HAVE_X11_XLIB_H
-
-/* Define to 1 if you have the <X11/Xutil.h> header file. */
-#undef HAVE_X11_XUTIL_H
-
-/* Define to 1 if `xcookie' is a member of `XEvent'. */
+/* Define to 1 if 'xcookie' is a member of 'XEvent'. */
 #undef HAVE_XEVENT_XCOOKIE
 
-/* Define to 1 if `callback' is a member of `XICCallback'. */
+/* Define to 1 if you have the <xf86drm.h> header file. */
+#undef HAVE_XF86DRM_H
+
+/* Define to 1 if 'callback' is a member of 'XICCallback'. */
 #undef HAVE_XICCALLBACK_CALLBACK
 
-/* Define if you have the XKB extension */
-#undef HAVE_XKB
+/* Define to 1 if you have the <xkbcommon/xkbcommon.h> header file. */
+#undef HAVE_XKBCOMMON_XKBCOMMON_H
+
+/* Define to 1 if you have the <xkbcommon/xkbregistry.h> header file. */
+#undef HAVE_XKBCOMMON_XKBREGISTRY_H
 
 /* Define if Xrender has the XRenderCreateLinearGradient function */
 #undef HAVE_XRENDERCREATELINEARGRADIENT
@@ -753,6 +756,12 @@
 /* Define to the soname of the libdbus-1 library. */
 #undef SONAME_LIBDBUS_1
 
+/* Define to the soname of the libdrm library. */
+#undef SONAME_LIBDRM
+
+/* Define to the soname of the libdrm_amdgpu library. */
+#undef SONAME_LIBDRM_AMDGPU
+
 /* Define to the soname of the libEGL library. */
 #undef SONAME_LIBEGL
 
@@ -762,12 +771,18 @@
 /* Define to the soname of the libfreetype library. */
 #undef SONAME_LIBFREETYPE
 
+/* Define to the soname of the libgcrypt library. */
+#undef SONAME_LIBGCRYPT
+
 /* Define to the soname of the libGL library. */
 #undef SONAME_LIBGL
 
 /* Define to the soname of the libGLESv2 library. */
 #undef SONAME_LIBGLESV2
 
+/* Define to the soname of the libgmp library. */
+#undef SONAME_LIBGMP
+
 /* Define to the soname of the libgnutls library. */
 #undef SONAME_LIBGNUTLS
 
@@ -795,6 +810,9 @@
 /* Define to the soname of the libv4l2 library. */
 #undef SONAME_LIBV4L2
 
+/* Define to the soname of the libvosk library. */
+#undef SONAME_LIBVOSK
+
 /* Define to the soname of the libvulkan library. */
 #undef SONAME_LIBVULKAN
 
@@ -828,10 +846,10 @@
 /* Define to the soname of the libXxf86vm library. */
 #undef SONAME_LIBXXF86VM
 
-/* Define to 1 if the `S_IS*' macros in <sys/stat.h> do not work properly. */
+/* Define to 1 if the 'S_IS*' macros in <sys/stat.h> do not work properly. */
 #undef STAT_MACROS_BROKEN
 
-/* Define to 1 if all of the C90 standard headers exist (not just the ones
+/* Define to 1 if all of the C89 standard headers exist (not just the ones
    required in a freestanding environment). This macro is provided for
    backward compatibility; new code need not use it. */
 #undef STDC_HEADERS
@@ -848,13 +866,16 @@
 /* Define to 1 to enable GNU extensions on Linux */
 #undef _GNU_SOURCE
 
-/* Define for large files, on AIX-style hosts. */
+/* Define to 1 on platforms where this makes off_t a 64-bit type. */
 #undef _LARGE_FILES
 
 /* Define to 64 to enable 64-bit time_t on Linux */
 #undef _TIME_BITS
 
-/* Define to `__inline__' or `__inline' if that's what the C compiler
+/* Define to 1 on platforms where this makes time_t a 64-bit type. */
+#undef __MINGW_USE_VC2005_COMPAT
+
+/* Define to '__inline__' or '__inline' if that's what the C compiler
    calls it, or to nothing if 'inline' is not supported under any name.  */
 #ifndef __cplusplus
 #undef inline
diff --git a/include/wine/server_protocol.h b/include/wine/server_protocol.h
index 139a7bca69e..629caa1e5c2 100644
--- a/include/wine/server_protocol.h
+++ b/include/wine/server_protocol.h
@@ -110,6 +110,14 @@ typedef union
 } debug_event_t;
 
 
+enum context_exec_space
+{
+    EXEC_SPACE_USERMODE,
+    EXEC_SPACE_SYSCALL,
+    EXEC_SPACE_EXCEPTION,
+};
+
+
 typedef struct
 {
     unsigned int     machine;
@@ -155,6 +163,10 @@ typedef struct
         unsigned char i386_regs[512];
     } ext;
     union
+    {
+        struct { enum context_exec_space space; int __pad; } space;
+    } exec_space;
+    union
     {
         struct { struct { unsigned __int64 low, high; } ymm_high[16]; } regs;
     } ymm;
@@ -167,6 +179,7 @@ typedef struct
 #define SERVER_CTX_DEBUG_REGISTERS    0x10
 #define SERVER_CTX_EXTENDED_REGISTERS 0x20
 #define SERVER_CTX_YMM_REGISTERS      0x40
+#define SERVER_CTX_EXEC_SPACE         0x80
 
 
 struct send_fd
@@ -877,6 +890,69 @@ typedef struct
     lparam_t info;
 } cursor_pos_t;
 
+struct cpu_topology_override
+{
+    unsigned int cpu_count;
+    unsigned char host_cpu_id[64];
+};
+
+struct directory_file_entry
+{
+    data_size_t name_len;
+
+};
+
+struct shared_cursor
+{
+    int                  x;
+    int                  y;
+    unsigned int         last_change;
+    rectangle_t          clip;
+};
+
+struct desktop_shared_memory
+{
+    unsigned int         seq;
+    struct shared_cursor cursor;
+    unsigned char        keystate[256];
+    thread_id_t          foreground_tid;
+    unsigned int         flags;
+    __int64              update_serial;
+};
+typedef volatile struct desktop_shared_memory desktop_shm_t;
+
+struct queue_shared_memory
+{
+    unsigned int         seq;
+    int                  created;
+    unsigned int         wake_bits;
+    unsigned int         changed_bits;
+    unsigned int         wake_mask;
+    unsigned int         changed_mask;
+    thread_id_t          input_tid;
+};
+typedef volatile struct queue_shared_memory queue_shm_t;
+
+struct input_shared_memory
+{
+    unsigned int         seq;
+    int                  created;
+    thread_id_t          tid;
+    user_handle_t        focus;
+    user_handle_t        capture;
+    user_handle_t        active;
+    user_handle_t        menu_owner;
+    user_handle_t        move_size;
+    user_handle_t        caret;
+    user_handle_t        cursor;
+    rectangle_t          caret_rect;
+    int                  cursor_count;
+    unsigned char        keystate[256];
+    int                  keystate_lock;
+    __int64              sync_serial;
+};
+typedef volatile struct input_shared_memory input_shm_t;
+
 
 
 
@@ -975,6 +1051,7 @@ struct init_process_done_reply
 {
     struct reply_header __header;
     client_ptr_t entry;
+    /* VARARG(cpu_override,cpu_topology_override); */
     int          suspend;
     char __pad_20[4];
 };
@@ -1096,8 +1173,8 @@ struct get_process_image_name_request
 {
     struct request_header __header;
     obj_handle_t handle;
+    process_id_t pid;
     int          win32;
-    char __pad_20[4];
 };
 struct get_process_image_name_reply
 {
@@ -1217,12 +1294,14 @@ struct suspend_thread_request
 {
     struct request_header __header;
     obj_handle_t handle;
+    obj_handle_t waited_handle;
+    char __pad_20[4];
 };
 struct suspend_thread_reply
 {
     struct reply_header __header;
     int          count;
-    char __pad_12[4];
+    obj_handle_t wait_handle;
 };
 
 
@@ -1830,10 +1909,8 @@ struct recv_socket_reply
 struct send_socket_request
 {
     struct request_header __header;
-    char __pad_12[4];
+    unsigned int flags;
     async_data_t async;
-    int          force_async;
-    char __pad_60[4];
 };
 struct send_socket_reply
 {
@@ -1844,6 +1921,8 @@ struct send_socket_reply
     char __pad_20[4];
 };
 
+#define SERVER_SOCKET_IO_FORCE_ASYNC 0x01
+#define SERVER_SOCKET_IO_SYSTEM      0x02
 
 
 struct socket_get_events_request
@@ -2313,7 +2392,9 @@ struct read_process_memory_request
 struct read_process_memory_reply
 {
     struct reply_header __header;
+    int unix_pid;
     /* VARARG(data,bytes); */
+    char __pad_12[4];
 };
 
 
@@ -2384,6 +2465,25 @@ struct flush_key_request
     obj_handle_t hkey;
 };
 struct flush_key_reply
+{
+    struct reply_header __header;
+    abstime_t   timestamp_counter;
+    data_size_t total;
+    int         branch_count;
+    /* VARARG(data,bytes); */
+};
+
+
+
+struct flush_key_done_request
+{
+    struct request_header __header;
+    char __pad_12[4];
+    abstime_t    timestamp_counter;
+    int          branch;
+    char __pad_28[4];
+};
+struct flush_key_done_reply
 {
     struct reply_header __header;
 };
@@ -2512,12 +2612,19 @@ struct save_registry_request
 {
     struct request_header __header;
     obj_handle_t hkey;
-    obj_handle_t file;
-    char __pad_20[4];
 };
 struct save_registry_reply
 {
     struct reply_header __header;
+    data_size_t  total;
+    /* VARARG(data,bytes); */
+    char __pad_12[4];
+};
+enum prefix_type
+{
+    PREFIX_UNKNOWN,
+    PREFIX_32BIT,
+    PREFIX_64BIT,
 };
 
 
@@ -2879,6 +2986,7 @@ struct send_hardware_message_reply
     char __pad_28[4];
 };
 #define SEND_HWMSG_INJECTED    0x01
+#define SEND_HWMSG_RAWINPUT    0x02
 
 
 
@@ -2904,9 +3012,9 @@ struct get_message_reply
     int             x;
     int             y;
     unsigned int    time;
-    unsigned int    active_hooks;
     data_size_t     total;
     /* VARARG(data,message_data); */
+    char __pad_52[4];
 };
 
 
@@ -3911,6 +4019,7 @@ struct set_user_object_info_request
     obj_handle_t handle;
     unsigned int flags;
     unsigned int obj_flags;
+    timeout_t    close_timeout;
 };
 struct set_user_object_info_reply
 {
@@ -3921,6 +4030,7 @@ struct set_user_object_info_reply
 };
 #define SET_USER_OBJECT_SET_FLAGS       1
 #define SET_USER_OBJECT_GET_FULL_NAME   2
+#define SET_USER_OBJECT_SET_CLOSE_TIMEOUT 4
 
 
 
@@ -3985,14 +4095,10 @@ struct get_thread_input_reply
     user_handle_t  focus;
     user_handle_t  capture;
     user_handle_t  active;
-    user_handle_t  foreground;
     user_handle_t  menu_owner;
     user_handle_t  move_size;
     user_handle_t  caret;
-    user_handle_t  cursor;
-    int            show_count;
     rectangle_t    rect;
-    char __pad_60[4];
 };
 
 
@@ -4071,12 +4177,14 @@ struct set_active_window_request
 {
     struct request_header __header;
     user_handle_t  handle;
+    unsigned int   internal_msg;
+    char __pad_20[4];
 };
 struct set_active_window_reply
 {
     struct reply_header __header;
     user_handle_t  previous;
-    char __pad_12[4];
+    thread_id_t    foreground_tid;
 };
 
 
@@ -4150,6 +4258,20 @@ enum caret_state
 
 
 
+struct get_active_hooks_request
+{
+    struct request_header __header;
+    char __pad_12[4];
+};
+struct get_active_hooks_reply
+{
+    struct reply_header __header;
+    unsigned int   active_hooks;
+    char __pad_12[4];
+};
+
+
+
 struct set_hook_request
 {
     struct request_header __header;
@@ -4753,11 +4875,13 @@ struct get_security_object_reply
 
 struct handle_info
 {
+    client_ptr_t object;
     process_id_t owner;
     obj_handle_t handle;
     unsigned int access;
     unsigned int attributes;
     unsigned int type;
+    unsigned int __pad;
 };
 
 
@@ -4775,6 +4899,92 @@ struct get_system_handles_reply
 };
 
 
+typedef union
+{
+    struct
+    {
+        unsigned int family;
+        process_id_t owner;
+        unsigned int state;
+    } common;
+    struct
+    {
+        unsigned int family;
+        process_id_t owner;
+        unsigned int state;
+        unsigned int local_addr;
+        unsigned int local_port;
+        unsigned int remote_addr;
+        unsigned int remote_port;
+    } ipv4;
+    struct
+    {
+        unsigned int family;
+        process_id_t owner;
+        unsigned int state;
+        unsigned char local_addr[16];
+        unsigned int local_scope_id;
+        unsigned int local_port;
+        unsigned char remote_addr[16];
+        unsigned int remote_scope_id;
+        unsigned int remote_port;
+    } ipv6;
+} tcp_connection;
+
+
+struct get_tcp_connections_request
+{
+    struct request_header __header;
+    unsigned int    state_filter;
+};
+struct get_tcp_connections_reply
+{
+    struct reply_header __header;
+    unsigned int    count;
+    /* VARARG(connections,tcp_connections); */
+    char __pad_12[4];
+};
+
+
+typedef union
+{
+    struct
+    {
+        unsigned int family;
+        process_id_t owner;
+    } common;
+    struct
+    {
+        unsigned int family;
+        process_id_t owner;
+        unsigned int addr;
+        unsigned int port;
+    } ipv4;
+    struct
+    {
+        unsigned int family;
+        process_id_t owner;
+        unsigned char addr[16];
+        unsigned int scope_id;
+        unsigned int port;
+    } ipv6;
+} udp_endpoint;
+
+
+struct get_udp_endpoints_request
+{
+    struct request_header __header;
+    char __pad_12[4];
+};
+struct get_udp_endpoints_reply
+{
+    struct reply_header __header;
+    unsigned int    count;
+    /* VARARG(endpoints,udp_endpoints); */
+    char __pad_12[4];
+};
+
+
 
 struct create_mailslot_request
 {
@@ -4861,6 +5071,20 @@ struct get_directory_entry_reply
     /* VARARG(type,unicode_str); */
 };
 
+struct query_directory_file_request
+{
+    struct request_header __header;
+    obj_handle_t   handle;
+    unsigned int   restart_scan;
+    char __pad_20[4];
+};
+struct query_directory_file_reply
+{
+    struct reply_header __header;
+    data_size_t    total_len;
+    /* VARARG(entries,directory_file_entries); */
+    char __pad_12[4];
+};
 
 
 struct create_symlink_request
@@ -5132,6 +5356,7 @@ struct make_process_system_request
 {
     struct request_header __header;
     obj_handle_t handle;
+    timeout_t    desktop_close_timeout;
 };
 struct make_process_system_reply
 {
@@ -5231,6 +5456,8 @@ struct remove_completion_request
 {
     struct request_header __header;
     obj_handle_t handle;
+    int          waited;
+    char __pad_20[4];
 };
 struct remove_completion_reply
 {
@@ -5455,14 +5682,18 @@ struct get_rawinput_buffer_request
     struct request_header __header;
     data_size_t rawinput_size;
     data_size_t buffer_size;
-    char __pad_20[4];
+    int         clear_qs_rawinput;
+    int         __pad;
+    char __pad_28[4];
 };
 struct get_rawinput_buffer_reply
 {
     struct reply_header __header;
     data_size_t next_size;
     unsigned int count;
+    unsigned int last_message_time;
     /* VARARG(data,bytes); */
+    char __pad_20[4];
 };
 
 
@@ -5619,7 +5850,6 @@ struct resume_process_reply
 };
 
 
-
 struct get_next_thread_request
 {
     struct request_header __header;
@@ -5636,6 +5866,189 @@ struct get_next_thread_reply
     char __pad_12[4];
 };
 
+enum esync_type
+{
+    ESYNC_SEMAPHORE = 1,
+    ESYNC_AUTO_EVENT,
+    ESYNC_MANUAL_EVENT,
+    ESYNC_MUTEX,
+    ESYNC_AUTO_SERVER,
+    ESYNC_MANUAL_SERVER,
+    ESYNC_QUEUE,
+};
+
+
+struct create_esync_request
+{
+    struct request_header __header;
+    unsigned int access;
+    int          initval;
+    int          type;
+    int          max;
+    /* VARARG(objattr,object_attributes); */
+    char __pad_28[4];
+};
+struct create_esync_reply
+{
+    struct reply_header __header;
+    obj_handle_t handle;
+    int          type;
+    unsigned int shm_idx;
+    char __pad_20[4];
+};
+
+struct open_esync_request
+{
+    struct request_header __header;
+    unsigned int access;
+    unsigned int attributes;
+    obj_handle_t rootdir;
+    int          type;
+    /* VARARG(name,unicode_str); */
+    char __pad_28[4];
+};
+struct open_esync_reply
+{
+    struct reply_header __header;
+    obj_handle_t handle;
+    int          type;
+    unsigned int shm_idx;
+    char __pad_20[4];
+};
+
+
+struct get_esync_fd_request
+{
+    struct request_header __header;
+    obj_handle_t handle;
+};
+struct get_esync_fd_reply
+{
+    struct reply_header __header;
+    int          type;
+    unsigned int shm_idx;
+};
+
+
+struct esync_msgwait_request
+{
+    struct request_header __header;
+    int          in_msgwait;
+};
+struct esync_msgwait_reply
+{
+    struct reply_header __header;
+};
+
+
+struct get_esync_apc_fd_request
+{
+    struct request_header __header;
+    char __pad_12[4];
+};
+struct get_esync_apc_fd_reply
+{
+    struct reply_header __header;
+};
+
+#define FSYNC_SHM_PAGE_SIZE 0x10000
+
+enum fsync_type
+{
+    FSYNC_SEMAPHORE = 1,
+    FSYNC_AUTO_EVENT,
+    FSYNC_MANUAL_EVENT,
+    FSYNC_MUTEX,
+    FSYNC_AUTO_SERVER,
+    FSYNC_MANUAL_SERVER,
+    FSYNC_QUEUE,
+};
+
+
+struct create_fsync_request
+{
+    struct request_header __header;
+    unsigned int access;
+    int low;
+    int high;
+    int type;
+    /* VARARG(objattr,object_attributes); */
+    char __pad_28[4];
+};
+struct create_fsync_reply
+{
+    struct reply_header __header;
+    obj_handle_t handle;
+    int type;
+    unsigned int shm_idx;
+    char __pad_20[4];
+};
+
+
+struct open_fsync_request
+{
+    struct request_header __header;
+    unsigned int access;
+    unsigned int attributes;
+    obj_handle_t rootdir;
+    int          type;
+    /* VARARG(name,unicode_str); */
+    char __pad_28[4];
+};
+struct open_fsync_reply
+{
+    struct reply_header __header;
+    obj_handle_t handle;
+    int          type;
+    unsigned int shm_idx;
+    char __pad_20[4];
+};
+
+
+struct get_fsync_idx_request
+{
+    struct request_header __header;
+    obj_handle_t handle;
+};
+struct get_fsync_idx_reply
+{
+    struct reply_header __header;
+    int          type;
+    unsigned int shm_idx;
+};
+
+struct fsync_msgwait_request
+{
+    struct request_header __header;
+    int          in_msgwait;
+};
+struct fsync_msgwait_reply
+{
+    struct reply_header __header;
+};
+
+struct get_fsync_apc_idx_request
+{
+    struct request_header __header;
+    char __pad_12[4];
+};
+struct get_fsync_apc_idx_reply
+{
+    struct reply_header __header;
+    unsigned int shm_idx;
+    char __pad_12[4];
+};
+
+struct fsync_free_shm_idx_request
+{
+    struct request_header __header;
+    unsigned int shm_idx;
+};
+struct fsync_free_shm_idx_reply
+{
+    struct reply_header __header;
+};
+
 
 enum request
 {
@@ -5728,6 +6141,7 @@ enum request
     REQ_open_key,
     REQ_delete_key,
     REQ_flush_key,
+    REQ_flush_key_done,
     REQ_enum_key,
     REQ_set_key_value,
     REQ_get_key_value,
@@ -5832,6 +6246,7 @@ enum request
     REQ_set_capture_window,
     REQ_set_caret_window,
     REQ_set_caret_info,
+    REQ_get_active_hooks,
     REQ_set_hook,
     REQ_remove_hook,
     REQ_start_hook_chain,
@@ -5868,11 +6283,14 @@ enum request
     REQ_set_security_object,
     REQ_get_security_object,
     REQ_get_system_handles,
+    REQ_get_tcp_connections,
+    REQ_get_udp_endpoints,
     REQ_create_mailslot,
     REQ_set_mailslot_info,
     REQ_create_directory,
     REQ_open_directory,
     REQ_get_directory_entry,
+    REQ_query_directory_file,
     REQ_create_symlink,
     REQ_open_symlink,
     REQ_query_symlink,
@@ -5923,6 +6341,17 @@ enum request
     REQ_suspend_process,
     REQ_resume_process,
     REQ_get_next_thread,
+    REQ_create_esync,
+    REQ_open_esync,
+    REQ_get_esync_fd,
+    REQ_esync_msgwait,
+    REQ_get_esync_apc_fd,
+    REQ_create_fsync,
+    REQ_open_fsync,
+    REQ_get_fsync_idx,
+    REQ_fsync_msgwait,
+    REQ_get_fsync_apc_idx,
+    REQ_fsync_free_shm_idx,
     REQ_NB_REQUESTS
 };
 
@@ -6019,6 +6448,7 @@ union generic_request
     struct open_key_request open_key_request;
     struct delete_key_request delete_key_request;
     struct flush_key_request flush_key_request;
+    struct flush_key_done_request flush_key_done_request;
     struct enum_key_request enum_key_request;
     struct set_key_value_request set_key_value_request;
     struct get_key_value_request get_key_value_request;
@@ -6123,6 +6553,7 @@ union generic_request
     struct set_capture_window_request set_capture_window_request;
     struct set_caret_window_request set_caret_window_request;
     struct set_caret_info_request set_caret_info_request;
+    struct get_active_hooks_request get_active_hooks_request;
     struct set_hook_request set_hook_request;
     struct remove_hook_request remove_hook_request;
     struct start_hook_chain_request start_hook_chain_request;
@@ -6159,11 +6590,14 @@ union generic_request
     struct set_security_object_request set_security_object_request;
     struct get_security_object_request get_security_object_request;
     struct get_system_handles_request get_system_handles_request;
+    struct get_tcp_connections_request get_tcp_connections_request;
+    struct get_udp_endpoints_request get_udp_endpoints_request;
     struct create_mailslot_request create_mailslot_request;
     struct set_mailslot_info_request set_mailslot_info_request;
     struct create_directory_request create_directory_request;
     struct open_directory_request open_directory_request;
     struct get_directory_entry_request get_directory_entry_request;
+    struct query_directory_file_request query_directory_file_request;
     struct create_symlink_request create_symlink_request;
     struct open_symlink_request open_symlink_request;
     struct query_symlink_request query_symlink_request;
@@ -6214,6 +6648,17 @@ union generic_request
     struct suspend_process_request suspend_process_request;
     struct resume_process_request resume_process_request;
     struct get_next_thread_request get_next_thread_request;
+    struct create_esync_request create_esync_request;
+    struct open_esync_request open_esync_request;
+    struct get_esync_fd_request get_esync_fd_request;
+    struct esync_msgwait_request esync_msgwait_request;
+    struct get_esync_apc_fd_request get_esync_apc_fd_request;
+    struct create_fsync_request create_fsync_request;
+    struct open_fsync_request open_fsync_request;
+    struct get_fsync_idx_request get_fsync_idx_request;
+    struct fsync_msgwait_request fsync_msgwait_request;
+    struct get_fsync_apc_idx_request get_fsync_apc_idx_request;
+    struct fsync_free_shm_idx_request fsync_free_shm_idx_request;
 };
 union generic_reply
 {
@@ -6308,6 +6753,7 @@ union generic_reply
     struct open_key_reply open_key_reply;
     struct delete_key_reply delete_key_reply;
     struct flush_key_reply flush_key_reply;
+    struct flush_key_done_reply flush_key_done_reply;
     struct enum_key_reply enum_key_reply;
     struct set_key_value_reply set_key_value_reply;
     struct get_key_value_reply get_key_value_reply;
@@ -6412,6 +6858,7 @@ union generic_reply
     struct set_capture_window_reply set_capture_window_reply;
     struct set_caret_window_reply set_caret_window_reply;
     struct set_caret_info_reply set_caret_info_reply;
+    struct get_active_hooks_reply get_active_hooks_reply;
     struct set_hook_reply set_hook_reply;
     struct remove_hook_reply remove_hook_reply;
     struct start_hook_chain_reply start_hook_chain_reply;
@@ -6448,11 +6895,14 @@ union generic_reply
     struct set_security_object_reply set_security_object_reply;
     struct get_security_object_reply get_security_object_reply;
     struct get_system_handles_reply get_system_handles_reply;
+    struct get_tcp_connections_reply get_tcp_connections_reply;
+    struct get_udp_endpoints_reply get_udp_endpoints_reply;
     struct create_mailslot_reply create_mailslot_reply;
     struct set_mailslot_info_reply set_mailslot_info_reply;
     struct create_directory_reply create_directory_reply;
     struct open_directory_reply open_directory_reply;
     struct get_directory_entry_reply get_directory_entry_reply;
+    struct query_directory_file_reply query_directory_file_reply;
     struct create_symlink_reply create_symlink_reply;
     struct open_symlink_reply open_symlink_reply;
     struct query_symlink_reply query_symlink_reply;
@@ -6503,11 +6953,22 @@ union generic_reply
     struct suspend_process_reply suspend_process_reply;
     struct resume_process_reply resume_process_reply;
     struct get_next_thread_reply get_next_thread_reply;
+    struct create_esync_reply create_esync_reply;
+    struct open_esync_reply open_esync_reply;
+    struct get_esync_fd_reply get_esync_fd_reply;
+    struct esync_msgwait_reply esync_msgwait_reply;
+    struct get_esync_apc_fd_reply get_esync_apc_fd_reply;
+    struct create_fsync_reply create_fsync_reply;
+    struct open_fsync_reply open_fsync_reply;
+    struct get_fsync_idx_reply get_fsync_idx_reply;
+    struct fsync_msgwait_reply fsync_msgwait_reply;
+    struct get_fsync_apc_idx_reply get_fsync_apc_idx_reply;
+    struct fsync_free_shm_idx_reply fsync_free_shm_idx_reply;
 };
 
 /* ### protocol_version begin ### */
 
-#define SERVER_PROTOCOL_VERSION 786
+#define SERVER_PROTOCOL_VERSION 787
 
 /* ### protocol_version end ### */
 
diff --git a/server/request.h b/server/request.h
index 89d5a621b16..116cd0cb68b 100644
--- a/server/request.h
+++ b/server/request.h
@@ -208,6 +208,7 @@ DECL_HANDLER(create_key);
 DECL_HANDLER(open_key);
 DECL_HANDLER(delete_key);
 DECL_HANDLER(flush_key);
+DECL_HANDLER(flush_key_done);
 DECL_HANDLER(enum_key);
 DECL_HANDLER(set_key_value);
 DECL_HANDLER(get_key_value);
@@ -312,6 +313,7 @@ DECL_HANDLER(set_active_window);
 DECL_HANDLER(set_capture_window);
 DECL_HANDLER(set_caret_window);
 DECL_HANDLER(set_caret_info);
+DECL_HANDLER(get_active_hooks);
 DECL_HANDLER(set_hook);
 DECL_HANDLER(remove_hook);
 DECL_HANDLER(start_hook_chain);
@@ -348,11 +350,14 @@ DECL_HANDLER(set_token_default_dacl);
 DECL_HANDLER(set_security_object);
 DECL_HANDLER(get_security_object);
 DECL_HANDLER(get_system_handles);
+DECL_HANDLER(get_tcp_connections);
+DECL_HANDLER(get_udp_endpoints);
 DECL_HANDLER(create_mailslot);
 DECL_HANDLER(set_mailslot_info);
 DECL_HANDLER(create_directory);
 DECL_HANDLER(open_directory);
 DECL_HANDLER(get_directory_entry);
+DECL_HANDLER(query_directory_file);
 DECL_HANDLER(create_symlink);
 DECL_HANDLER(open_symlink);
 DECL_HANDLER(query_symlink);
@@ -403,6 +408,17 @@ DECL_HANDLER(terminate_job);
 DECL_HANDLER(suspend_process);
 DECL_HANDLER(resume_process);
 DECL_HANDLER(get_next_thread);
+DECL_HANDLER(create_esync);
+DECL_HANDLER(open_esync);
+DECL_HANDLER(get_esync_fd);
+DECL_HANDLER(esync_msgwait);
+DECL_HANDLER(get_esync_apc_fd);
+DECL_HANDLER(create_fsync);
+DECL_HANDLER(open_fsync);
+DECL_HANDLER(get_fsync_idx);
+DECL_HANDLER(fsync_msgwait);
+DECL_HANDLER(get_fsync_apc_idx);
+DECL_HANDLER(fsync_free_shm_idx);
 
 #ifdef WANT_REQUEST_HANDLERS
 
@@ -498,6 +514,7 @@ static const req_handler req_handlers[REQ_NB_REQUESTS] =
     (req_handler)req_open_key,
     (req_handler)req_delete_key,
     (req_handler)req_flush_key,
+    (req_handler)req_flush_key_done,
     (req_handler)req_enum_key,
     (req_handler)req_set_key_value,
     (req_handler)req_get_key_value,
@@ -602,6 +619,7 @@ static const req_handler req_handlers[REQ_NB_REQUESTS] =
     (req_handler)req_set_capture_window,
     (req_handler)req_set_caret_window,
     (req_handler)req_set_caret_info,
+    (req_handler)req_get_active_hooks,
     (req_handler)req_set_hook,
     (req_handler)req_remove_hook,
     (req_handler)req_start_hook_chain,
@@ -638,11 +656,14 @@ static const req_handler req_handlers[REQ_NB_REQUESTS] =
     (req_handler)req_set_security_object,
     (req_handler)req_get_security_object,
     (req_handler)req_get_system_handles,
+    (req_handler)req_get_tcp_connections,
+    (req_handler)req_get_udp_endpoints,
     (req_handler)req_create_mailslot,
     (req_handler)req_set_mailslot_info,
     (req_handler)req_create_directory,
     (req_handler)req_open_directory,
     (req_handler)req_get_directory_entry,
+    (req_handler)req_query_directory_file,
     (req_handler)req_create_symlink,
     (req_handler)req_open_symlink,
     (req_handler)req_query_symlink,
@@ -693,6 +714,17 @@ static const req_handler req_handlers[REQ_NB_REQUESTS] =
     (req_handler)req_suspend_process,
     (req_handler)req_resume_process,
     (req_handler)req_get_next_thread,
+    (req_handler)req_create_esync,
+    (req_handler)req_open_esync,
+    (req_handler)req_get_esync_fd,
+    (req_handler)req_esync_msgwait,
+    (req_handler)req_get_esync_apc_fd,
+    (req_handler)req_create_fsync,
+    (req_handler)req_open_fsync,
+    (req_handler)req_get_fsync_idx,
+    (req_handler)req_fsync_msgwait,
+    (req_handler)req_get_fsync_apc_idx,
+    (req_handler)req_fsync_free_shm_idx,
 };
 
 C_ASSERT( sizeof(abstime_t) == 8 );
@@ -704,7 +736,7 @@ C_ASSERT( sizeof(async_data_t) == 40 );
 C_ASSERT( sizeof(atom_t) == 4 );
 C_ASSERT( sizeof(char) == 1 );
 C_ASSERT( sizeof(client_ptr_t) == 8 );
-C_ASSERT( sizeof(context_t) == 1720 );
+C_ASSERT( sizeof(context_t) == 1728 );
 C_ASSERT( sizeof(cursor_pos_t) == 24 );
 C_ASSERT( sizeof(data_size_t) == 4 );
 C_ASSERT( sizeof(debug_event_t) == 160 );
@@ -727,7 +759,7 @@ C_ASSERT( sizeof(select_op_t) == 264 );
 C_ASSERT( sizeof(short int) == 2 );
 C_ASSERT( sizeof(startup_info_t) == 96 );
 C_ASSERT( sizeof(struct filesystem_event) == 12 );
-C_ASSERT( sizeof(struct handle_info) == 20 );
+C_ASSERT( sizeof(struct handle_info) == 32 );
 C_ASSERT( sizeof(struct luid) == 8 );
 C_ASSERT( sizeof(struct luid_attr) == 12 );
 C_ASSERT( sizeof(struct object_attributes) == 16 );
@@ -735,8 +767,10 @@ C_ASSERT( sizeof(struct object_type_info) == 44 );
 C_ASSERT( sizeof(struct process_info) == 40 );
 C_ASSERT( sizeof(struct rawinput_device) == 12 );
 C_ASSERT( sizeof(struct thread_info) == 40 );
+C_ASSERT( sizeof(tcp_connection) == 60 );
 C_ASSERT( sizeof(thread_id_t) == 4 );
 C_ASSERT( sizeof(timeout_t) == 8 );
+C_ASSERT( sizeof(udp_endpoint) == 32 );
 C_ASSERT( sizeof(unsigned char) == 1 );
 C_ASSERT( sizeof(unsigned int) == 4 );
 C_ASSERT( sizeof(unsigned short) == 2 );
@@ -830,7 +864,8 @@ C_ASSERT( FIELD_OFFSET(struct get_process_debug_info_reply, debug) == 8 );
 C_ASSERT( FIELD_OFFSET(struct get_process_debug_info_reply, debug_children) == 12 );
 C_ASSERT( sizeof(struct get_process_debug_info_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct get_process_image_name_request, handle) == 12 );
-C_ASSERT( FIELD_OFFSET(struct get_process_image_name_request, win32) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_process_image_name_request, pid) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_process_image_name_request, win32) == 20 );
 C_ASSERT( sizeof(struct get_process_image_name_request) == 24 );
 C_ASSERT( FIELD_OFFSET(struct get_process_image_name_reply, len) == 8 );
 C_ASSERT( sizeof(struct get_process_image_name_reply) == 16 );
@@ -878,8 +913,10 @@ C_ASSERT( FIELD_OFFSET(struct set_thread_info_request, entry_point) == 32 );
 C_ASSERT( FIELD_OFFSET(struct set_thread_info_request, token) == 40 );
 C_ASSERT( sizeof(struct set_thread_info_request) == 48 );
 C_ASSERT( FIELD_OFFSET(struct suspend_thread_request, handle) == 12 );
-C_ASSERT( sizeof(struct suspend_thread_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct suspend_thread_request, waited_handle) == 16 );
+C_ASSERT( sizeof(struct suspend_thread_request) == 24 );
 C_ASSERT( FIELD_OFFSET(struct suspend_thread_reply, count) == 8 );
+C_ASSERT( FIELD_OFFSET(struct suspend_thread_reply, wait_handle) == 12 );
 C_ASSERT( sizeof(struct suspend_thread_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct resume_thread_request, handle) == 12 );
 C_ASSERT( sizeof(struct resume_thread_request) == 16 );
@@ -1084,9 +1121,9 @@ C_ASSERT( FIELD_OFFSET(struct recv_socket_reply, wait) == 8 );
 C_ASSERT( FIELD_OFFSET(struct recv_socket_reply, options) == 12 );
 C_ASSERT( FIELD_OFFSET(struct recv_socket_reply, nonblocking) == 16 );
 C_ASSERT( sizeof(struct recv_socket_reply) == 24 );
+C_ASSERT( FIELD_OFFSET(struct send_socket_request, flags) == 12 );
 C_ASSERT( FIELD_OFFSET(struct send_socket_request, async) == 16 );
-C_ASSERT( FIELD_OFFSET(struct send_socket_request, force_async) == 56 );
-C_ASSERT( sizeof(struct send_socket_request) == 64 );
+C_ASSERT( sizeof(struct send_socket_request) == 56 );
 C_ASSERT( FIELD_OFFSET(struct send_socket_reply, wait) == 8 );
 C_ASSERT( FIELD_OFFSET(struct send_socket_reply, options) == 12 );
 C_ASSERT( FIELD_OFFSET(struct send_socket_reply, nonblocking) == 16 );
@@ -1230,7 +1267,8 @@ C_ASSERT( sizeof(struct set_debug_obj_info_request) == 24 );
 C_ASSERT( FIELD_OFFSET(struct read_process_memory_request, handle) == 12 );
 C_ASSERT( FIELD_OFFSET(struct read_process_memory_request, addr) == 16 );
 C_ASSERT( sizeof(struct read_process_memory_request) == 24 );
-C_ASSERT( sizeof(struct read_process_memory_reply) == 8 );
+C_ASSERT( FIELD_OFFSET(struct read_process_memory_reply, unix_pid) == 8 );
+C_ASSERT( sizeof(struct read_process_memory_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct write_process_memory_request, handle) == 12 );
 C_ASSERT( FIELD_OFFSET(struct write_process_memory_request, addr) == 16 );
 C_ASSERT( sizeof(struct write_process_memory_request) == 24 );
@@ -1249,6 +1287,13 @@ C_ASSERT( FIELD_OFFSET(struct delete_key_request, hkey) == 12 );
 C_ASSERT( sizeof(struct delete_key_request) == 16 );
 C_ASSERT( FIELD_OFFSET(struct flush_key_request, hkey) == 12 );
 C_ASSERT( sizeof(struct flush_key_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct flush_key_reply, timestamp_counter) == 8 );
+C_ASSERT( FIELD_OFFSET(struct flush_key_reply, total) == 16 );
+C_ASSERT( FIELD_OFFSET(struct flush_key_reply, branch_count) == 20 );
+C_ASSERT( sizeof(struct flush_key_reply) == 24 );
+C_ASSERT( FIELD_OFFSET(struct flush_key_done_request, timestamp_counter) == 16 );
+C_ASSERT( FIELD_OFFSET(struct flush_key_done_request, branch) == 24 );
+C_ASSERT( sizeof(struct flush_key_done_request) == 32 );
 C_ASSERT( FIELD_OFFSET(struct enum_key_request, hkey) == 12 );
 C_ASSERT( FIELD_OFFSET(struct enum_key_request, index) == 16 );
 C_ASSERT( FIELD_OFFSET(struct enum_key_request, info_class) == 20 );
@@ -1288,8 +1333,9 @@ C_ASSERT( FIELD_OFFSET(struct unload_registry_request, parent) == 12 );
 C_ASSERT( FIELD_OFFSET(struct unload_registry_request, attributes) == 16 );
 C_ASSERT( sizeof(struct unload_registry_request) == 24 );
 C_ASSERT( FIELD_OFFSET(struct save_registry_request, hkey) == 12 );
-C_ASSERT( FIELD_OFFSET(struct save_registry_request, file) == 16 );
-C_ASSERT( sizeof(struct save_registry_request) == 24 );
+C_ASSERT( sizeof(struct save_registry_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct save_registry_reply, total) == 8 );
+C_ASSERT( sizeof(struct save_registry_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_registry_notification_request, hkey) == 12 );
 C_ASSERT( FIELD_OFFSET(struct set_registry_notification_request, event) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_registry_notification_request, subtree) == 20 );
@@ -1418,8 +1464,7 @@ C_ASSERT( FIELD_OFFSET(struct get_message_reply, type) == 32 );
 C_ASSERT( FIELD_OFFSET(struct get_message_reply, x) == 36 );
 C_ASSERT( FIELD_OFFSET(struct get_message_reply, y) == 40 );
 C_ASSERT( FIELD_OFFSET(struct get_message_reply, time) == 44 );
-C_ASSERT( FIELD_OFFSET(struct get_message_reply, active_hooks) == 48 );
-C_ASSERT( FIELD_OFFSET(struct get_message_reply, total) == 52 );
+C_ASSERT( FIELD_OFFSET(struct get_message_reply, total) == 48 );
 C_ASSERT( sizeof(struct get_message_reply) == 56 );
 C_ASSERT( FIELD_OFFSET(struct reply_message_request, remove) == 12 );
 C_ASSERT( FIELD_OFFSET(struct reply_message_request, result) == 16 );
@@ -1757,7 +1802,8 @@ C_ASSERT( sizeof(struct enum_desktop_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_user_object_info_request, handle) == 12 );
 C_ASSERT( FIELD_OFFSET(struct set_user_object_info_request, flags) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_user_object_info_request, obj_flags) == 20 );
-C_ASSERT( sizeof(struct set_user_object_info_request) == 24 );
+C_ASSERT( FIELD_OFFSET(struct set_user_object_info_request, close_timeout) == 24 );
+C_ASSERT( sizeof(struct set_user_object_info_request) == 32 );
 C_ASSERT( FIELD_OFFSET(struct set_user_object_info_reply, is_desktop) == 8 );
 C_ASSERT( FIELD_OFFSET(struct set_user_object_info_reply, old_obj_flags) == 12 );
 C_ASSERT( sizeof(struct set_user_object_info_reply) == 16 );
@@ -1785,14 +1831,11 @@ C_ASSERT( sizeof(struct get_thread_input_request) == 16 );
 C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, focus) == 8 );
 C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, capture) == 12 );
 C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, active) == 16 );
-C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, foreground) == 20 );
-C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, menu_owner) == 24 );
-C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, move_size) == 28 );
-C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, caret) == 32 );
-C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, cursor) == 36 );
-C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, show_count) == 40 );
-C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, rect) == 44 );
-C_ASSERT( sizeof(struct get_thread_input_reply) == 64 );
+C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, menu_owner) == 20 );
+C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, move_size) == 24 );
+C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, caret) == 28 );
+C_ASSERT( FIELD_OFFSET(struct get_thread_input_reply, rect) == 32 );
+C_ASSERT( sizeof(struct get_thread_input_reply) == 48 );
 C_ASSERT( sizeof(struct get_last_input_time_request) == 16 );
 C_ASSERT( FIELD_OFFSET(struct get_last_input_time_reply, time) == 8 );
 C_ASSERT( sizeof(struct get_last_input_time_reply) == 16 );
@@ -1814,8 +1857,10 @@ C_ASSERT( sizeof(struct set_focus_window_request) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_focus_window_reply, previous) == 8 );
 C_ASSERT( sizeof(struct set_focus_window_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_active_window_request, handle) == 12 );
-C_ASSERT( sizeof(struct set_active_window_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct set_active_window_request, internal_msg) == 16 );
+C_ASSERT( sizeof(struct set_active_window_request) == 24 );
 C_ASSERT( FIELD_OFFSET(struct set_active_window_reply, previous) == 8 );
+C_ASSERT( FIELD_OFFSET(struct set_active_window_reply, foreground_tid) == 12 );
 C_ASSERT( sizeof(struct set_active_window_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_capture_window_request, handle) == 12 );
 C_ASSERT( FIELD_OFFSET(struct set_capture_window_request, flags) == 16 );
@@ -1844,6 +1889,9 @@ C_ASSERT( FIELD_OFFSET(struct set_caret_info_reply, old_rect) == 12 );
 C_ASSERT( FIELD_OFFSET(struct set_caret_info_reply, old_hide) == 28 );
 C_ASSERT( FIELD_OFFSET(struct set_caret_info_reply, old_state) == 32 );
 C_ASSERT( sizeof(struct set_caret_info_reply) == 40 );
+C_ASSERT( sizeof(struct get_active_hooks_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_active_hooks_reply, active_hooks) == 8 );
+C_ASSERT( sizeof(struct get_active_hooks_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_hook_request, id) == 12 );
 C_ASSERT( FIELD_OFFSET(struct set_hook_request, pid) == 16 );
 C_ASSERT( FIELD_OFFSET(struct set_hook_request, tid) == 20 );
@@ -2071,6 +2119,13 @@ C_ASSERT( sizeof(struct get_security_object_reply) == 16 );
 C_ASSERT( sizeof(struct get_system_handles_request) == 16 );
 C_ASSERT( FIELD_OFFSET(struct get_system_handles_reply, count) == 8 );
 C_ASSERT( sizeof(struct get_system_handles_reply) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_tcp_connections_request, state_filter) == 12 );
+C_ASSERT( sizeof(struct get_tcp_connections_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_tcp_connections_reply, count) == 8 );
+C_ASSERT( sizeof(struct get_tcp_connections_reply) == 16 );
+C_ASSERT( sizeof(struct get_udp_endpoints_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_udp_endpoints_reply, count) == 8 );
+C_ASSERT( sizeof(struct get_udp_endpoints_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct create_mailslot_request, access) == 12 );
 C_ASSERT( FIELD_OFFSET(struct create_mailslot_request, read_timeout) == 16 );
 C_ASSERT( FIELD_OFFSET(struct create_mailslot_request, max_msgsize) == 24 );
@@ -2100,6 +2155,11 @@ C_ASSERT( sizeof(struct get_directory_entry_request) == 24 );
 C_ASSERT( FIELD_OFFSET(struct get_directory_entry_reply, total_len) == 8 );
 C_ASSERT( FIELD_OFFSET(struct get_directory_entry_reply, name_len) == 12 );
 C_ASSERT( sizeof(struct get_directory_entry_reply) == 16 );
+C_ASSERT( FIELD_OFFSET(struct query_directory_file_request, handle) == 12 );
+C_ASSERT( FIELD_OFFSET(struct query_directory_file_request, restart_scan) == 16 );
+C_ASSERT( sizeof(struct query_directory_file_request) == 24 );
+C_ASSERT( FIELD_OFFSET(struct query_directory_file_reply, total_len) == 8 );
+C_ASSERT( sizeof(struct query_directory_file_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct create_symlink_request, access) == 12 );
 C_ASSERT( sizeof(struct create_symlink_request) == 16 );
 C_ASSERT( FIELD_OFFSET(struct create_symlink_reply, handle) == 8 );
@@ -2181,7 +2241,8 @@ C_ASSERT( sizeof(struct get_kernel_object_handle_request) == 32 );
 C_ASSERT( FIELD_OFFSET(struct get_kernel_object_handle_reply, handle) == 8 );
 C_ASSERT( sizeof(struct get_kernel_object_handle_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct make_process_system_request, handle) == 12 );
-C_ASSERT( sizeof(struct make_process_system_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct make_process_system_request, desktop_close_timeout) == 16 );
+C_ASSERT( sizeof(struct make_process_system_request) == 24 );
 C_ASSERT( FIELD_OFFSET(struct make_process_system_reply, event) == 8 );
 C_ASSERT( sizeof(struct make_process_system_reply) == 16 );
 C_ASSERT( FIELD_OFFSET(struct get_token_info_request, handle) == 12 );
@@ -2217,7 +2278,8 @@ C_ASSERT( FIELD_OFFSET(struct add_completion_request, information) == 32 );
 C_ASSERT( FIELD_OFFSET(struct add_completion_request, status) == 40 );
 C_ASSERT( sizeof(struct add_completion_request) == 48 );
 C_ASSERT( FIELD_OFFSET(struct remove_completion_request, handle) == 12 );
-C_ASSERT( sizeof(struct remove_completion_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct remove_completion_request, waited) == 16 );
+C_ASSERT( sizeof(struct remove_completion_request) == 24 );
 C_ASSERT( FIELD_OFFSET(struct remove_completion_reply, ckey) == 8 );
 C_ASSERT( FIELD_OFFSET(struct remove_completion_reply, cvalue) == 16 );
 C_ASSERT( FIELD_OFFSET(struct remove_completion_reply, information) == 24 );
@@ -2288,10 +2350,13 @@ C_ASSERT( sizeof(struct get_cursor_history_request) == 16 );
 C_ASSERT( sizeof(struct get_cursor_history_reply) == 8 );
 C_ASSERT( FIELD_OFFSET(struct get_rawinput_buffer_request, rawinput_size) == 12 );
 C_ASSERT( FIELD_OFFSET(struct get_rawinput_buffer_request, buffer_size) == 16 );
-C_ASSERT( sizeof(struct get_rawinput_buffer_request) == 24 );
+C_ASSERT( FIELD_OFFSET(struct get_rawinput_buffer_request, clear_qs_rawinput) == 20 );
+C_ASSERT( FIELD_OFFSET(struct get_rawinput_buffer_request, __pad) == 24 );
+C_ASSERT( sizeof(struct get_rawinput_buffer_request) == 32 );
 C_ASSERT( FIELD_OFFSET(struct get_rawinput_buffer_reply, next_size) == 8 );
 C_ASSERT( FIELD_OFFSET(struct get_rawinput_buffer_reply, count) == 12 );
-C_ASSERT( sizeof(struct get_rawinput_buffer_reply) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_rawinput_buffer_reply, last_message_time) == 16 );
+C_ASSERT( sizeof(struct get_rawinput_buffer_reply) == 24 );
 C_ASSERT( sizeof(struct update_rawinput_devices_request) == 16 );
 C_ASSERT( FIELD_OFFSET(struct create_job_request, access) == 12 );
 C_ASSERT( sizeof(struct create_job_request) == 16 );
@@ -2336,6 +2401,63 @@ C_ASSERT( FIELD_OFFSET(struct get_next_thread_request, flags) == 28 );
 C_ASSERT( sizeof(struct get_next_thread_request) == 32 );
 C_ASSERT( FIELD_OFFSET(struct get_next_thread_reply, handle) == 8 );
 C_ASSERT( sizeof(struct get_next_thread_reply) == 16 );
+C_ASSERT( FIELD_OFFSET(struct create_esync_request, access) == 12 );
+C_ASSERT( FIELD_OFFSET(struct create_esync_request, initval) == 16 );
+C_ASSERT( FIELD_OFFSET(struct create_esync_request, type) == 20 );
+C_ASSERT( FIELD_OFFSET(struct create_esync_request, max) == 24 );
+C_ASSERT( sizeof(struct create_esync_request) == 32 );
+C_ASSERT( FIELD_OFFSET(struct create_esync_reply, handle) == 8 );
+C_ASSERT( FIELD_OFFSET(struct create_esync_reply, type) == 12 );
+C_ASSERT( FIELD_OFFSET(struct create_esync_reply, shm_idx) == 16 );
+C_ASSERT( sizeof(struct create_esync_reply) == 24 );
+C_ASSERT( FIELD_OFFSET(struct open_esync_request, access) == 12 );
+C_ASSERT( FIELD_OFFSET(struct open_esync_request, attributes) == 16 );
+C_ASSERT( FIELD_OFFSET(struct open_esync_request, rootdir) == 20 );
+C_ASSERT( FIELD_OFFSET(struct open_esync_request, type) == 24 );
+C_ASSERT( sizeof(struct open_esync_request) == 32 );
+C_ASSERT( FIELD_OFFSET(struct open_esync_reply, handle) == 8 );
+C_ASSERT( FIELD_OFFSET(struct open_esync_reply, type) == 12 );
+C_ASSERT( FIELD_OFFSET(struct open_esync_reply, shm_idx) == 16 );
+C_ASSERT( sizeof(struct open_esync_reply) == 24 );
+C_ASSERT( FIELD_OFFSET(struct get_esync_fd_request, handle) == 12 );
+C_ASSERT( sizeof(struct get_esync_fd_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_esync_fd_reply, type) == 8 );
+C_ASSERT( FIELD_OFFSET(struct get_esync_fd_reply, shm_idx) == 12 );
+C_ASSERT( sizeof(struct get_esync_fd_reply) == 16 );
+C_ASSERT( FIELD_OFFSET(struct esync_msgwait_request, in_msgwait) == 12 );
+C_ASSERT( sizeof(struct esync_msgwait_request) == 16 );
+C_ASSERT( sizeof(struct get_esync_apc_fd_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct create_fsync_request, access) == 12 );
+C_ASSERT( FIELD_OFFSET(struct create_fsync_request, low) == 16 );
+C_ASSERT( FIELD_OFFSET(struct create_fsync_request, high) == 20 );
+C_ASSERT( FIELD_OFFSET(struct create_fsync_request, type) == 24 );
+C_ASSERT( sizeof(struct create_fsync_request) == 32 );
+C_ASSERT( FIELD_OFFSET(struct create_fsync_reply, handle) == 8 );
+C_ASSERT( FIELD_OFFSET(struct create_fsync_reply, type) == 12 );
+C_ASSERT( FIELD_OFFSET(struct create_fsync_reply, shm_idx) == 16 );
+C_ASSERT( sizeof(struct create_fsync_reply) == 24 );
+C_ASSERT( FIELD_OFFSET(struct open_fsync_request, access) == 12 );
+C_ASSERT( FIELD_OFFSET(struct open_fsync_request, attributes) == 16 );
+C_ASSERT( FIELD_OFFSET(struct open_fsync_request, rootdir) == 20 );
+C_ASSERT( FIELD_OFFSET(struct open_fsync_request, type) == 24 );
+C_ASSERT( sizeof(struct open_fsync_request) == 32 );
+C_ASSERT( FIELD_OFFSET(struct open_fsync_reply, handle) == 8 );
+C_ASSERT( FIELD_OFFSET(struct open_fsync_reply, type) == 12 );
+C_ASSERT( FIELD_OFFSET(struct open_fsync_reply, shm_idx) == 16 );
+C_ASSERT( sizeof(struct open_fsync_reply) == 24 );
+C_ASSERT( FIELD_OFFSET(struct get_fsync_idx_request, handle) == 12 );
+C_ASSERT( sizeof(struct get_fsync_idx_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_fsync_idx_reply, type) == 8 );
+C_ASSERT( FIELD_OFFSET(struct get_fsync_idx_reply, shm_idx) == 12 );
+C_ASSERT( sizeof(struct get_fsync_idx_reply) == 16 );
+C_ASSERT( FIELD_OFFSET(struct fsync_msgwait_request, in_msgwait) == 12 );
+C_ASSERT( sizeof(struct fsync_msgwait_request) == 16 );
+C_ASSERT( sizeof(struct get_fsync_apc_idx_request) == 16 );
+C_ASSERT( FIELD_OFFSET(struct get_fsync_apc_idx_reply, shm_idx) == 8 );
+C_ASSERT( sizeof(struct get_fsync_apc_idx_reply) == 16 );
+C_ASSERT( FIELD_OFFSET(struct fsync_free_shm_idx_request, shm_idx) == 12 );
+C_ASSERT( sizeof(struct fsync_free_shm_idx_request) == 16 );
+C_ASSERT( sizeof(struct fsync_free_shm_idx_reply) == 8 );
 
 #endif  /* WANT_REQUEST_HANDLERS */
 
diff --git a/server/trace.c b/server/trace.c
index e3afbc03611..11d384d9458 100644
--- a/server/trace.c
+++ b/server/trace.c
@@ -1708,6 +1708,7 @@ static void dump_get_process_debug_info_reply( const struct get_process_debug_in
 static void dump_get_process_image_name_request( const struct get_process_image_name_request *req )
 {
     fprintf( stderr, " handle=%04x", req->handle );
+    fprintf( stderr, ", pid=%04x", req->pid );
     fprintf( stderr, ", win32=%d", req->win32 );
 }
 
@@ -1789,11 +1790,13 @@ static void dump_set_thread_info_request( const struct set_thread_info_request *
 static void dump_suspend_thread_request( const struct suspend_thread_request *req )
 {
     fprintf( stderr, " handle=%04x", req->handle );
+    fprintf( stderr, ", waited_handle=%04x", req->waited_handle );
 }
 
 static void dump_suspend_thread_reply( const struct suspend_thread_reply *req )
 {
     fprintf( stderr, " count=%d", req->count );
+    fprintf( stderr, ", wait_handle=%04x", req->wait_handle );
 }
 
 static void dump_resume_thread_request( const struct resume_thread_request *req )
@@ -2232,8 +2235,8 @@ static void dump_recv_socket_reply( const struct recv_socket_reply *req )
 
 static void dump_send_socket_request( const struct send_socket_request *req )
 {
-    dump_async_data( " async=", &req->async );
-    fprintf( stderr, ", force_async=%d", req->force_async );
+    fprintf( stderr, " flags=%08x", req->flags );
+    dump_async_data( ", async=", &req->async );
 }
 
 static void dump_send_socket_reply( const struct send_socket_reply *req )
@@ -2527,7 +2530,8 @@ static void dump_read_process_memory_request( const struct read_process_memory_r
 
 static void dump_read_process_memory_reply( const struct read_process_memory_reply *req )
 {
-    dump_varargs_bytes( " data=", cur_size );
+    fprintf( stderr, " unix_pid=%d", req->unix_pid );
+    dump_varargs_bytes( ", data=", cur_size );
 }
 
 static void dump_write_process_memory_request( const struct write_process_memory_request *req )
@@ -2573,6 +2577,20 @@ static void dump_flush_key_request( const struct flush_key_request *req )
     fprintf( stderr, " hkey=%04x", req->hkey );
 }
 
+static void dump_flush_key_reply( const struct flush_key_reply *req )
+{
+    dump_abstime( " timestamp_counter=", &req->timestamp_counter );
+    fprintf( stderr, ", total=%u", req->total );
+    fprintf( stderr, ", branch_count=%d", req->branch_count );
+    dump_varargs_bytes( ", data=", cur_size );
+}
+
+static void dump_flush_key_done_request( const struct flush_key_done_request *req )
+{
+    dump_abstime( " timestamp_counter=", &req->timestamp_counter );
+    fprintf( stderr, ", branch=%d", req->branch );
+}
+
 static void dump_enum_key_request( const struct enum_key_request *req )
 {
     fprintf( stderr, " hkey=%04x", req->hkey );
@@ -2655,7 +2673,12 @@ static void dump_unload_registry_request( const struct unload_registry_request *
 static void dump_save_registry_request( const struct save_registry_request *req )
 {
     fprintf( stderr, " hkey=%04x", req->hkey );
-    fprintf( stderr, ", file=%04x", req->file );
+}
+
+static void dump_save_registry_reply( const struct save_registry_reply *req )
+{
+    fprintf( stderr, " total=%u", req->total );
+    dump_varargs_bytes( ", data=", cur_size );
 }
 
 static void dump_set_registry_notification_request( const struct set_registry_notification_request *req )
@@ -2915,7 +2938,6 @@ static void dump_get_message_reply( const struct get_message_reply *req )
     fprintf( stderr, ", x=%d", req->x );
     fprintf( stderr, ", y=%d", req->y );
     fprintf( stderr, ", time=%08x", req->time );
-    fprintf( stderr, ", active_hooks=%08x", req->active_hooks );
     fprintf( stderr, ", total=%u", req->total );
     dump_varargs_message_data( ", data=", cur_size );
 }
@@ -3588,6 +3610,7 @@ static void dump_set_user_object_info_request( const struct set_user_object_info
     fprintf( stderr, " handle=%04x", req->handle );
     fprintf( stderr, ", flags=%08x", req->flags );
     fprintf( stderr, ", obj_flags=%08x", req->obj_flags );
+    dump_timeout( ", close_timeout=", &req->close_timeout );
 }
 
 static void dump_set_user_object_info_reply( const struct set_user_object_info_reply *req )
@@ -3641,12 +3664,9 @@ static void dump_get_thread_input_reply( const struct get_thread_input_reply *re
     fprintf( stderr, " focus=%08x", req->focus );
     fprintf( stderr, ", capture=%08x", req->capture );
     fprintf( stderr, ", active=%08x", req->active );
-    fprintf( stderr, ", foreground=%08x", req->foreground );
     fprintf( stderr, ", menu_owner=%08x", req->menu_owner );
     fprintf( stderr, ", move_size=%08x", req->move_size );
     fprintf( stderr, ", caret=%08x", req->caret );
-    fprintf( stderr, ", cursor=%08x", req->cursor );
-    fprintf( stderr, ", show_count=%d", req->show_count );
     dump_rectangle( ", rect=", &req->rect );
 }
 
@@ -3702,11 +3722,13 @@ static void dump_set_focus_window_reply( const struct set_focus_window_reply *re
 static void dump_set_active_window_request( const struct set_active_window_request *req )
 {
     fprintf( stderr, " handle=%08x", req->handle );
+    fprintf( stderr, ", internal_msg=%08x", req->internal_msg );
 }
 
 static void dump_set_active_window_reply( const struct set_active_window_reply *req )
 {
     fprintf( stderr, " previous=%08x", req->previous );
+    fprintf( stderr, ", foreground_tid=%04x", req->foreground_tid );
 }
 
 static void dump_set_capture_window_request( const struct set_capture_window_request *req )
@@ -3754,6 +3776,15 @@ static void dump_set_caret_info_reply( const struct set_caret_info_reply *req )
     fprintf( stderr, ", old_state=%d", req->old_state );
 }
 
+static void dump_get_active_hooks_request( const struct get_active_hooks_request *req )
+{
+}
+
+static void dump_get_active_hooks_reply( const struct get_active_hooks_reply *req )
+{
+    fprintf( stderr, " active_hooks=%08x", req->active_hooks );
+}
+
 static void dump_set_hook_request( const struct set_hook_request *req )
 {
     fprintf( stderr, " id=%d", req->id );
@@ -4205,6 +4236,27 @@ static void dump_get_system_handles_reply( const struct get_system_handles_reply
     dump_varargs_handle_infos( ", data=", cur_size );
 }
 
+static void dump_get_tcp_connections_request( const struct get_tcp_connections_request *req )
+{
+    fprintf( stderr, " state_filter=%08x", req->state_filter );
+}
+
+static void dump_get_tcp_connections_reply( const struct get_tcp_connections_reply *req )
+{
+    fprintf( stderr, " count=%08x", req->count );
+    dump_varargs_tcp_connections( ", connections=", cur_size );
+}
+
+static void dump_get_udp_endpoints_request( const struct get_udp_endpoints_request *req )
+{
+}
+
+static void dump_get_udp_endpoints_reply( const struct get_udp_endpoints_reply *req )
+{
+    fprintf( stderr, " count=%08x", req->count );
+    dump_varargs_udp_endpoints( ", endpoints=", cur_size );
+}
+
 static void dump_create_mailslot_request( const struct create_mailslot_request *req )
 {
     fprintf( stderr, " access=%08x", req->access );
@@ -4269,6 +4321,18 @@ static void dump_get_directory_entry_reply( const struct get_directory_entry_rep
     dump_varargs_unicode_str( ", type=", cur_size );
 }
 
+static void dump_query_directory_file_request( const struct query_directory_file_request *req )
+{
+    fprintf( stderr, " handle=%04x", req->handle );
+    fprintf( stderr, ", restart_scan=%08x", req->restart_scan );
+}
+
+static void dump_query_directory_file_reply( const struct query_directory_file_reply *req )
+{
+    fprintf( stderr, " total_len=%u", req->total_len );
+    dump_varargs_directory_file_entries( ", entries=", cur_size );
+}
+
 static void dump_create_symlink_request( const struct create_symlink_request *req )
 {
     fprintf( stderr, " access=%08x", req->access );
@@ -4449,6 +4513,7 @@ static void dump_get_kernel_object_handle_reply( const struct get_kernel_object_
 static void dump_make_process_system_request( const struct make_process_system_request *req )
 {
     fprintf( stderr, " handle=%04x", req->handle );
+    dump_timeout( ", desktop_close_timeout=", &req->desktop_close_timeout );
 }
 
 static void dump_make_process_system_reply( const struct make_process_system_reply *req )
@@ -4520,6 +4585,7 @@ static void dump_add_completion_request( const struct add_completion_request *re
 static void dump_remove_completion_request( const struct remove_completion_request *req )
 {
     fprintf( stderr, " handle=%04x", req->handle );
+    fprintf( stderr, ", waited=%d", req->waited );
 }
 
 static void dump_remove_completion_reply( const struct remove_completion_reply *req )
@@ -4654,12 +4720,14 @@ static void dump_get_rawinput_buffer_request( const struct get_rawinput_buffer_r
 {
     fprintf( stderr, " rawinput_size=%u", req->rawinput_size );
     fprintf( stderr, ", buffer_size=%u", req->buffer_size );
+    fprintf( stderr, ", clear_qs_rawinput=%d", req->clear_qs_rawinput );
 }
 
 static void dump_get_rawinput_buffer_reply( const struct get_rawinput_buffer_reply *req )
 {
     fprintf( stderr, " next_size=%u", req->next_size );
     fprintf( stderr, ", count=%08x", req->count );
+    fprintf( stderr, ", last_message_time=%08x", req->last_message_time );
     dump_varargs_bytes( ", data=", cur_size );
 }
 
@@ -4759,6 +4827,120 @@ static void dump_get_next_thread_reply( const struct get_next_thread_reply *req
     fprintf( stderr, " handle=%04x", req->handle );
 }
 
+static void dump_create_esync_request( const struct create_esync_request *req )
+{
+    fprintf( stderr, " access=%08x", req->access );
+    fprintf( stderr, ", initval=%d", req->initval );
+    fprintf( stderr, ", type=%d", req->type );
+    fprintf( stderr, ", max=%d", req->max );
+    dump_varargs_object_attributes( ", objattr=", cur_size );
+}
+
+static void dump_create_esync_reply( const struct create_esync_reply *req )
+{
+    fprintf( stderr, " handle=%04x", req->handle );
+    fprintf( stderr, ", type=%d", req->type );
+    fprintf( stderr, ", shm_idx=%08x", req->shm_idx );
+}
+
+static void dump_open_esync_request( const struct open_esync_request *req )
+{
+    fprintf( stderr, " access=%08x", req->access );
+    fprintf( stderr, ", attributes=%08x", req->attributes );
+    fprintf( stderr, ", rootdir=%04x", req->rootdir );
+    fprintf( stderr, ", type=%d", req->type );
+    dump_varargs_unicode_str( ", name=", cur_size );
+}
+
+static void dump_open_esync_reply( const struct open_esync_reply *req )
+{
+    fprintf( stderr, " handle=%04x", req->handle );
+    fprintf( stderr, ", type=%d", req->type );
+    fprintf( stderr, ", shm_idx=%08x", req->shm_idx );
+}
+
+static void dump_get_esync_fd_request( const struct get_esync_fd_request *req )
+{
+    fprintf( stderr, " handle=%04x", req->handle );
+}
+
+static void dump_get_esync_fd_reply( const struct get_esync_fd_reply *req )
+{
+    fprintf( stderr, " type=%d", req->type );
+    fprintf( stderr, ", shm_idx=%08x", req->shm_idx );
+}
+
+static void dump_esync_msgwait_request( const struct esync_msgwait_request *req )
+{
+    fprintf( stderr, " in_msgwait=%d", req->in_msgwait );
+}
+
+static void dump_get_esync_apc_fd_request( const struct get_esync_apc_fd_request *req )
+{
+}
+
+static void dump_create_fsync_request( const struct create_fsync_request *req )
+{
+    fprintf( stderr, " access=%08x", req->access );
+    fprintf( stderr, ", low=%d", req->low );
+    fprintf( stderr, ", high=%d", req->high );
+    fprintf( stderr, ", type=%d", req->type );
+    dump_varargs_object_attributes( ", objattr=", cur_size );
+}
+
+static void dump_create_fsync_reply( const struct create_fsync_reply *req )
+{
+    fprintf( stderr, " handle=%04x", req->handle );
+    fprintf( stderr, ", type=%d", req->type );
+    fprintf( stderr, ", shm_idx=%08x", req->shm_idx );
+}
+
+static void dump_open_fsync_request( const struct open_fsync_request *req )
+{
+    fprintf( stderr, " access=%08x", req->access );
+    fprintf( stderr, ", attributes=%08x", req->attributes );
+    fprintf( stderr, ", rootdir=%04x", req->rootdir );
+    fprintf( stderr, ", type=%d", req->type );
+    dump_varargs_unicode_str( ", name=", cur_size );
+}
+
+static void dump_open_fsync_reply( const struct open_fsync_reply *req )
+{
+    fprintf( stderr, " handle=%04x", req->handle );
+    fprintf( stderr, ", type=%d", req->type );
+    fprintf( stderr, ", shm_idx=%08x", req->shm_idx );
+}
+
+static void dump_get_fsync_idx_request( const struct get_fsync_idx_request *req )
+{
+    fprintf( stderr, " handle=%04x", req->handle );
+}
+
+static void dump_get_fsync_idx_reply( const struct get_fsync_idx_reply *req )
+{
+    fprintf( stderr, " type=%d", req->type );
+    fprintf( stderr, ", shm_idx=%08x", req->shm_idx );
+}
+
+static void dump_fsync_msgwait_request( const struct fsync_msgwait_request *req )
+{
+    fprintf( stderr, " in_msgwait=%d", req->in_msgwait );
+}
+
+static void dump_get_fsync_apc_idx_request( const struct get_fsync_apc_idx_request *req )
+{
+}
+
+static void dump_get_fsync_apc_idx_reply( const struct get_fsync_apc_idx_reply *req )
+{
+    fprintf( stderr, " shm_idx=%08x", req->shm_idx );
+}
+
+static void dump_fsync_free_shm_idx_request( const struct fsync_free_shm_idx_request *req )
+{
+    fprintf( stderr, " shm_idx=%08x", req->shm_idx );
+}
+
 static const dump_func req_dumpers[REQ_NB_REQUESTS] = {
     (dump_func)dump_new_process_request,
     (dump_func)dump_get_new_process_info_request,
@@ -4849,6 +5031,7 @@ static const dump_func req_dumpers[REQ_NB_REQUESTS] = {
     (dump_func)dump_open_key_request,
     (dump_func)dump_delete_key_request,
     (dump_func)dump_flush_key_request,
+    (dump_func)dump_flush_key_done_request,
     (dump_func)dump_enum_key_request,
     (dump_func)dump_set_key_value_request,
     (dump_func)dump_get_key_value_request,
@@ -4953,6 +5136,7 @@ static const dump_func req_dumpers[REQ_NB_REQUESTS] = {
     (dump_func)dump_set_capture_window_request,
     (dump_func)dump_set_caret_window_request,
     (dump_func)dump_set_caret_info_request,
+    (dump_func)dump_get_active_hooks_request,
     (dump_func)dump_set_hook_request,
     (dump_func)dump_remove_hook_request,
     (dump_func)dump_start_hook_chain_request,
@@ -4989,11 +5173,14 @@ static const dump_func req_dumpers[REQ_NB_REQUESTS] = {
     (dump_func)dump_set_security_object_request,
     (dump_func)dump_get_security_object_request,
     (dump_func)dump_get_system_handles_request,
+    (dump_func)dump_get_tcp_connections_request,
+    (dump_func)dump_get_udp_endpoints_request,
     (dump_func)dump_create_mailslot_request,
     (dump_func)dump_set_mailslot_info_request,
     (dump_func)dump_create_directory_request,
     (dump_func)dump_open_directory_request,
     (dump_func)dump_get_directory_entry_request,
+    (dump_func)dump_query_directory_file_request,
     (dump_func)dump_create_symlink_request,
     (dump_func)dump_open_symlink_request,
     (dump_func)dump_query_symlink_request,
@@ -5044,6 +5231,17 @@ static const dump_func req_dumpers[REQ_NB_REQUESTS] = {
     (dump_func)dump_suspend_process_request,
     (dump_func)dump_resume_process_request,
     (dump_func)dump_get_next_thread_request,
+    (dump_func)dump_create_esync_request,
+    (dump_func)dump_open_esync_request,
+    (dump_func)dump_get_esync_fd_request,
+    (dump_func)dump_esync_msgwait_request,
+    (dump_func)dump_get_esync_apc_fd_request,
+    (dump_func)dump_create_fsync_request,
+    (dump_func)dump_open_fsync_request,
+    (dump_func)dump_get_fsync_idx_request,
+    (dump_func)dump_fsync_msgwait_request,
+    (dump_func)dump_get_fsync_apc_idx_request,
+    (dump_func)dump_fsync_free_shm_idx_request,
 };
 
 static const dump_func reply_dumpers[REQ_NB_REQUESTS] = {
@@ -5135,6 +5333,7 @@ static const dump_func reply_dumpers[REQ_NB_REQUESTS] = {
     (dump_func)dump_create_key_reply,
     (dump_func)dump_open_key_reply,
     NULL,
+    (dump_func)dump_flush_key_reply,
     NULL,
     (dump_func)dump_enum_key_reply,
     NULL,
@@ -5143,7 +5342,7 @@ static const dump_func reply_dumpers[REQ_NB_REQUESTS] = {
     NULL,
     NULL,
     NULL,
-    NULL,
+    (dump_func)dump_save_registry_reply,
     NULL,
     NULL,
     (dump_func)dump_create_timer_reply,
@@ -5240,6 +5439,7 @@ static const dump_func reply_dumpers[REQ_NB_REQUESTS] = {
     (dump_func)dump_set_capture_window_reply,
     (dump_func)dump_set_caret_window_reply,
     (dump_func)dump_set_caret_info_reply,
+    (dump_func)dump_get_active_hooks_reply,
     (dump_func)dump_set_hook_reply,
     (dump_func)dump_remove_hook_reply,
     (dump_func)dump_start_hook_chain_reply,
@@ -5276,11 +5476,14 @@ static const dump_func reply_dumpers[REQ_NB_REQUESTS] = {
     NULL,
     (dump_func)dump_get_security_object_reply,
     (dump_func)dump_get_system_handles_reply,
+    (dump_func)dump_get_tcp_connections_reply,
+    (dump_func)dump_get_udp_endpoints_reply,
     (dump_func)dump_create_mailslot_reply,
     (dump_func)dump_set_mailslot_info_reply,
     (dump_func)dump_create_directory_reply,
     (dump_func)dump_open_directory_reply,
     (dump_func)dump_get_directory_entry_reply,
+    (dump_func)dump_query_directory_file_reply,
     (dump_func)dump_create_symlink_reply,
     (dump_func)dump_open_symlink_reply,
     (dump_func)dump_query_symlink_reply,
@@ -5331,6 +5534,17 @@ static const dump_func reply_dumpers[REQ_NB_REQUESTS] = {
     NULL,
     NULL,
     (dump_func)dump_get_next_thread_reply,
+    (dump_func)dump_create_esync_reply,
+    (dump_func)dump_open_esync_reply,
+    (dump_func)dump_get_esync_fd_reply,
+    NULL,
+    NULL,
+    (dump_func)dump_create_fsync_reply,
+    (dump_func)dump_open_fsync_reply,
+    (dump_func)dump_get_fsync_idx_reply,
+    NULL,
+    (dump_func)dump_get_fsync_apc_idx_reply,
+    NULL,
 };
 
 static const char * const req_names[REQ_NB_REQUESTS] = {
@@ -5423,6 +5637,7 @@ static const char * const req_names[REQ_NB_REQUESTS] = {
     "open_key",
     "delete_key",
     "flush_key",
+    "flush_key_done",
     "enum_key",
     "set_key_value",
     "get_key_value",
@@ -5527,6 +5742,7 @@ static const char * const req_names[REQ_NB_REQUESTS] = {
     "set_capture_window",
     "set_caret_window",
     "set_caret_info",
+    "get_active_hooks",
     "set_hook",
     "remove_hook",
     "start_hook_chain",
@@ -5563,11 +5779,14 @@ static const char * const req_names[REQ_NB_REQUESTS] = {
     "set_security_object",
     "get_security_object",
     "get_system_handles",
+    "get_tcp_connections",
+    "get_udp_endpoints",
     "create_mailslot",
     "set_mailslot_info",
     "create_directory",
     "open_directory",
     "get_directory_entry",
+    "query_directory_file",
     "create_symlink",
     "open_symlink",
     "query_symlink",
@@ -5618,6 +5837,17 @@ static const char * const req_names[REQ_NB_REQUESTS] = {
     "suspend_process",
     "resume_process",
     "get_next_thread",
+    "create_esync",
+    "open_esync",
+    "get_esync_fd",
+    "esync_msgwait",
+    "get_esync_apc_fd",
+    "create_fsync",
+    "open_fsync",
+    "get_fsync_idx",
+    "fsync_msgwait",
+    "get_fsync_apc_idx",
+    "fsync_free_shm_idx",
 };
 
 static const struct
@@ -5715,6 +5945,7 @@ static const struct
     { "NO_IMPERSONATION_TOKEN",      STATUS_NO_IMPERSONATION_TOKEN },
     { "NO_MEMORY",                   STATUS_NO_MEMORY },
     { "NO_MORE_ENTRIES",             STATUS_NO_MORE_ENTRIES },
+    { "NO_MORE_FILES",               STATUS_NO_MORE_FILES },
     { "NO_SUCH_DEVICE",              STATUS_NO_SUCH_DEVICE },
     { "NO_SUCH_FILE",                STATUS_NO_SUCH_FILE },
     { "NO_TOKEN",                    STATUS_NO_TOKEN },
